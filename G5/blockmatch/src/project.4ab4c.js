window.__require=function e(t,n,o){function i(r,s){if(!n[r]){if(!t[r]){var c=r.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){return i(t[r][1][e]||e)},u,u.exports,e,t,n,o)}return n[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<o.length;r++)i(o[r]);return i}({AdsManager:[function(e,t,n){"use strict";cc._RF.push(t,"c476fH9Fl5JWZVUwE3xVm2I","AdsManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../Benz/BenzLog"),i=e("../Platform/BenzPlatformManager"),a=e("../Platform/BenzCommand"),r=function(){function e(){this._playCount=0}return e.getInstance=function(){return this._instance},e.prototype.init=function(){o.BenzLog.log("[AdsManager] Init")},e.prototype.showRewardAd=function(e,t){i.BenzPlatformManager.sendData(e,t)},e.prototype.showInterstitialAd=function(){i.BenzPlatformManager.sendData(a.BenzCommand.CMD_SHOW_NONE_REWARD_VIDEO_AD,null)},e.ADS_LEVEL_COUNT=3,e._instance=new e,e}();n.AdsManager=r,cc._RF.pop()},{"../Benz/BenzLog":"BenzLog","../Platform/BenzCommand":"BenzCommand","../Platform/BenzPlatformManager":"BenzPlatformManager"}],AudioManager:[function(e,t,n){"use strict";cc._RF.push(t,"aaf53xREZRFgIOiVoeBrJUE","AudioManager"),Object.defineProperty(n,"__esModule",{value:!0});var o,i=e("./Collection/Dictionary"),a=e("./GameCtrl"),r=e("./Manager/DataManager"),s=cc._decorator,c=s.ccclass,l=s.property;(function(e){e[e.Bgm=0]="Bgm",e[e.Effect=1]="Effect"})(o||(o={})),n.SoundType=o;var u={BGM:"bgm",ClickBtn:"click_btn",Fire:"fire",Thounder:"thounder",Score:"score",Drop:"drop",GetTools:"getTools",Refresh:"refresh",Finish:"finish"};n.SoundName=u;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.musicSource=null,t.effectSource=null,t._audioClipDic=new i.Dictionary,t._mute=!1,t}var n;return __extends(t,e),n=t,Object.defineProperty(t.prototype,"isMute",{get:function(){return this._mute},enumerable:!0,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n._instance=this},t.prototype.start=function(){var e=r.DataManager.getInstance().getBooleanForKey("mute",!1);this._mute=null!=e&&e,this.play(o.Bgm,u.BGM,!0),null!=a.default.instance&&a.default.instance.refreshSoundIcon()},t.prototype.switchSound=function(){this._mute=!this._mute,this.effectSource.mute=this._mute,this.musicSource.mute=this._mute,r.DataManager.getInstance().setItem("mute",this._mute),r.DataManager.getInstance().flush(),this._mute||null!=this.musicSource.clip||this.play(o.Bgm,u.BGM,!0),null!=a.default.instance&&a.default.instance.refreshSoundIcon()},t.prototype.play=function(e,t,n){if(void 0===n&&(n=!1),!this._mute)if(this._audioClipDic.containsKey(t))this._playSound(e,this._audioClipDic.get(t),n);else{var o=this;cc.loader.loadRes("audio/"+t,cc.AudioClip,function(i,a){null==i&&(o._audioClipDic.set(t,a),o._playSound(e,a,n))})}},t.prototype._playSound=function(e,t,n){var i=e==o.Bgm?this.musicSource:this.effectSource;i.clip=t,i.loop=n,i.play()},t._instance=null,__decorate([l(cc.AudioSource)],t.prototype,"musicSource",void 0),__decorate([l(cc.AudioSource)],t.prototype,"effectSource",void 0),t=n=__decorate([c],t)}(cc.Component);n.default=h,cc._RF.pop()},{"./Collection/Dictionary":"Dictionary","./GameCtrl":"GameCtrl","./Manager/DataManager":"DataManager"}],Benz4399Platform:[function(e,t,n){"use strict";cc._RF.push(t,"2f5c8lqCkhFCrKJoam9i/oN","Benz4399Platform"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./BenzCommand"),i=e("../Manager/DataManager"),a=e("../Benz/BenzLog"),r=function(){function e(){this._rewardData=null,this._totalTipCount=10,this._curUseTipCount=null,this._curDateTimeStr="",this._remainTime=0,this._isLoad=!1}return e.prototype.init=function(){a.BenzLog.log("init");var e=window.document.getElementsByTagName("HEAD").item(0),t=window.document.createElement("script");t.type="text/javascript",t.src="htp://h.api.4399.com/h5mini-2.0/h5api-interface.php",e.appendChild(t),this._isLoad=!1},e.prototype.initParam=function(){if(null==this._curUseTipCount){console.log("initParam");var e=i.DataManager.getInstance().getStringForKey("left_tips_count_4399","").split("-"),t=new Date;this._curDateTimeStr=t.getUTCFullYear()+""+t.getMonth()+t.getDate(),e.length<=1?(this._curUseTipCount=0,this.setTipCount()):(this._curUseTipCount=parseInt(e[1]),this._curDateTimeStr!=e[0]&&this.setTipCount())}},e.prototype.setTipCount=function(){this._remainTime--,this._remainTime<0&&(this._remainTime=0)},e.prototype.sendData=function(e,t){try{switch(e){case o.BenzCommand.CMD_SHOW_REWARD_VIDEO_AD:this.canShowAd()&&(this._rewardData=t,this.sendDataToNative())}}catch(e){}},e.prototype.sendDataToNative=function(){var e=this;this.canPlayAd()?window.h5api.playAd(function(t){1e4===t.code?console.log("\u5f00\u59cb\u64ad\u653e"):10001===t.code?(console.log("\u64ad\u653e\u7ed3\u675f"),e._rewardData&&(e._rewardData.success(),e.setTipCount())):(console.log("\u5e7f\u544a\u5f02\u5e38"),e._rewardData&&e._rewardData.fail())}):(console.log("\u5f53\u524d\u65e0\u5e7f\u544a\u64ad\u653e"),this._rewardData&&this._rewardData.fail())},e.prototype.receiveData=function(e,t){},e.prototype.loadStorageData=function(e,t,n){try{for(var o={},i=0;i<e.length;i++){var a=e[i];o[a]=cc.sys.localStorage.getItem(a)}t(o)}catch(e){n(e)}},e.prototype.flushStorageData=function(e,t){try{Object.keys(e).forEach(function(t){cc.sys.localStorage.setItem(t,e[t])}),t(null)}catch(e){t(e)}},e.prototype.submitScore=function(e,t){},e.prototype.invite=function(e){e(null)},e.prototype.challenge=function(e){e(new Error("no need challenge now"))},e.prototype.getLeaderboard=function(e,t){},e.prototype.canPlayAd=function(){a.BenzLog.log("_remainTime:"+this._remainTime);var e=this;try{return window.h5api.canPlayAd(function(t){a.BenzLog.log("\u662f\u5426\u53ef\u64ad\u653e\u5e7f\u544a\uff1a"+t.canPlayAd+"  \u5269\u4f59\u6b21\u6570:"+t.remain),e._remainTime=t.remain})}catch(e){a.BenzLog.logError(e)}},e.prototype.canShowAd=function(){return this._isLoad||(this._isLoad=!0,this.canPlayAd()),this._remainTime>0},e}();n.Benz4399Platform=r,cc._RF.pop()},{"../Benz/BenzLog":"BenzLog","../Manager/DataManager":"DataManager","./BenzCommand":"BenzCommand"}],BenzAdsEntity:[function(e,t,n){"use strict";cc._RF.push(t,"fc302sHn+VI1rSlvM3gkYIv","BenzAdsEntity"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],BenzCommand:[function(e,t,n){"use strict";cc._RF.push(t,"0946ajQwFFO8IAcyGb+nGQg","BenzCommand"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){}return e.CMD_SDK_INIT=1e4,e.CMD_SHOW_REWARD_VIDEO_AD=10001,e.CMD_SHOW_NONE_REWARD_VIDEO_AD=10002,e.CMD_SHOW_BANNER_AD=10003,e.CMD_SHOW_FULL_SCREEN_AD=10004,e.CMD_HIDE_BANNER_AD=10102,e.RESPONSE_CMD_SHOW_REWARD_VIDEO_AD=20001,e.CMD_SHARE=30001,e.CMD_GET_RANK=30002,e.CMD_FINISH_CHALLENGE=30003,e.FIELD_RESULT="result",e.RESULT_FAIL=0,e.RESULT_OK=1,e}();n.BenzCommand=o,cc._RF.pop()},{}],BenzFacebookPlatform:[function(e,t,n){"use strict";cc._RF.push(t,"1770cCgy/1JWrfyfKomeK42","BenzFacebookPlatform"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../Benz/BenzLog"),i=e("./BenzCommand"),a=e("./BenzSocialManager"),r=e("../Collection/Dictionary"),s=function(){function e(){this._preloadedDic=new r.Dictionary}return e.prototype.init=function(){try{var e=FBInstant.getSupportedAPIs();e&&e.includes("getInterstitialAdAsync")&&(this.loadRewardAd(),this.loadInterstitialAd())}catch(e){}},e.prototype.sendData=function(e,t){switch(e){case i.BenzCommand.CMD_GET_RANK:this.updateRank();break;case i.BenzCommand.CMD_SHOW_REWARD_VIDEO_AD:this.showRewardAd(t);break;case i.BenzCommand.CMD_SHOW_NONE_REWARD_VIDEO_AD:this.showInterstitialAd();break;case i.BenzCommand.CMD_SHOW_BANNER_AD:break;case i.BenzCommand.CMD_FINISH_CHALLENGE:this.quitGame()}},e.prototype.receiveData=function(e,t){},e.prototype.loadStorageData=function(e,t,n){try{FBInstant.player.getDataAsync(e).then(function(n){for(var o={},i=0;i<e.length;i++){var a=e[i];o[a]=n[a]}t(o)}).catch(function(e){n(e)})}catch(e){n(e)}},e.prototype.flushStorageData=function(e,t){try{FBInstant.player.setDataAsync(e).then(function(){o.BenzLog.log("[BenzFacebookPlatform] data is set"),t(null)}).catch(function(e){t(e)})}catch(e){t(e)}},e.prototype.submitScore=function(t,n){try{var i=!1,r=FBInstant.context.getID();r&&(i=!0,FBInstant.getLeaderboardAsync(e.TOP_THREAD_LEADERBOARD+r).then(function(e){return e.setScoreAsync(t)}).then(function(e){a.BenzSocialManager.getInstance().setCurrentRank(e.getRank()),n&&n(null)}).catch(function(e){o.BenzLog.logError(e)}),FBInstant.updateAsync({action:"LEADERBOARD",name:e.TOP_THREAD_LEADERBOARD+r,text:o.BenzLog.format("I've passed level {0}! Come challenge!",t)}).catch(function(e){o.BenzLog.logError(e)})),FBInstant.getLeaderboardAsync(e.TOP_LEADERBOARD).then(function(e){return e.setScoreAsync(t)}).then(function(e){i||(a.BenzSocialManager.getInstance().setCurrentRank(e.getRank()),n&&n(null))}).catch(function(e){return o.BenzLog.logError(e)})}catch(e){}},e.prototype.quitGame=function(){try{FBInstant.context.getID()&&FBInstant.quit()}catch(e){}},e.prototype.invite=function(e){try{FBInstant.context.getID()?(o.BenzLog.log("[BenzSocialManager] has match id"),e&&e(null)):FBInstant.checkCanPlayerMatchAsync().then(function(t){t?(o.BenzLog.log("[BenzSocialManager] can match friends"),FBInstant.matchPlayerAsync("challenge").then(function(){e&&e(null)}).catch(function(t){e&&e(t),o.BenzLog.logError(t)})):(o.BenzLog.log("[BenzSocialManager] can not match friends"),e&&e(null))}).catch(function(t){e&&e(t),o.BenzLog.logError(t)})}catch(t){e&&e(t)}},e.prototype.challenge=function(e){try{if(!FBInstant.context.getID())return void e(new Error("no challenge"));e(null)}catch(t){e&&e(t)}},e.prototype.getLeaderboard=function(t,n){FBInstant.getLeaderboardAsync(e.TOP_LEADERBOARD).then(function(e){return e.getEntriesAsync(a.BenzSocialManager.PAGE_COUNT,0)}).then(function(e){for(var n=[],o=0;o<e.length;o++)try{n.push({name:e[o].getPlayer().getName(),avatarUrl:e[o].getPlayer().getPhoto(),score:e[o].getScore(),rank:e[o].getRank(),x:0,y:0})}catch(e){}t(n)}).catch(function(e){n(e),o.BenzLog.logError(e)})},e.prototype.updateRank=function(){try{var t="",n=FBInstant.context.getID();t=n?e.TOP_THREAD_LEADERBOARD+n:e.TOP_LEADERBOARD,FBInstant.getLeaderboardAsync(t).then(function(e){return e.getPlayerEntryAsync()}).then(function(e){a.BenzSocialManager.getInstance().setLastRank(e.getRank())}).catch(function(e){return o.BenzLog.logError(e)})}catch(e){}},e.prototype.showRewardAd=function(t){o.BenzLog.IsDebug?t.success():this.playAd(e.REWARD_PLACEMENT_ID,!0,t)},e.prototype.loadRewardAd=function(){this.loadAd(e.REWARD_PLACEMENT_ID,!0)},e.prototype.showInterstitialAd=function(){this.playAd(e.INTERSTITIAL_PLACEMENT_ID,!1)},e.prototype.loadInterstitialAd=function(){this.loadAd(e.INTERSTITIAL_PLACEMENT_ID,!1)},e.prototype.playAd=function(e,t,n){try{var i=this,a=i._preloadedDic.get(e);if(a)return void a.showAsync().then(function(){n&&n.success(),i.loadAd(e,t)}).catch(function(a){n&&n.fail(),i.loadAd(e,t),o.BenzLog.logError(a)});(t?FBInstant.getRewardedVideoAsync(e):FBInstant.getInterstitialAdAsync(e)).then(function(e){return(a=e).loadAsync()}).then(function(){return a.showAsync()}).then(function(){n&&n.success()}).catch(function(e){n&&n.fail(),o.BenzLog.logError(e)})}catch(o){n&&n.fail(),this.loadAd(e,t)}},e.prototype.loadAd=function(e,t){try{var n=this;n._preloadedDic.set(e,null);(t?FBInstant.getRewardedVideoAsync(e):FBInstant.getInterstitialAdAsync(e)).then(function(t){return n._preloadedDic.set(e,t),t.loadAsync()}).then(function(){}).catch(function(t){n._preloadedDic.set(e,null),o.BenzLog.logError(t)})}catch(t){this._preloadedDic.set(e,null)}},e.prototype.canShowAd=function(){return!0},e.TOP_LEADERBOARD="Global leaderboard",e.TOP_THREAD_LEADERBOARD="Leaderboard.",e.INTERSTITIAL_PLACEMENT_ID="2228029680801371_2228606617410344",e.REWARD_PLACEMENT_ID="2228029680801371_2228601364077536",e}();n.BenzFacebookPlatform=s,cc._RF.pop()},{"../Benz/BenzLog":"BenzLog","../Collection/Dictionary":"Dictionary","./BenzCommand":"BenzCommand","./BenzSocialManager":"BenzSocialManager"}],BenzLeaderboardEntity:[function(e,t,n){"use strict";cc._RF.push(t,"e090a2vFxZJuJr0tz6qW6kc","BenzLeaderboardEntity"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],BenzLog:[function(e,t,n){"use strict";cc._RF.push(t,"4937d9egL9ItrbeBiRxe4jT","BenzLog"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){}return e.log=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];e.IsDebug&&(n?console.log(t.replace(/\{(\d+)\}/g,function(e,t){return n[parseInt(t)]})):e.log(t))},e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=t;return e.replace(/\{(\d+)\}/g,function(e,t){return o[parseInt(t)]})},e.dataLeftCompleting=function(e,t,n){return(Array(e+1).join(t)+n).slice(-e)},e.safeDestroy=function(e){e&&e.isValid&&e.destroy()},e.logError=function(t){e.IsDebug&&console.error(t)},e.IsDebug=!1,e}();n.BenzLog=o,cc._RF.pop()},{}],BenzMobileNativePlatform:[function(e,t,n){"use strict";cc._RF.push(t,"e6080bG009CtJOaKftkh6su","BenzMobileNativePlatform"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./BenzCommand"),i=e("../Benz/BenzLog"),a=function(){function e(){this._rewardData=null}return e.prototype.init=function(){try{this.sendDataToNative(o.BenzCommand.CMD_SDK_INIT,{gameid:"",channel:10001,ad:{appid:e.APP_ID,videoAdKey:e.VIDEO_AD_KEY,awardAdKey:e.AWARD_AD_KEY,picAdKey:e.PIC_AD_KEY,bannerAdKey:e.BANNER_AD_KEY}})}catch(e){i.BenzLog.log("error:"+e)}},e.prototype.sendData=function(e,t){try{switch(e){case o.BenzCommand.CMD_SHOW_REWARD_VIDEO_AD:this._rewardData=t}this.sendDataToNative(e,null)}catch(e){}},e.prototype.receiveData=function(e,t){try{i.BenzLog.log("[Platform] Type:{0} Content:{1}",e,t);var n=decodeURIComponent(t);switch(e){case o.BenzCommand.RESPONSE_CMD_SHOW_REWARD_VIDEO_AD:try{JSON.parse(n)[o.BenzCommand.FIELD_RESULT]>=o.BenzCommand.RESULT_OK?this._rewardData&&this._rewardData.success():this._rewardData&&this._rewardData.fail()}catch(e){this._rewardData&&this._rewardData.fail()}finally{this._rewardData=null}}}catch(e){}},e.prototype.sendDataToNative=function(e,t){t?jsb.reflection.callStaticMethod("org/benz/tgsdk/BenzSDKWrapper","receiveJSData","(ILjava/lang/String;)V",e,JSON.stringify(t)):jsb.reflection.callStaticMethod("org/benz/tgsdk/BenzSDKWrapper","receiveJSData","(ILjava/lang/String;)V",e,"")},e.prototype.CallJava=function(e,t,n){i.BenzLog.log("CallJava >>  ; "+e+" ; "+t+" ; "+n),n?jsb.reflection.callStaticMethod("org/benz/tgsdk/BenzSDKWrapper",e,"(ILjava/lang/String;)V",t,JSON.stringify(n)):jsb.reflection.callStaticMethod("org/benz/tgsdk/BenzSDKWrapper",e,"(ILjava/lang/String;)V",t,"")},e.prototype.loadStorageData=function(e,t,n){try{for(var o={},i=0;i<e.length;i++){var a=e[i];o[a]=cc.sys.localStorage.getItem(a)}t(o)}catch(e){n(e)}},e.prototype.flushStorageData=function(e,t){try{Object.keys(e).forEach(function(t){cc.sys.localStorage.setItem(t,e[t])}),t(null)}catch(e){t(e)}},e.prototype.submitScore=function(e,t){},e.prototype.invite=function(e){e(null)},e.prototype.challenge=function(e){e(new Error("no need challenge now"))},e.prototype.getLeaderboard=function(e,t){},e.prototype.canShowAd=function(){return!0},e.APP_ID="Zjb8o6Y5OI2i4XuJ7Uq7",e.VIDEO_AD_KEY="TrePMkgz9PFf96bVi0G",e.AWARD_AD_KEY="oXMI1qdSfB0q50FiOdb",e.PIC_AD_KEY="lwfZNZVai7ojsATVoKe",e.BANNER_AD_KEY="",e}();n.BenzMobileNativePlatform=a,cc._RF.pop()},{"../Benz/BenzLog":"BenzLog","./BenzCommand":"BenzCommand"}],BenzPlatformManager:[function(e,t,n){"use strict";cc._RF.push(t,"738d98FA6hM960TcqOSzxIP","BenzPlatformManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./BenzMobileNativePlatform"),i=e("./BenzPlatformType"),a=e("./BenzFacebookPlatform"),r=e("./Benz4399Platform"),s=function(){function e(){}return e.initPlatform=function(){var e;cc.sys.isMobile&&!cc.sys.isBrowser&&cc.sys.platform==cc.sys.ANDROID?e=i.BenzPlatformType.MobileNative:cc.sys.isBrowser&&(e=i.BenzPlatformType.Web),this.init(e)},e.init=function(t){switch(e._type=t,e._type){case i.BenzPlatformType.Facebook:window.benzPlatform=new a.BenzFacebookPlatform;break;case i.BenzPlatformType.Weixin:break;case i.BenzPlatformType.MobileNative:window.benzPlatform=new o.BenzMobileNativePlatform;break;case i.BenzPlatformType.Web:window.benzPlatform=new r.Benz4399Platform}window.benzPlatform||(window.benzPlatform=new a.BenzFacebookPlatform),this.sdk.init()},e.sendData=function(e,t){this.sdk.sendData(e,t)},e.receiveData=function(e,t){this.sdk.receiveData(e,t)},e.loadStorageData=function(e,t,n){this.sdk.loadStorageData(e,t,n)},e.flushStorageData=function(e,t){this.sdk.flushStorageData(e,t)},e.submitScore=function(e,t){this.sdk.submitScore(e,t)},e.invite=function(e){this.sdk.invite(e)},e.challenge=function(e){this.sdk.challenge(e)},e.getLeaderboard=function(e,t){this.sdk.getLeaderboard(e,t)},Object.defineProperty(e,"sdk",{get:function(){return window.benzPlatform},enumerable:!0,configurable:!0}),e.canShowAd=function(){return window.benzPlatform.canShowAd()},e._type=i.BenzPlatformType.Facebook,e}();n.BenzPlatformManager=s,cc._RF.pop()},{"./Benz4399Platform":"Benz4399Platform","./BenzFacebookPlatform":"BenzFacebookPlatform","./BenzMobileNativePlatform":"BenzMobileNativePlatform","./BenzPlatformType":"BenzPlatformType"}],BenzPlatformType:[function(e,t,n){"use strict";cc._RF.push(t,"e1de6pIYeJHlJz3Vi+jYgeq","BenzPlatformType"),Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.Facebook=0]="Facebook",e[e.Weixin=1]="Weixin",e[e.MobileNative=2]="MobileNative",e[e.Web=3]="Web"}(n.BenzPlatformType||(n.BenzPlatformType={})),cc._RF.pop()},{}],BenzPlatform:[function(e,t,n){"use strict";cc._RF.push(t,"889ede1h9VEcYUu4ZwIlm/c","BenzPlatform"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],BenzSocialManager:[function(e,t,n){"use strict";cc._RF.push(t,"72770nLnj5CaLag7fg3jqp6","BenzSocialManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../Benz/BenzLog"),i=e("./BenzPlatformManager"),a=e("./BenzCommand"),r=function(){function e(){this.lastRank=0,this.currentRank=0}return e.getInstance=function(){return this._instance},e.prototype.init=function(){o.BenzLog.log("[BenzSocialManager] Init"),this.updateRankInfo()},e.prototype.setLastRank=function(e){e>0&&(this.lastRank=e)},e.prototype.setCurrentRank=function(e){e>0&&(this.currentRank=e)},e.prototype.getRankUp=function(){return this.lastRank<=0?this.currentRank:this.lastRank-this.currentRank},e.prototype.getCurrentRank=function(){return this.currentRank},e.prototype.updateRankInfo=function(){i.BenzPlatformManager.sendData(a.BenzCommand.CMD_GET_RANK,null)},e.prototype.invite=function(e){i.BenzPlatformManager.invite(e)},e.prototype.submitScore=function(e,t){e<=0||i.BenzPlatformManager.submitScore(e,t)},e.prototype.share=function(e){i.BenzPlatformManager.sendData(a.BenzCommand.CMD_SHARE,e)},e.PAGE_COUNT=100,e._instance=new e,e}();n.BenzSocialManager=r,cc._RF.pop()},{"../Benz/BenzLog":"BenzLog","./BenzCommand":"BenzCommand","./BenzPlatformManager":"BenzPlatformManager"}],BenzWebPlatform:[function(e,t,n){"use strict";cc._RF.push(t,"0434aIuvYFP+qtB3FbGzMwl","BenzWebPlatform"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../Benz/BenzLog"),i=function(){function e(){}return e.prototype.init=function(){},e.prototype.sendData=function(e,t){},e.prototype.receiveData=function(e,t){try{o.BenzLog.log("[Platform] Type:{0} Content:{1}",e,t)}catch(e){}},e.prototype.loadStorageData=function(e,t,n){try{for(var o={},i=0;i<e.length;i++){var a=e[i];o[a]=cc.sys.localStorage.getItem(a)}t(o)}catch(e){n(e)}},e.prototype.flushStorageData=function(e,t){try{Object.keys(e).forEach(function(t){cc.sys.localStorage.setItem(t,e[t])}),t(null)}catch(e){t(e)}},e.prototype.submitScore=function(e,t){},e.prototype.invite=function(e){e(null)},e.prototype.challenge=function(e){e(new Error("no need challenge now"))},e.prototype.getLeaderboard=function(e,t){},e.prototype.canShowAd=function(){return!0},e}();n.BenzWebPlatform=i,cc._RF.pop()},{"../Benz/BenzLog":"BenzLog"}],ButtonEffect:[function(e,t,n){"use strict";cc._RF.push(t,"16550DGnwFJDLcQPRwzkV0o","ButtonEffect"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./AudioManager"),i=cc._decorator,a=i.ccclass,r=i.property,s=cc.Class({name:"BtnAnim",properties:{duration:{default:0,displayName:"Duration",tooltip:"\u65f6\u95f4"},scale:{default:0,displayName:"Scale",tooltip:"\u7f29\u653e\u503c"}},__ctor__:function(e,t){this.duration=e,this.scale=t}}),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.playSound=!0,t.playScale=!0,t.sequence=[new s(.1,1.3),new s(.1,.8),new s(.1,1)],t}return __extends(t,e),t.prototype.onLoad=function(){this.node.on("click",this._onItemClick,this);var e=this.node.getComponent(cc.Button);null!=e&&e.transition==cc.Button.Transition.SCALE&&(e.transition=cc.Button.Transition.NONE)},t.prototype.onDestroy=function(){this.node.off("click",this._onItemClick,this)},t.prototype._onItemClick=function(){if(this.playSound&&o.default.instance.play(o.SoundType.Effect,o.SoundName.ClickBtn),this.playScale){for(var e=null,t=0,n=this.sequence;t<n.length;t++){var i=n[t];e=null==e?cc.scaleTo(i.duration,i.scale):cc.sequence(e,cc.scaleTo(i.duration,i.scale))}this.node.scale=1,null!=e&&this.node.runAction(e)}},__decorate([r],t.prototype,"playSound",void 0),__decorate([r],t.prototype,"playScale",void 0),__decorate([r([s])],t.prototype,"sequence",void 0),t=__decorate([a],t)}(cc.Component);n.default=c,cc._RF.pop()},{"./AudioManager":"AudioManager"}],ChangeAnimCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"5e9ba/e3ddPt5HsB6XUMP7N","ChangeAnimCtrl"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=o.ccclass,a=o.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mask=null,t.speed=100,t._changedCallBack=null,t._playForward=!1,t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n._instance=this,this.node.active=!1},t.prototype.show=function(e){this._changedCallBack=e,this.mask.setContentSize(cc.size(2500,2500)),this.node.active=!0,this._playForward=!0},t.prototype.update=function(e){this._playForward?(this.mask.width-=e*this.speed,this.mask.height=this.mask.width,this.mask.width<=0&&(null!=this._changedCallBack&&this._changedCallBack(),this._playForward=!1)):(this.mask.width+=e*this.speed,this.mask.height=this.mask.width,this.mask.width>=2500&&(this.node.active=!1))},t._instance=null,__decorate([a(cc.Node)],t.prototype,"mask",void 0),__decorate([a],t.prototype,"speed",void 0),t=n=__decorate([i],t)}(cc.Component);n.default=r,cc._RF.pop()},{}],ConfirmCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"5480c1RP7ZN3Ly8Z/9tLG7O","ConfirmCtrl"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./GameCtrl"),i=e("./LanguageKey"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tipLab=null,t.confirmLab=null,t.cancelLab=null,t.animation=null,t._isHide=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.animation.on("finished",function(e){this._isHide&&(this.node.active=!1)},this)},t.prototype.onEnable=function(){o.default.instance.setMask(!0)},t.prototype.onDisable=function(){o.default.instance.setMask(!1)},t.prototype.show=function(e,t,n){this.node.active=!0,this._isHide=!1,this.confirm=e,this.cancel=t,this.confirmFunc=null,this.cancelFunc=null,this.tipLab.string=n,this.animation.play(o.AnimName.Show)},t.prototype.showConfirm=function(e,t,n){this.node.active=!0,this._isHide=!1,this.confirm=null,this.cancel=null,this.confirmFunc=e,this.cancelFunc=t,this.tipLab.string=n,this.animation.play(o.AnimName.Show)},t.prototype.onConfirm=function(){null!==this.confirm&&this.confirm.emit([]),null!==this.confirmFunc&&this.confirmFunc(),this._hide()},t.prototype.onCancel=function(){null!==this.cancel&&this.cancel.emit([]),null!==this.cancelFunc&&this.cancelFunc(),this._hide()},t.prototype._hide=function(){this._isHide=!0,this.animation.play(o.AnimName.Hide)},t.prototype.setText=function(){this.confirmLab.string=i.default.instance.getString("confirm"),this.cancelLab.string=i.default.instance.getString("cancel")},__decorate([s(cc.Label)],t.prototype,"tipLab",void 0),__decorate([s(cc.Label)],t.prototype,"confirmLab",void 0),__decorate([s(cc.Label)],t.prototype,"cancelLab",void 0),__decorate([s(cc.Animation)],t.prototype,"animation",void 0),t=__decorate([r],t)}(cc.Component);n.default=c,cc._RF.pop()},{"./GameCtrl":"GameCtrl","./LanguageKey":"LanguageKey"}],DataManager:[function(e,t,n){"use strict";cc._RF.push(t,"c7b8fQDr5hBlbJr0GlPWLGG","DataManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../Collection/Dictionary"),i=e("../Platform/BenzPlatformManager"),a=e("../Benz/BenzLog"),r=function(){function e(){this._isLocalStorage=!1,this._isModify=!1,this._rootDataKeyArray=[],this._records=new o.Dictionary}return e.getInstance=function(){return this._instance},e.prototype.init=function(){a.BenzLog.log("[DataManager] Init"),this.addRootDataKey(e.GAME_COMMON_DATA);var t=this;try{i.BenzPlatformManager.loadStorageData(t._rootDataKeyArray,function(n){n?(t._rootDataKeyArray.forEach(function(o){if(e.GAME_COMMON_DATA==o){var i=JSON.parse(n[e.GAME_COMMON_DATA]);if(i)Object.keys(i).forEach(function(e){t._records.set(e,i[e])})}else try{t._records.set(o,n[o])}catch(e){a.BenzLog.log("[DataManager] Get Root Data error: "+o)}}),t.initWithData()):t.initWithData()},function(e){t._isLocalStorage=!0,t.initWithData(),a.BenzLog.logError(e)})}catch(e){t._isLocalStorage=!0,t.initWithData()}},e.prototype.addRootDataKey=function(e){this._rootDataKeyArray.push(e)},e.prototype.initWithData=function(){if(a.BenzLog.log("[DataManager] initWithData"),this._isLocalStorage)try{var t=this;t._rootDataKeyArray.forEach(function(n){if(e.GAME_COMMON_DATA==n){var o=JSON.parse(cc.sys.localStorage.getItem(e.GAME_COMMON_DATA));if(o)Object.keys(o).forEach(function(e){t._records.set(e,o[e])})}else try{t._records.set(n,cc.sys.localStorage.getItem(n))}catch(e){a.BenzLog.log("[DataManager] Get Root Local Data error: "+n)}})}catch(e){a.BenzLog.log("[DataManager] initWithData read local data fail"),a.BenzLog.logError(e)}},e.prototype.flushCommon=function(){this.flush([e.GAME_COMMON_DATA])},e.prototype.flush=function(t){if(a.BenzLog.log("[DataManager] flush"),this._isModify){var n;a.BenzLog.log("[DataManager] flush 1"),n=t||this._rootDataKeyArray;try{for(var o={},r=0;r<n.length;r++){var s=n[r];e.GAME_COMMON_DATA==s?o[s]=this.getCommonData():o[s]=this.getItem(s).toString()}i.BenzPlatformManager.flushStorageData(o,function(e){e&&(Object.keys(o).forEach(function(e){cc.sys.localStorage.setItem(e,o[e])}),a.BenzLog.logError(e))}),this._isModify=!1}catch(e){a.BenzLog.log("[DataManager] flush data fail"),a.BenzLog.logError(e)}}},e.prototype.getCommonData=function(){var e=this._records.keys;if(e&&e.length>0){for(var t={},n=this._records.keys,o=0;o<n.length;o++){var i=n[o];this._rootDataKeyArray.indexOf(i)<0&&(t[i]=this._records.get(i))}return JSON.stringify(t)}return""},e.prototype.getItem=function(e){return this._records.get(e)},e.prototype.setItem=function(e,t){return this._isModify=!0,this._records.set(e,t),!0},e.prototype.removeItem=function(e){this._isModify=!0,this._records.remove(e)},e.prototype.containsKey=function(e){return this._records.containsKey(e)},e.prototype.getIntegerForKey=function(e,t){if(!this.containsKey(e))return t;var n=this.getItem(e);try{return parseInt(n.toString())}catch(e){}return t},e.prototype.getBooleanForKey=function(e,t){return this.containsKey(e)?"true"==this.getItem(e).toString():t},e.prototype.getStringForKey=function(e,t){return this.containsKey(e)?this.getItem(e):t},e.prototype.getFloatForKey=function(e,t){if(!this.containsKey(e))return t;var n=this.getItem(e);try{return parseFloat(n.toString())}catch(e){}return t},e.GAME_COMMON_DATA="game_common_data",e._instance=new e,e}();n.DataManager=r,cc._RF.pop()},{"../Benz/BenzLog":"BenzLog","../Collection/Dictionary":"Dictionary","../Platform/BenzPlatformManager":"BenzPlatformManager"}],Dictionary:[function(e,t,n){"use strict";cc._RF.push(t,"ba8c4PmPSJLALdFOgytvnQO","Dictionary"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){this.m_keys=[],this.m_values=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.m_keys.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){return this.m_values.concat()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return this.m_keys.concat()},enumerable:!0,configurable:!0}),e.prototype.indexOfKey=function(e){return this.m_keys.indexOf(e)},e.prototype.indexOfValue=function(e){return this.m_values.indexOf(e)},e.prototype.getKeyByValue=function(e){return this.m_keys[this.indexOfValue(e)]},e.prototype.add=function(e,t){var n=this.indexOfKey(e);n>=0?this.m_values[n]=t:(this.m_keys.push(e),this.m_values.push(t))},e.prototype.get=function(e){var t=this.indexOfKey(e);return t>=0?this.m_values[t]:null},e.prototype.set=function(e,t){var n=this.indexOfKey(e);n>=0?this.m_values[n]=t:this.add(e,t)},e.prototype.remove=function(e){var t=this.indexOfKey(e);return t>=0?(this.m_keys.splice(t,1),this.m_values.splice(t,1)[0]):null},e.prototype.containsKey=function(e){return this.indexOfKey(e)>=0},e.prototype.clear=function(){this.m_keys.length=0,this.m_values.length=0},e.prototype.setLength=function(e){this.m_keys.length=e,this.m_values.length=e},e.prototype.getRandomData=function(){var e=Math.random()*this.keys.length<<0;return this.m_values[e]},e}();n.Dictionary=o,cc._RF.pop()},{}],GameCommonData:[function(e,t,n){"use strict";cc._RF.push(t,"04fabgVRXNM66aiDpMKjZao","GameCommonData"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../Manager/DataManager"),i=function(){function e(){}return e.setCurrentLevel=function(t){o.DataManager.getInstance().setItem(e.CURRENT_LEVEL_ID,t)},e.getCurrentLevel=function(){return o.DataManager.getInstance().getIntegerForKey(e.CURRENT_LEVEL_ID,1)},e.setMusic=function(t){o.DataManager.getInstance().setItem(e.MUSIC_SWITCH,t)},e.isMusicOn=function(){return o.DataManager.getInstance().getBooleanForKey(e.MUSIC_SWITCH,!0)},e.setSound=function(t){o.DataManager.getInstance().setItem(e.SOUND_SWITCH,t)},e.isSoundOn=function(){return o.DataManager.getInstance().getBooleanForKey(e.SOUND_SWITCH,!0)},e.CURRENT_LEVEL_ID="current_level_id",e.MUSIC_SWITCH="music_switch",e.SOUND_SWITCH="sound_switch",e.ACHIVEMENT_PUZZLE="achivement_puzzle",e.MAX_PUZZLE_LEVEL="max_puzzle_level",e.CURRENT_GAME_MODE="current_game_mode",e.CHALLENGE_BEST_SCORE="challenge_best_score",e.CHALLENGE_BEST_LEVEL="challenge_best_level",e}();n.GameCommonData=i,cc._RF.pop()},{"../Manager/DataManager":"DataManager"}],GameCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"24cdbw9j4lMRbLKs5yfKz1X","GameCtrl"),Object.defineProperty(n,"__esModule",{value:!0});var o,i=e("./HeapCtrl"),a=e("./SquareItem"),r=e("./HeapData"),s=e("./OverPanelCtrl"),c=e("./NewEffectUnlockCtrl"),l=e("./PauseCtrl"),u=e("./ConfirmCtrl"),h=e("./LanguageKey"),p=e("./AudioManager"),d=e("./ChangeAnimCtrl"),f=e("./StepCtrl"),g=e("./Manager/AdsManager"),_=e("./Platform/BenzPlatformManager"),m=e("./Manager/DataManager"),y=cc._decorator,v=y.ccclass,D=y.property;(function(e){e[e.None=-1]="None",e[e.Thunder=0]="Thunder",e[e.DropOne=1]="DropOne",e[e.RefreshHeaps=2]="RefreshHeaps",e[e.Revocation=3]="Revocation"})(o||(o={})),n.EffectType=o;n.AnimName={Show:"show",Hide:"hide"};var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.squareNum=0,t.is4399Platform=!1,t.Logo=null,t.isDeleting=!1,t.DelRules=[],t.boardTiles=[],t.fillTiles=[],t.dropTiles=[],t.TrailingEffect=null,t.toolMask=[],t.stepPanel=null,t.selectHeaps=new Array,t.heapsRefreshEffect=[],t.squareItems=new Array,t.squareLayer=null,t.pausePanel=null,t.confirmCtrl=null,t.effectNodes=[],t.getToolEffects=[],t.buttonAtlas=null,t.showToolsParent=null,t.deleteEffectPrefab=null,t.effectParent=null,t.soundIcon=null,t.padding=0,t.yPadding=0,t.spacing=0,t.line=0,t.column=0,t.square=null,t.gameNode=null,t.languageLab=null,t.startLab=null,t.topScoreText=null,t.scoreLab=null,t.topScoreLab=null,t.effectTipLab=null,t.overPanel=null,t.effectLab=[],t.effectsUnlockNode=null,t.fireDeleteNum=6,t.effeckUnlockCtrl=null,t.getEffectBorns=0,t.dropDistance=30,t.toolRate=0,t.thunderTip=null,t.languageBtn=null,t.isUseSysLanguage=!0,t.mask=null,t.widgets=[],t.guideMask=null,t.guidePoint=null,t.guideObj=null,t.scoreEffect=null,t.guideStepPoint=[],t.guideData=null,t.simpleData=new Array,t.lastDatas=[{type:1,index:1,isUsed:!1},{type:1,index:1,isUsed:!1},{type:1,index:1,isUsed:!1}],t.isChinese=!0,t.maskPanelNum=0,t._hideTools=[],t.playings=[!1,!1,!1],t.score=0,t.isGame=!1,t.highScore=0,t._isGuide=!0,t._isGuiding=!1,t._guideStep=0,t._guideDrop=[],t.isTouch=!1,t.touchCtrl=null,t.effects={0:{num:0,isLock:!0},1:{num:0,isLock:!0},2:{num:0,isLock:!0},3:{num:0,isLock:!0}},t.rebornCount=0,t.preIndex=-1,t._simpleHeaps=[0,1,2,3],t._nomalHeaps=[4,5,6,7,8,9,10],t._difHeaps=[11,12,13,14],t.heapUsedCount=0,t.showTip=null,t.endGame=null,t._tipString="",t._resetCount=0,t._isUseThunder=!1,t._isDropOne=!1,t.hoverSprite=null,t}var n;return __extends(t,e),n=t,t.prototype.onLoad=function(){n.instance=this,this.isChinese=cc.sys.language===cc.sys.LANGUAGE_CHINESE,_.BenzPlatformManager.initPlatform(),m.DataManager.getInstance().init(),g.AdsManager.getInstance().init(),this.squareNum=this.line*this.column;for(var e=0;e<this.column;e++){for(var t=[],o=0;o<this.line;o++)t.push(e*this.line+o);this.DelRules.push(t)}for(e=0;e<this.line;e++){for(t=[],o=0;o<this.column;o++)t.push(o*this.column+e);this.DelRules.push(t)}var i=m.DataManager.getInstance().getIntegerForKey("highScore",0);this.highScore=i,this.topScoreLab.string=this.highScore.toString(),this.stepPanel.getComponent(f.default).setScore(this.highScore),this.isUseSysLanguage?this.languageBtn.active=!1:(this.languageBtn.active=!0,this.isChinese=m.DataManager.getInstance().getBooleanForKey("isChinese",!0)),this._isGuide=m.DataManager.getInstance().getBooleanForKey("isGuide",!0);for(e=0;e<this.effectNodes.length;e++){var a=cc.instantiate(this.deleteEffectPrefab);a.setParent(this.effectNodes[e]),a.position=cc.Vec2.ZERO,a.active=!1,this.getToolEffects.push(a.getComponent(sp.Skeleton))}var s=this.node.getComponent(cc.Canvas);if(null!=s){var c=cc.winSize.height/cc.winSize.width<1.777778;s.fitHeight=c,s.fitWidth=!c}this.scheduleOnce(function(){for(var e=0,t=this.widgets;e<t.length;e++){t[e].updateAlignment()}},0),this.stepPanel.active=!0,this.gameNode.active=!1,this.overPanel.active=!1;var l=this;this.pausePanel.init(this),cc.loader.loadRes("config/HeapDatas.json",function(e,t){if(e)cc.log(e);else{for(var n=t.json.simple,o=0;o<n.length;o++){var i=new r.default;i.init(n[o]),l.simpleData.push(i)}l.guideData=t.json.guideData}}),this.init(),this.maskPanelNum=0,this.mask.active=!1,this._initHeapsRefreshEffects()},t.prototype.start=function(){this.is4399Platform?this.Logo&&(this.Logo.active=!0,this.Logo.setSiblingIndex(10)):this.Logo&&(this.Logo.active=!1),this.isChinese?this.languageLab.string="ZH":this.languageLab.string="EN",this.SetText(),this.refreshSoundIcon()},t.prototype.refreshSoundIcon=function(){this.soundIcon.spriteFrame=p.default.instance.isMute?this.buttonAtlas.getSpriteFrame("shengyin_close"):this.buttonAtlas.getSpriteFrame("shengyin")},t.prototype.reset=function(){this._resetCount>=3&&!cc.sys.isBrowser&&(this._resetCount=0,g.AdsManager.getInstance().showInterstitialAd()),this._guideStep=0,this._resetCount++,this.rebornCount=1,this.isGame=!0,this.score=0,this.scoreLab.string="0",this.resetEffects(),this.resetSquares(),this.randomHeaps(),this._isGuide&&(this._isGuiding=!0,this.setGuideDatas()),cc.sys.isBrowser&&this.setUnlock(1)},t.prototype.setGuideDatas=function(){for(var e=0;e<this.guideData.data.length;e++)this.guideData.data[e]>0&&(this.squareItems[e].isFulled=this.guideData.data[e]>0,this.squareItems[e].bg.spriteFrame=this.buttonAtlas.getSpriteFrame("color_"+this.guideData.data[e]));this.heapUsedCount=0;var t=this.simpleData;for(e=0;e<3;e++){var n=t[this.guideData.heaps[e][0]];this.selectHeaps[e].init(n,this.guideData.heaps[e][1],this)}this.SetGuideStep()},t.prototype.SetGuideStep=function(){var e=this;if(this._isGuiding&&this._guideStep<3){this.guideObj.active=!0,this._guideDrop=this.guideData.guideStep[this._guideStep],this.guideMask.spriteFrame=this.buttonAtlas.getSpriteFrame("step_"+this._guideStep),this.guidePoint.stopAllActions();var t=this.guideStepPoint[2*this._guideStep];this.guidePoint.position=t;var n=this.guideStepPoint[2*this._guideStep+1],o=cc.callFunc(function(){e.guidePoint.position=t,e.guidePoint.runAction(cc.sequence(cc.moveTo(.4,n),cc.delayTime(.5),o))},this);this.guidePoint.runAction(cc.sequence(cc.moveTo(.4,n),cc.delayTime(.5),o)),this._guideStep++}else this._isGuide=!1,m.DataManager.getInstance().setItem("isGuide",this._isGuide),m.DataManager.getInstance().flush(),this.guidePoint.stopAllActions(),this.guideObj.active=!1,this._guideDrop=[],this._isGuiding=!1},t.prototype.init=function(){for(var e=0;e<this.squareNum;e++){var t=cc.instantiate(this.square);t.setParent(this.squareLayer);var n=new cc.Component.EventHandler;n.target=t,n.component="SquareItem",n.handler="onClick",n.customEventData="",t.addComponent(cc.Button).clickEvents.push(n),t.active=!0,t.x=this.padding+e%this.line*(t.width+this.spacing)+t.width/2,t.y=-this.yPadding-Math.floor(e/this.line)*(t.height+this.spacing)-t.height/2,this.squareItems.push(t.getComponent(a.default))}},t.prototype.randomHeaps=function(){this.heapUsedCount=0;for(var e=this.simpleData,t=0;t<3;t++){var n=e[this.randomIndex()],o=Math.floor(Math.random()*n.list.length);this.selectHeaps[t].init(n,o,this)}},t.prototype.randomIndex=function(){var e=0,t=0;this.score<300?(e=.45,t=.85):this.score>=300&&this.score<600?(e=.3,t=.7):(e=.15,t=.55);var n=Math.random();return n<e?this._simpleHeaps[Math.floor(Math.random()*this._simpleHeaps.length)]:n>=e&&n<t?this._nomalHeaps[Math.floor(Math.random()*this._nomalHeaps.length)]:this._difHeaps[Math.floor(Math.random()*this._difHeaps.length)]},t.prototype._initHeapsRefreshEffects=function(){for(var e=function(e){e.node.active=!1,e.setCompleteListener(function(t,n){e.node.active=!1})},t=0,n=this.heapsRefreshEffect;t<n.length;t++){e(n[t])}},t.prototype.randomUsedHeaps=function(){this.heapUsedCount=0;for(var e=this.simpleData,t=0;t<3;t++)if(this.selectHeaps[t].isUsed){var n=e[Math.floor(Math.random()*e.length)],o=Math.floor(Math.random()*n.list.length);this.selectHeaps[t].init(n,o,this)}},t.prototype.checkCollision=function(e){this.boardTiles=[],this.fillTiles=[];for(var t=0;t<e.itemsPos.length;t++){var n=e.node.position.add(e.itemsPos[t]),o=this.checkDistance(n);o&&(this.fillTiles.push(e.squaritems[t]),this.boardTiles.push(o))}this.dropPrompt(this.checkCanDrop(e))},t.prototype.checkDistance=function(e){for(var t=0;t<this.squareItems.length;t++)if(!(this._isGuiding&&this._guideDrop.indexOf(t)<0)){var n=this.squareItems[t];if(n.node.position.sub(e).mag()<=this.dropDistance)return n}return null},t.prototype.checkCanDrop=function(e){var t=this.boardTiles.length,n=e.itemsPos.length;if(0===t||t!=n)return!1;for(var o=0;o<t;o++)if(this.boardTiles[o].isFulled)return!1;return!0},t.prototype.dropPrompt=function(e){var t=this.boardTiles,n=t.length;this.fillTiles;if(this.resetBoardFrames(),e)for(var o=0;o<n;o++)t[o].hoverBg.spriteFrame=this.hoverSprite,t[o].hoverBg.node.active=!0},t.prototype.resetBoardFrames=function(){for(var e=0;e<this.squareItems.length;e++)this.squareItems[e].hoverBg.node.active=!1},t.prototype.tileDrop=function(e){if(this.resetBoardFrames(),this.checkCanDrop(e)){var t=this.boardTiles;this.dropTiles=this.boardTiles;for(var n=0;n<this.selectHeaps.length;n++)this.lastDatas[n].type=this.selectHeaps[n].type,this.lastDatas[n].index=this.selectHeaps[n].index,this.lastDatas[n].isUsed=this.selectHeaps[n].isUsed;var i=this.fillTiles,a=i.length;for(n=0;n<a;n++)t[n].isFulled=!0,t[n].bg.spriteFrame=i[n].bg.spriteFrame,t[n].dropEffect();var r=Math.random();if(r<this.toolRate){var s=void 0;s=(r=Math.random())<.333333?o.Thunder:r<.666666?o.DropOne:o.RefreshHeaps,r=Math.random()*t.length,t[Math.floor(r)].setTool(s)}this.heapUsedCount++,e.setUsed(),this.addScore(e.itemsPos.length,!0),this.deleteTile(),this._isGuiding&&this.SetGuideStep()}else e.resetPos();this.checkHeap(),this.checkLose()},t.prototype.checkHeap=function(){this.heapUsedCount<this.selectHeaps.length||this.randomHeaps()},t.prototype.deleteTile=function(){var e=this,t=[];this.isDeleting=!0;for(var n=[],i=0;i<this.boardTiles.length;i++){var a=this.squareItems.indexOf(this.boardTiles[i]),r=Math.floor(a/this.column),s=Math.floor(a%this.column)+this.column;n.indexOf(r)<0&&n.push(r),n.indexOf(s)<0&&n.push(s)}for(i=0;i<n.length;i++){for(var c=!0,l=0;l<this.DelRules[i].length;l++){if(!this.squareItems[this.DelRules[n[i]][l]].isFulled){c=!1;break}}c&&t.push(this.DelRules[n[i]])}t.length>0?this.playScoreAudio():this.playDropAudio();var u=!1;for(i=0;i<t.length;i++){var h=t[i],d=function(t){var n=h[t],i=f.squareItems[n],a=i.node;i.isFulled=!1,i.deleteTile();var r=i.toolType;if(r!=o.None){var s=null,c=cc.callFunc(function(){e.playings[r]=!1},f),l=cc.callFunc(function(){s.active=!1,e._hideTools.push(s),e.playings[r]||(e.playings[r]=!0),e.getToolEffects[r].node.active=!0,e.getToolEffects[r].setAnimation(0,"xiangqian_effect",!1),p.default.instance.play(p.SoundType.Effect,p.SoundName.GetTools),e.effectNodes[r].runAction(cc.sequence(cc.scaleTo(.1,1.3),cc.scaleTo(.1,.8),cc.scaleTo(.1,1),c))},f);if(f._hideTools.length>0)s=f._hideTools.pop();else{(s=new cc.Node).setParent(f.showToolsParent);var d=cc.instantiate(f.TrailingEffect);d.setParent(s),d.position=cc.Vec2.ZERO,(new cc.Node).addComponent(cc.Sprite).node.setParent(s)}s.stopAllActions(),s.opacity=255,s.children[1].getComponent(cc.Sprite).spriteFrame=f.buttonAtlas.getSpriteFrame("tool_"+r),s.width=74,s.height=74,s.position=a.position,s.scale=1,s.children[0].getComponent(cc.ParticleSystem).resetSystem(),s.active=!0,s.runAction(cc.sequence(cc.scaleTo(.5,1.3),cc.spawn(cc.moveTo(.3,f.effectNodes[r].position),cc.scaleTo(.3,1)),l)),f.effects[r].num++,u=!0}},f=this;for(l=0;l<h.length;l++)d(l)}u&&this.setEffectState(),0!==t.length&&(this.dropTiles=[],this.addScore(t.length,!1)),this.isDeleting=!1},t.prototype.addScore=function(e,t){t||(2==e?(this.scoreEffect.node.active=!0,this.scoreEffect.setAnimation(0,"good",!1)):3==e?(this.scoreEffect.node.active=!0,this.scoreEffect.setAnimation(0,"great",!1)):e>3&&(this.scoreEffect.node.active=!0,this.scoreEffect.setAnimation(0,"perfect",!1)));var n=t?e:10*e*e;this.score+=n,this.scoreLab.string=this.score.toString()},t.prototype.checkLose=function(){for(var e=0,t=this.selectHeaps,n=0;n<this.squareItems.length;n++){var o=this.squareItems[n],i=cc.v2(o.node.x,o.node.y);if(!o.isFulled)for(var a=0;a<3;a++){this.dropDistance;var r=0;if(!t[a].isUsed){for(var s=0;s<t[a].itemsPos.length;s++){var c=i.add(t[a].itemsPos[s]);c.subSelf(t[a].deviation);var l=this.checkDistance(c);l&&!l.isFulled&&r++}if(cc.Mask,r===t[a].itemsPos.length)return e++,!1}}}this._tipString=this.isCanUseEffects(),0===e&&(this._tipString,this.onEndGame())},t.prototype.resetSquares=function(){for(var e=0;e<this.squareItems.length;e++)this.squareItems[e].init()},t.prototype.reGame=function(){this.reset()},t.prototype.backToStepPanel=function(){this.changePanel(!1),this.overPanel.active=!1},t.prototype.changePanel=function(e){var t=this;d.default.instance.show(function(){t.stepPanel.active=!e,e||t.stepPanel.getComponent(f.default).Show(),t.gameNode.active=e})},t.prototype.pauseGame=function(){this.isGame&&(this.isGame=!1,this.gameNode.active=!0,this.pausePanel.show())},t.prototype.continueGame=function(){this.isGame=!0,this.gameNode.active=!0},t.prototype.checkDisSquareItems=function(e,t){void 0===t&&(t=30);for(var n=[],o=0;o<this.squareItems.length;o++){var i=this.squareItems[o];i.node.position.sub(e).mag()<=t&&n.push(i)}return n},t.prototype.isCanUse=function(e){return!!this.isGame&&((e!=o.Revocation.valueOf()||0!==this.dropTiles.length)&&(!this.effects[e].isLock&&this.effects[e].num))},t.prototype.getEffectItemNum=function(e){return this.effects[e].num},t.prototype.OnDropOne=function(){var e=this;if(this.effects[o.DropOne].isLock)this.effeckUnlockCtrl.init(o.DropOne);else if(this.isCanUse(o.DropOne)){this.effectTipLab.string=h.default.instance.getString("dropTip"),this.effectTipLab.node.stopAllActions();var t=cc.callFunc(function(){e.effectTipLab.node.runAction(cc.sequence(cc.fadeIn(1),cc.delayTime(.5),cc.fadeOut(1),cc.delayTime(.2),t))},this);this.effectTipLab.node.runAction(cc.sequence(cc.fadeIn(1),cc.delayTime(.5),cc.fadeOut(1),cc.delayTime(.2),t)),this._isDropOne=!0,this.thunderTip.active=!0}},t.prototype.OnThunder=function(){var e=this;if(this.effects[o.Thunder].isLock)this.effeckUnlockCtrl.init(o.Thunder);else if(this.isCanUse(o.Thunder)){this.effectTipLab.string=h.default.instance.getString("effect1"),this.effectTipLab.node.stopAllActions();var t=cc.callFunc(function(){e.effectTipLab.node.runAction(cc.sequence(cc.fadeIn(1),cc.delayTime(.5),cc.fadeOut(1),cc.delayTime(.2),t))},this);this.effectTipLab.node.runAction(cc.sequence(cc.fadeIn(1),cc.delayTime(.5),cc.fadeOut(1),cc.delayTime(.2),t)),this._isUseThunder=!0,this.thunderTip.active=!0}},t.prototype.OnSquareItem=function(e){this._isUseThunder?(this._isUseThunder=!1,this.thunderTip.active=!1,e.isFulled&&(this.effects[o.Thunder].num--,this.setEffectState(),e.thunderEffect(),e.isFulled=!1,this.checkLose())):this._isDropOne&&(this._isDropOne=!1,this.thunderTip.active=!1,e.isFulled||(this.effects[o.DropOne].num--,this.setEffectState(),e.isFulled=!0,e.bg.spriteFrame=this.buttonAtlas.getSpriteFrame("color_3"),e.dropEffect(),this.boardTiles=[],this.boardTiles.push(e),this.deleteTile(),this.checkLose()))},t.prototype.OnCanecelThundel=function(){this._isUseThunder?(this._isUseThunder=!1,this.thunderTip.active=!1):this._isDropOne&&(this._isDropOne=!1,this.thunderTip.active=!1)},t.prototype.deleteSquares=function(e){this.isDeleting=!0;for(var t=0;t<e.length;t++){e[t].node;e[t].isFulled=!1,e[t].deleteTile()}this.isDeleting=!1},t.prototype.refreshHeaps=function(){if(this.effects[o.RefreshHeaps].isLock)return this.effeckUnlockCtrl.init(o.RefreshHeaps),void p.default.instance.play(p.SoundType.Effect,p.SoundName.ClickBtn);if(this.isCanUse(o.RefreshHeaps.valueOf())){p.default.instance.play(p.SoundType.Effect,p.SoundName.Refresh),this.effects[o.RefreshHeaps.valueOf()].num--;for(var e=0,t=this.heapsRefreshEffect;e<t.length;e++){var n=t[e];n.node.active=!0,n.setAnimation(0,"shuaxin_effect",!1)}this.randomHeaps(),this.setEffectState(),this.checkLose()}else p.default.instance.play(p.SoundType.Effect,p.SoundName.ClickBtn)},t.prototype.isCanUseEffects=function(){for(var e="",t=0;t<3;t++)this.effects[t].num>0?e+="1":e+="0";return e},t.prototype.revocation=function(){if(this.isCanUse(o.Revocation.valueOf())&&this.dropTiles.length>0){this.effects[o.Revocation.valueOf()].num--;for(var e=0;e<this.dropTiles.length;e++)this.dropTiles[e].init();this.heapUsedCount=0;for(e=0;e<this.lastDatas.length;e++)this.lastDatas[e].isUsed?(this.heapUsedCount++,this.selectHeaps[e].setUsed()):this.selectHeaps[e].init(this.getHeapData(this.lastDatas[e].type),this.lastDatas[e].index,this);this.setEffectState(),this.dropTiles=[]}},t.prototype.getHeapData=function(e){for(var t=this.simpleData,n=0;n<t.length;n++)if(t[n].type===e)return t[n]},t.prototype.setUnlock=function(e){this.effects[o.Thunder].isLock=!1,this.effects[o.DropOne].isLock=!1,this.effects[o.RefreshHeaps].isLock=!1,this.effectsUnlockNode.active=!1;for(var t=0,n=this.toolMask;t<n.length;t++){n[t].active=!1}this.setEffectState()},t.prototype.resetEffects=function(){for(var e=0,t=this.toolMask;e<t.length;e++){t[e].active=!0}this.effectsUnlockNode.active=!0;for(var n=0;n<3;n++)this.effects[n].num=0,this.effects[n].isLock=!0,this.effectLab[n].string="0"},t.prototype.setEffectState=function(){for(var e=0;e<3;e++)this.effectLab[e].string=this.effects[e].num.toString()},t.prototype.onEndGame=function(){this.isGame=!1,this.highScore<this.score&&(this.highScore=this.score,m.DataManager.getInstance().setItem("highScore",this.highScore),m.DataManager.getInstance().flush(),this.topScoreLab.string=this.highScore.toString(),this.stepPanel.getComponent(f.default).setScore(this.highScore)),this.overPanel.getComponent(s.default).show(this.score,this.highScore,this.effects[o.Thunder].num,this.effects[o.RefreshHeaps].num,this.effects[o.DropOne].num)},t.prototype.reborn=function(){this.isGame=!0,this._isUseThunder=!1,this.gameNode.active=!0,this.overPanel.active=!1,this.resetSquares(),this.randomHeaps()},t.prototype.playDropAudio=function(){p.default.instance.play(p.SoundType.Effect,p.SoundName.Drop)},t.prototype.playScoreAudio=function(){p.default.instance.play(p.SoundType.Effect,p.SoundName.Score)},t.prototype.playFireAudio=function(){p.default.instance.play(p.SoundType.Effect,p.SoundName.Fire)},t.prototype.SetText=function(){this.topScoreText.string=h.default.instance.getString("topScore"),this.confirmCtrl.setText(),this.pausePanel.setText(),this.effeckUnlockCtrl.setText(),this.stepPanel.getComponent(f.default).setText(),this.overPanel.getComponent(s.default).setText()},t.prototype.setLanuage=function(){this.isChinese?(this.languageLab.string="EN",this.isChinese=!1):(this.languageLab.string="ZH",this.isChinese=!0),m.DataManager.getInstance().setItem("isChinese",this.isChinese),m.DataManager.getInstance().flush(),this.SetText()},t.prototype.setSelectColor=function(e){this.hoverSprite=this.buttonAtlas.getSpriteFrame("dz_"+e)},t.prototype.switchSound=function(){p.default.instance.switchSound()},t.prototype.setMask=function(e){this.maskPanelNum+=e?1:-1,this.mask.active=this.maskPanelNum>0},t.instance=null,__decorate([D],t.prototype,"is4399Platform",void 0),__decorate([D(cc.Node)],t.prototype,"Logo",void 0),__decorate([D(cc.Prefab)],t.prototype,"TrailingEffect",void 0),__decorate([D([cc.Node])],t.prototype,"toolMask",void 0),__decorate([D(cc.Node)],t.prototype,"stepPanel",void 0),__decorate([D([i.default])],t.prototype,"selectHeaps",void 0),__decorate([D(sp.Skeleton)],t.prototype,"heapsRefreshEffect",void 0),__decorate([D(cc.Node)],t.prototype,"squareLayer",void 0),__decorate([D(l.default)],t.prototype,"pausePanel",void 0),__decorate([D(u.default)],t.prototype,"confirmCtrl",void 0),__decorate([D([cc.Node])],t.prototype,"effectNodes",void 0),__decorate([D([sp.Skeleton])],t.prototype,"getToolEffects",void 0),__decorate([D(cc.SpriteAtlas)],t.prototype,"buttonAtlas",void 0),__decorate([D(cc.Node)],t.prototype,"showToolsParent",void 0),__decorate([D(cc.Prefab)],t.prototype,"deleteEffectPrefab",void 0),__decorate([D(cc.Node)],t.prototype,"effectParent",void 0),__decorate([D(cc.Sprite)],t.prototype,"soundIcon",void 0),__decorate([D(cc.Integer)],t.prototype,"padding",void 0),__decorate([D(cc.Integer)],t.prototype,"yPadding",void 0),__decorate([D(cc.Integer)],t.prototype,"spacing",void 0),__decorate([D(cc.Integer)],t.prototype,"line",void 0),__decorate([D(cc.Integer)],t.prototype,"column",void 0),__decorate([D(cc.Node)],t.prototype,"square",void 0),__decorate([D(cc.Node)],t.prototype,"gameNode",void 0),__decorate([D(cc.Label)],t.prototype,"languageLab",void 0),__decorate([D(cc.Label)],t.prototype,"startLab",void 0),__decorate([D(cc.Label)],t.prototype,"topScoreText",void 0),__decorate([D(cc.Label)],t.prototype,"scoreLab",void 0),__decorate([D(cc.Label)],t.prototype,"topScoreLab",void 0),__decorate([D(cc.Label)],t.prototype,"effectTipLab",void 0),__decorate([D(cc.Node)],t.prototype,"overPanel",void 0),__decorate([D([cc.Label])],t.prototype,"effectLab",void 0),__decorate([D(cc.Node)],t.prototype,"effectsUnlockNode",void 0),__decorate([D(cc.Integer)],t.prototype,"fireDeleteNum",void 0),__decorate([D(c.default)],t.prototype,"effeckUnlockCtrl",void 0),__decorate([D(cc.Integer)],t.prototype,"getEffectBorns",void 0),__decorate([D(cc.Integer)],t.prototype,"dropDistance",void 0),__decorate([D],t.prototype,"toolRate",void 0),__decorate([D(cc.Node)],t.prototype,"thunderTip",void 0),__decorate([D(cc.Node)],t.prototype,"languageBtn",void 0),__decorate([D(cc.Boolean)],t.prototype,"isUseSysLanguage",void 0),__decorate([D(cc.Node)],t.prototype,"mask",void 0),__decorate([D(cc.Widget)],t.prototype,"widgets",void 0),__decorate([D(cc.Mask)],t.prototype,"guideMask",void 0),__decorate([D(cc.Node)],t.prototype,"guidePoint",void 0),__decorate([D(cc.Node)],t.prototype,"guideObj",void 0),__decorate([D(sp.Skeleton)],t.prototype,"scoreEffect",void 0),__decorate([D([cc.Vec2])],t.prototype,"guideStepPoint",void 0),t=n=__decorate([v],t)}(cc.Component);n.default=S,cc._RF.pop()},{"./AudioManager":"AudioManager","./ChangeAnimCtrl":"ChangeAnimCtrl","./ConfirmCtrl":"ConfirmCtrl","./HeapCtrl":"HeapCtrl","./HeapData":"HeapData","./LanguageKey":"LanguageKey","./Manager/AdsManager":"AdsManager","./Manager/DataManager":"DataManager","./NewEffectUnlockCtrl":"NewEffectUnlockCtrl","./OverPanelCtrl":"OverPanelCtrl","./PauseCtrl":"PauseCtrl","./Platform/BenzPlatformManager":"BenzPlatformManager","./SquareItem":"SquareItem","./StepCtrl":"StepCtrl"}],HeapCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"577b38ukoxIh6EdsB9iSdMG","HeapCtrl"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./SquareItem"),i=e("./GameCtrl"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.squaritems=new Array,t.deviation=cc.Vec2.ZERO,t.sca=.45,t.itemsPos=new Array,t.temp=new Array,t.isUsed=!1,t.type=0,t.index=0,t.color=0,t._up=0,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(t){if(!(e.isUsed||!e.gameC.isGame||e.gameC._isUseThunder||e.gameC._isDropOne||e.gameC.isTouch)){e.gameC.touchCtrl=e,e.gameC.isTouch=!0,e.gameC.setSelectColor(e.color),e.squareParent.runAction(cc.scaleTo(.05,1));var n=e.originPoint.add(e.node.convertTouchToNodeSpace(t.touch).sub(cc.v2(91,-(30+78*e._up))));e.node.runAction(cc.moveTo(.05,n))}}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){if(!e.isUsed&&e.gameC.isGame&&!e.gameC._isUseThunder&&!e.gameC._isDropOne&&e.gameC.touchCtrl==e){var n=t.getDeltaX(),o=t.getDeltaY();e.node.x+=n,e.node.y+=o,i.default.instance.checkCollision(e)}}),this.node.on(cc.Node.EventType.TOUCH_END,function(t){e.isUsed||!e.gameC.isGame||e.gameC._isUseThunder||e.gameC._isDropOne||(e.gameC.touchCtrl==e&&(e.gameC.isTouch=!1),i.default.instance.tileDrop(e))}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(t){e.isUsed||!e.gameC.isGame||e.gameC._isUseThunder||e.gameC._isDropOne||(e.gameC.touchCtrl==e&&(e.gameC.isTouch=!1),i.default.instance.tileDrop(e))})},t.prototype.init=function(e,t,n){this.gameC=n,this.type=e.type,this.index=t;var i=e.list[t];this.isUsed=!1;for(var a=0,r=0,s=0,c=0;this.itemsPos.length>i.length;)this.temp.push(this.itemsPos.pop());this.hideChilden(),this.color=e.color;for(var l="color_"+this.color,u=0;u<i.length;u++){if(this.squaritems.length<=u){var h=cc.instantiate(n.square);h.setParent(this.squareParent);var p=h.getComponent(o.default);this.squaritems.push(p)}a>i[u][0]&&(a=i[u][0]),r<i[u][0]&&(r=i[u][0]),s>i[u][1]&&(s=i[u][1]),c<i[u][1]&&(c=i[u][1]),this.squaritems[u].bg.spriteFrame=n.buttonAtlas.getSpriteFrame(l),this.squaritems[u].node.active=!0,this.squaritems[u].node.x=i[u][0]*(this.squaritems[u].node.width+n.spacing),this.squaritems[u].node.y=i[u][1]*(this.squaritems[u].node.height+n.spacing)}this.deviation.x=38*-(a+r),this.deviation.y=38*-(s+c),this._up=c-s>>1;for(u=0;u<i.length;u++)this.squaritems[u].node.x+=this.deviation.x,this.squaritems[u].node.y+=this.deviation.y,this.itemsPos.length<=u&&(this.temp.length>0?this.itemsPos.push(this.temp.pop()):this.itemsPos.push(new cc.Vec2)),this.itemsPos[u]=this.squaritems[u].node.position;this.resetNow()},t.prototype.setUsed=function(){this.isUsed=!0,this.hideChilden(),this.resetNow()},t.prototype.hideChilden=function(){for(var e=0;e<this.squaritems.length;e++)this.squaritems[e].node.active=!1},t.prototype.resetNow=function(){this.node.stopAllActions(),this.squareParent.stopAllActions(),this.node.position=this.originPoint,this.squareParent.scale=this.sca},t.prototype.resetPos=function(){this.node.stopAllActions(),this.squareParent.stopAllActions(),this.squareParent.runAction(cc.scaleTo(.2,this.sca)),this.node.runAction(cc.moveTo(.2,this.originPoint))},__decorate([s(cc.Node)],t.prototype,"squareParent",void 0),__decorate([s(cc.Vec2)],t.prototype,"originPoint",void 0),t=__decorate([r],t)}(cc.Component);n.default=c,cc._RF.pop()},{"./GameCtrl":"GameCtrl","./SquareItem":"SquareItem"}],HeapData:[function(e,t,n){"use strict";cc._RF.push(t,"8a6769Xk+pJqqYWogxLqtpG","HeapData"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=o.ccclass,a=(o.property,function(){function e(){}return e.prototype.init=function(e){this.type=e.type,this.list=e.list,this.color=e.color},e=__decorate([i],e)}());n.default=a,cc._RF.pop()},{}],LanguageKey:[function(e,t,n){"use strict";cc._RF.push(t,"5abb54FTTBIPqFKDCSRPfzp","LanguageKey"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./GameCtrl"),i=cc._decorator,a=i.ccclass,r=(i.property,function(){function e(){this.lan={confirm:{zh:"\u786e\u8ba4",en:"Confirm"},start:{zh:"\u5f00\u59cb\u6e38\u620f",en:"START"},over:{zh:"\u6e38\u620f\u7ed3\u675f",en:"Game Over"},score:{zh:"\u5206\u6570:",en:"Score:"},topScore:{zh:"\u6700\u9ad8\u5206\u6570:",en:"Best Score:"},reGame:{zh:"\u518d\u6765\u4e00\u5c40",en:"Again"},unlockEffect:{zh:"\u9053\u5177\u89e3\u9501",en:"Unlock Tools"},unlock:{zh:"\u89c2\u770b\u89c6\u9891\u89e3\u9501",en:"Watch a video"},finish:{zh:"\u7ed3\u675f",en:"End"},continue:{zh:"\u7ee7\u7eed",en:"Continue"},cancel:{zh:"\u53d6\u6d88",en:"Cancel"},finishTip:{zh:"\u4f60\u786e\u8ba4\u7ed3\u675f\u672c\u5c40\u5417?",en:"Confirm to end the game?"},reGameTip:{zh:"\u662f\u5426\u91cd\u65b0\u5f00\u59cb",en:"Do you want to restart?"},effect1:{zh:"\u9009\u62e9\u683c\u5b50\u5185\u76841\u5757\u7816\u6d88\u9664",en:"Remove 1 Block"},effect2:{zh:"\u70b9\u51fb\u6dfb\u52a0\u4e00\u4e2a\u7816\u5757",en:"Add 1 Block"},effect3:{zh:"\u968f\u673a\u5237\u65b0\u51fa3\u4e2a\u65b0\u6837\u5f0f\u7684\u7816\u5757",en:"Refresh 3 new blocks at random"},lockTip:{zh:"\u89c2\u770b\u89c6\u9891\u89e3\u9501\u5168\u90e8\u9053\u5177",en:"Unlock all tools for watching a video."},hestoryScore:{zh:"\u5386\u53f2\u6700\u9ad8\u5206",en:"BEST SCORE"},gameScore:{zh:"\u672c\u5c40\u5f97\u5206",en:"Score"},home:{zh:"\u4e3b\u9875",en:"Home"},reStart:{zh:"\u91cd\u65b0\u5f00\u59cb",en:"Restart"},videoErrTip:{zh:"\u89c6\u9891\u89c2\u770b\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",en:"Video watch failed, try again later"},toolsNotEnough:{zh:"\u9053\u5177\u4e0d\u8db3",en:"Insufficient tools"},toolsTip:{zh:"\u7816\u5757\u5df2\u65e0\u5904\u5b89\u653e\uff0c\u4f7f\u7528\u9053\u5177\u7ee7\u7eed\u6e38\u620f",en:"No space for more blocks, continue to play by using tools."},dropTip:{zh:"\u9009\u62e9\u60a8\u8981\u6dfb\u52a0\u7816\u5757\u7684\u4f4d\u7f6e",en:"Add 1 Block"},rebornTip:{zh:"(\u5269\u4f59\u590d\u6d3b\u6b21\u6570:1)",en:"(Remain Count : 1)"},sureToShowAd:{zh:"\u89c2\u770b\u5e7f\u544a\u53ef\u4f7f\u7528\u5f53\u524d\u70b9\u51fb\u9053\u5177. \u662f\u5426\u89c2\u770b\u5e7f\u544a?",en:"Watch a video for using this item. Sure to watch?"}}}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),e.prototype.getString=function(e){var t=this.lan[e];return null===t||void 0===t?"":o.default.instance.isChinese?t.zh:t.en},e._instance=null,e=t=__decorate([a],e)}());n.default=r,cc._RF.pop()},{"./GameCtrl":"GameCtrl"}],NewEffectUnlockCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"60857204GhNNol/0ar2lhAW","NewEffectUnlockCtrl"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./GameCtrl"),i=e("./LanguageKey"),a=e("./Manager/AdsManager"),r=e("./Platform/BenzCommand"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.unlockLab=null,t.descLab1=null,t.descLab2=null,t.descLab3=null,t.select=null,t.animation=null,t.effectType=o.EffectType.None,t._isHide=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.animation.on("finished",function(e){this._isHide&&(this.node.active=!1)},this)},t.prototype.init=function(e){this._show(e)},t.prototype.onEnable=function(){o.default.instance.setMask(!0)},t.prototype.onDisable=function(){o.default.instance.setMask(!1)},t.prototype._show=function(e){this._isHide=!1,this.node.active=!0,this.effectType=e,this.setText(),this.animation.play(o.AnimName.Show)},t.prototype.onButton=function(){var e=this;a.AdsManager.getInstance().showRewardAd(r.BenzCommand.CMD_SHOW_REWARD_VIDEO_AD,{success:function(){o.default.instance.setUnlock(e.effectType),e._hide()},fail:function(){}})},t.prototype.back=function(){this._hide()},t.prototype._hide=function(){this._isHide=!0,this.animation.play(o.AnimName.Hide)},t.prototype.setText=function(){this.descLab1.string=i.default.instance.getString("effect1"),this.descLab2.string=i.default.instance.getString("effect2"),this.descLab3.string=i.default.instance.getString("effect3"),this.unlockLab.string=i.default.instance.getString("unlock")},__decorate([l(cc.Label)],t.prototype,"unlockLab",void 0),__decorate([l(cc.Label)],t.prototype,"descLab1",void 0),__decorate([l(cc.Label)],t.prototype,"descLab2",void 0),__decorate([l(cc.Label)],t.prototype,"descLab3",void 0),__decorate([l(cc.Node)],t.prototype,"select",void 0),__decorate([l(cc.Animation)],t.prototype,"animation",void 0),__decorate([l({type:o.EffectType})],t.prototype,"effectType",void 0),t=__decorate([c],t)}(cc.Component);n.default=u,cc._RF.pop()},{"./GameCtrl":"GameCtrl","./LanguageKey":"LanguageKey","./Manager/AdsManager":"AdsManager","./Platform/BenzCommand":"BenzCommand"}],OverPanelCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"6d71bTXf1REJ4u6phA+Niu0","OverPanelCtrl"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./GameCtrl"),i=e("./LanguageKey"),a=e("./TipCtrl"),r=e("./AudioManager"),s=e("./Manager/AdsManager"),c=e("./Platform/BenzCommand"),l=e("./Platform/BenzPlatformManager"),u=cc._decorator,h=u.ccclass,p=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameScoreText=null,t.reGameLab=null,t.homeLab=null,t.topScoreText=null,t.scoreLab=null,t.highScore=null,t.animation=null,t.toolsTip=null,t.thunderLab=null,t.refreshLab=null,t.fireLab=null,t.tools=null,t.btns=null,t.rebornTip=null,t._isHide=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.animation.on("finished",function(e){this._isHide&&(this.node.active=!1)},this)},t.prototype.onEnable=function(){o.default.instance.setMask(!0)},t.prototype.onDisable=function(){o.default.instance.setMask(!1)},t.prototype.show=function(e,t,n,a,s){r.default.instance.play(r.SoundType.Effect,r.SoundName.Finish),this.node.active=!0,this._isHide=!1,this.scoreLab.string=i.default.instance.getString("score")+e.toString(),this.highScore.string=i.default.instance.getString("topScore")+t.toString(),this.animation.play(o.AnimName.Show),this.thunderLab.string=n.toString(),this.fireLab.string=s.toString(),this.refreshLab.string=a.toString(),o.default.instance.rebornCount>0?(this.btns.y=0,this.tools.active=!0,this.rebornTip.string=i.default.instance.getString("rebornTip"),o.default.instance.is4399Platform&&!l.BenzPlatformManager.canShowAd()&&(this.btns.y=300,this.tools.active=!1,this.rebornTip.string="")):(this.btns.y=300,this.tools.active=!1,this.rebornTip.string="")},t.prototype.setText=function(){this.toolsTip.string=i.default.instance.getString("toolsTip"),this.reGameLab.string=i.default.instance.getString("reGame"),this.homeLab.string=i.default.instance.getString("home"),this.gameScoreText.string=i.default.instance.getString("gameScore"),this.topScoreText.string=i.default.instance.getString("hestoryScore")},t.prototype.hide=function(){this._isHide=!0,this.animation.play(o.AnimName.Hide)},t.prototype.reGame=function(){this.hide(),o.default.instance.reGame()},t.prototype.onThunder=function(){var e=this;o.default.instance.effects[o.EffectType.Thunder].num>0?o.default.instance.confirmCtrl.showConfirm(function(){s.AdsManager.getInstance().showRewardAd(c.BenzCommand.CMD_SHOW_REWARD_VIDEO_AD,{success:function(){o.default.instance.rebornCount--,o.default.instance.setUnlock(0),o.default.instance.continueGame(),e.hide(),o.default.instance.OnThunder()},fail:function(){}})},null,i.default.instance.getString("sureToShowAd")):a.default.instance.showTip(i.default.instance.getString("toolsNotEnough"))},t.prototype.OnRefresh=function(){var e=this;o.default.instance.effects[o.EffectType.RefreshHeaps].num>0?o.default.instance.confirmCtrl.showConfirm(function(){s.AdsManager.getInstance().showRewardAd(c.BenzCommand.CMD_SHOW_REWARD_VIDEO_AD,{success:function(){o.default.instance.rebornCount--,o.default.instance.setUnlock(0),o.default.instance.continueGame(),e.hide(),o.default.instance.refreshHeaps()},fail:function(){}})},null,i.default.instance.getString("sureToShowAd")):a.default.instance.showTip(i.default.instance.getString("toolsNotEnough"))},t.prototype.onDropOne=function(){var e=this;o.default.instance.effects[o.EffectType.DropOne].num>0?o.default.instance.confirmCtrl.showConfirm(function(){s.AdsManager.getInstance().showRewardAd(c.BenzCommand.CMD_SHOW_REWARD_VIDEO_AD,{success:function(){o.default.instance.rebornCount--,o.default.instance.setUnlock(0),o.default.instance.continueGame(),e.hide(),o.default.instance.OnDropOne()},fail:function(){}})},null,i.default.instance.getString("sureToShowAd")):a.default.instance.showTip(i.default.instance.getString("toolsNotEnough"))},__decorate([p(cc.Label)],t.prototype,"gameScoreText",void 0),__decorate([p(cc.Label)],t.prototype,"reGameLab",void 0),__decorate([p(cc.Label)],t.prototype,"homeLab",void 0),__decorate([p(cc.Label)],t.prototype,"topScoreText",void 0),__decorate([p(cc.Label)],t.prototype,"scoreLab",void 0),__decorate([p(cc.Label)],t.prototype,"highScore",void 0),__decorate([p(cc.Animation)],t.prototype,"animation",void 0),__decorate([p(cc.Label)],t.prototype,"toolsTip",void 0),__decorate([p(cc.Label)],t.prototype,"thunderLab",void 0),__decorate([p(cc.Label)],t.prototype,"refreshLab",void 0),__decorate([p(cc.Label)],t.prototype,"fireLab",void 0),__decorate([p(cc.Node)],t.prototype,"tools",void 0),__decorate([p(cc.Node)],t.prototype,"btns",void 0),__decorate([p(cc.Label)],t.prototype,"rebornTip",void 0),t=__decorate([h],t)}(cc.Component);n.default=d,cc._RF.pop()},{"./AudioManager":"AudioManager","./GameCtrl":"GameCtrl","./LanguageKey":"LanguageKey","./Manager/AdsManager":"AdsManager","./Platform/BenzCommand":"BenzCommand","./Platform/BenzPlatformManager":"BenzPlatformManager","./TipCtrl":"TipCtrl"}],PauseCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"7666azWzLxKgajhb9DQGxVO","PauseCtrl"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./GameCtrl"),i=e("./LanguageKey"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.finishLab=null,t.reGameLab=null,t.continueLab=null,t.gameC=null,t.animation=null,t._isHide=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.animation.on("finished",function(e){this._isHide&&(this.node.active=!1)},this)},t.prototype.init=function(e){this.gameC=e},t.prototype.onEndGame=function(){this._hide(),this.gameC.confirmCtrl.show(this.endGame,this.continueG,i.default.instance.getString("finishTip"))},t.prototype.onReGame=function(){this._hide(),this.gameC.confirmCtrl.show(this.reGame,this.continueG,i.default.instance.getString("reGameTip"))},t.prototype.onContinue=function(){this._hide(),this.gameC.continueGame()},t.prototype.onEnable=function(){o.default.instance.setMask(!0)},t.prototype.onDisable=function(){o.default.instance.setMask(!1)},t.prototype._hide=function(){this._isHide=!0,this.animation.play(o.AnimName.Hide)},t.prototype.setText=function(){this.finishLab.string=i.default.instance.getString("finish"),this.reGameLab.string=i.default.instance.getString("reStart"),this.continueLab.string=i.default.instance.getString("continue")},t.prototype.show=function(){this.node.active=!0,this._isHide=!1,this.animation.play(o.AnimName.Show)},__decorate([s(cc.Label)],t.prototype,"finishLab",void 0),__decorate([s(cc.Label)],t.prototype,"reGameLab",void 0),__decorate([s(cc.Label)],t.prototype,"continueLab",void 0),__decorate([s(cc.Animation)],t.prototype,"animation",void 0),__decorate([s(cc.Component.EventHandler)],t.prototype,"endGame",void 0),__decorate([s(cc.Component.EventHandler)],t.prototype,"continueG",void 0),__decorate([s(cc.Component.EventHandler)],t.prototype,"reGame",void 0),t=__decorate([r],t)}(cc.Component);n.default=c,cc._RF.pop()},{"./GameCtrl":"GameCtrl","./LanguageKey":"LanguageKey"}],Queue:[function(e,t,n){"use strict";cc._RF.push(t,"8c713xGUqJAnb5smQLeNiXo","Queue"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e){this._queue=e||[]}return e.prototype.enqueue=function(e){this._queue.push(e)},e.prototype.dequeue=function(){return this._queue.shift()},e.prototype.clear=function(){this._queue=[]},Object.defineProperty(e.prototype,"count",{get:function(){return this._queue.length},enumerable:!0,configurable:!0}),e}();n.Queue=o,cc._RF.pop()},{}],SquareItem:[function(e,t,n){"use strict";cc._RF.push(t,"5cc8e6DJw9F9YHAeT1GqeP/","SquareItem"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./GameCtrl"),i=e("./AudioManager"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=null,t.hoverBg=null,t.toolSprite=null,t.isFulled=!1,t._toolType=o.EffectType.None,t._deleteEffect=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"toolType",{get:function(){return this._toolType},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.isFulled=!1,this.node.scale=1,this._toolType=o.EffectType.None,this.bg.spriteFrame=o.default.instance.buttonAtlas.getSpriteFrame("zuankai_bg"),this.hoverBg.node.active=!1,this.toolSprite.node.active=!1},t.prototype.setBg=function(e){this.bg.spriteFrame=o.default.instance.buttonAtlas.getSpriteFrame(e)},t.prototype.onClick=function(e){o.default.instance.OnSquareItem(this)},t.prototype.setTool=function(e){if(this._toolType=e,e==o.EffectType.None)this.toolSprite.node.active=!1;else{var t=o.default.instance.buttonAtlas;switch(this.toolSprite.node.active=!0,e){case o.EffectType.Thunder:this.toolSprite.spriteFrame=t.getSpriteFrame("btn_chuizi_02");break;case o.EffectType.DropOne:this.toolSprite.spriteFrame=t.getSpriteFrame("btn_zhadan_02");break;case o.EffectType.RefreshHeaps:this.toolSprite.spriteFrame=t.getSpriteFrame("btn_shuaxin_02")}this.toolSprite.node.scale=.001,this.toolSprite.node.opacity=0,this.toolSprite.node.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.scaleTo(.1,1.5),cc.scaleTo(.1,1))))}},t.prototype.deleteTile=function(){this._initEffect(),this._deleteEffect.node.active=!0,this._deleteEffect.setAnimation(0,"xiaochu_one_effect",!1),this.node.runAction(cc.scaleTo(.3,1.4)),this.scheduleOnce(function(){this.init()},.3)},t.prototype.dropEffect=function(){this._initEffect(),this._deleteEffect.node.active=!0,this._deleteEffect.setAnimation(0,"liuguang_effect",!1)},t.prototype.thunderEffect=function(){this._initEffect(),this._deleteEffect.node.active=!0,this._deleteEffect.setAnimation(0,"chuizi_effect",!1);var e=cc.callFunc(function(){i.default.instance.play(i.SoundType.Effect,i.SoundName.Thounder)},this);this.node.runAction(cc.sequence(cc.scaleTo(.3,1.4),e)),this.scheduleOnce(function(){this.init()},.4)},t.prototype._initEffect=function(){if(null==this._deleteEffect){var e=cc.instantiate(o.default.instance.deleteEffectPrefab);e.setParent(o.default.instance.effectParent),e.position=this.node.position,this._deleteEffect=e.getComponent(sp.Skeleton);var t=this;this._deleteEffect.setCompleteListener(function(e,n){t._deleteEffect.node.active=!1})}},__decorate([s({type:cc.Sprite})],t.prototype,"bg",void 0),__decorate([s({type:cc.Sprite})],t.prototype,"hoverBg",void 0),__decorate([s({type:cc.Sprite})],t.prototype,"toolSprite",void 0),t=__decorate([r],t)}(cc.Component);n.default=c,cc._RF.pop()},{"./AudioManager":"AudioManager","./GameCtrl":"GameCtrl"}],StepCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"381b9z9MZhJsqBxHGw/HFiE","StepCtrl"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./GameCtrl"),i=e("./LanguageKey"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startLab=null,t.scoreText=null,t.scoreLab=null,t.logo=null,t.scoreBg=null,t._isChinese=!1,t}return __extends(t,e),t.prototype.startGame=function(){o.default.instance.reset(),this.logo.node.active=!0,this.logo.setAnimation(0,this._isChinese?"cn_over":"en_over",!1),this.scheduleOnce(function(){o.default.instance.changePanel(!0)},.5)},t.prototype.Show=function(){this.scheduleOnce(function(){this.logo.setAnimation(0,this._isChinese?"cn_start":"en_start",!1)},.2)},t.prototype.setText=function(){this.startLab.string=i.default.instance.getString("start"),this.scoreText.string=i.default.instance.getString("hestoryScore"),this.setLogo(o.default.instance.isChinese)},t.prototype.setLogo=function(e){this._isChinese=e,this.logo.node.active=!0,this.logo.setAnimation(0,e?"cn_start":"en_start",!1),e?(this.scoreBg.y=101,this.scoreLab.node.y=52,this.scoreText.node.y=101.9):(this.scoreBg.y=-23,this.scoreLab.node.y=-72,this.scoreText.node.y=-22)},t.prototype.setScore=function(e){this.scoreLab.string=e.toString()},__decorate([s(cc.Label)],t.prototype,"startLab",void 0),__decorate([s(cc.Label)],t.prototype,"scoreText",void 0),__decorate([s(cc.Label)],t.prototype,"scoreLab",void 0),__decorate([s(sp.Skeleton)],t.prototype,"logo",void 0),__decorate([s(cc.Node)],t.prototype,"scoreBg",void 0),t=__decorate([r],t)}(cc.Component);n.default=c,cc._RF.pop()},{"./GameCtrl":"GameCtrl","./LanguageKey":"LanguageKey"}],TipCtrl:[function(e,t,n){"use strict";cc._RF.push(t,"e3b43ozutpOLZdBiD0sGm7A","TipCtrl"),Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,i=o.ccclass,a=o.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tipLab=null,t}var n;return __extends(t,e),n=t,t.prototype.onLoad=function(){n.instance=this,this.node.active=!1},t.prototype.showTip=function(e){var t=this;this.node.active=!0,this.node.y=-300,this.node.opacity=255,this.tipLab.string=e,this.node.stopAllActions();var n=cc.callFunc(function(){t.scheduleOnce(function(){this.node.runAction(cc.fadeOut(.8)),this.node.active=!1},2.5)},this);this.node.runAction(cc.sequence(cc.spawn(cc.moveTo(.2,cc.Vec2.ZERO),cc.fadeTo(.2,255)),n))},t.instance=null,__decorate([a(cc.Label)],t.prototype,"tipLab",void 0),t=n=__decorate([i],t)}(cc.Component);n.default=r,cc._RF.pop()},{}]},{},["AudioManager","BenzLog","GameCommonData","ButtonEffect","ChangeAnimCtrl","Dictionary","Queue","ConfirmCtrl","GameCtrl","HeapCtrl","HeapData","LanguageKey","AdsManager","DataManager","NewEffectUnlockCtrl","OverPanelCtrl","PauseCtrl","Benz4399Platform","BenzAdsEntity","BenzCommand","BenzFacebookPlatform","BenzLeaderboardEntity","BenzMobileNativePlatform","BenzPlatform","BenzPlatformManager","BenzPlatformType","BenzSocialManager","BenzWebPlatform","SquareItem","StepCtrl","TipCtrl"]);