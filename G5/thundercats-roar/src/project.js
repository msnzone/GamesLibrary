window.__require=function e(t,i,n){function o(s,r){if(!i[s]){if(!t[s]){var c=s.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!r&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+s+"'")}}var h=i[s]={exports:{}};t[s][0].call(h.exports,function(e){return o(t[s][1][e]||e)},h,h.exports,e,t,i,n)}return i[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<n.length;s++)o(n[s]);return o}({Animator:[function(e,t,i){"use strict";cc._RF.push(t,"41529tqhN9PJaQ9yQFLTo+Q","Animator");var n=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var o,a=cc._decorator,s=a.ccclass;a.property;(function(e){e[e.FINISHED=0]="FINISHED",e[e.CANCELED=1]="CANCELED"})(o=i.AnimatorCompleteReason||(i.AnimatorCompleteReason={}));var r=function(){return function(){}}(),c=function(){function e(e){void 0===e&&(e=null),this.targetAnimation=null,this.targetSpine=null,this.animationEntries=[],this.currentEntryIndex=-1,this.setTargetAnimationNode(e),this.setTargetSpineNode(e)}return e.prototype.setTargetAnimationNode=function(e){this.targetAnimation=e.getComponent(cc.Animation),this.targetAnimation&&this.targetAnimation.on("finished",this.onFinishedCallback)},e.prototype.setTargetSpineNode=function(e){this.targetSpine=e.getComponent(sp.Skeleton)},e.prototype.play=function(e,t,i,n){void 0===n&&(n=null);var o=new r;o.animation=e,o.loop=t,o.delay=i,o.animationState=this.targetAnimation.getAnimationState(o.animation),o.animationState.wrapMode=o.loop?cc.WrapMode.Loop:cc.WrapMode.Normal,this.stop(),this.animationEntries.push(o),this.currentEntryIndex=-1,this.update()},e.prototype.playAfter=function(e,t,i,n){void 0===n&&(n=null);var o=new r;o.animation=e,o.loop=t,o.delay=i,this.targetAnimation.getAnimationState(o.animation).wrapMode=o.loop?cc.WrapMode.Loop:cc.WrapMode.Normal,this.animationEntries.push(o),this.update()},e.prototype.stop=function(){if(this.targetAnimation){this.targetAnimation.stop();for(var e=0,t=this.animationEntries;e<t.length;e++){var i=t[e];i.onComplete&&i.onComplete(i.animation,o.CANCELED)}this.animationEntries.splice(0,this.animationEntries.length),this.currentEntryIndex=-1}},e.prototype.update=function(){if(this.targetAnimation&&this.animationEntries.length>0)if(++this.currentEntryIndex,this.currentEntryIndex>=this.animationEntries.length)this.stop();else{var e=this.animationEntries[this.currentEntryIndex];this.targetAnimation.play(e.animation)}},e.prototype.onFinishedCallback=function(e){if(this.targetAnimation){if(this.currentEntryIndex<0)return;var t=this.animationEntries[this.currentEntryIndex];t.animationState==e.currentTarget&&(t.onComplete&&t.onComplete(t.animation,o.FINISHED),++this.currentEntryIndex),this.update()}},e=n([s],e)}();i.default=c,cc._RF.pop()},{}],AttackArea:[function(e,t,i){"use strict";cc._RF.push(t,"ba186i1qOlLRaTioonDd0HI","AttackArea");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./Game"),s=e("./DoesDamage"),r=e("../core/Utils"),c=e("./Projectile"),l=e("./UpgradesManager"),h=cc._decorator,u=h.ccclass,p=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.followNode=null,t.positionOffset=cc.Vec2.ZERO,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){var n=a.default.instance.getPlayer();t.tag==a.ColliderTag.PLAYER_ATTACK_AREA&&i.tag==a.ColliderTag.ENEMY_BODY&&n.isAerial&&(this.getComponent(s.default).attackDirection==r.Direction.LEFT?n.applyKnockback(cc.v2(1,1).normalizeSelf(),.75):n.applyKnockback(cc.v2(-1,1).normalizeSelf(),.75));var o=i.getComponent(c.default);t.tag==a.ColliderTag.PLAYER_ATTACK_AREA&&i.tag==a.ColliderTag.ENEMY_BODY&&o&&l.default.instance.parryUnlocked&&(o.parry(),a.default.instance.getPlayer().doParryAnimation())},t.prototype.update=function(e){this.followNode&&(this.node.position=this.followNode.position.add(this.positionOffset))},t=o([u],t)}(cc.Component));i.default=p,cc._RF.pop()},{"../core/Utils":"Utils","./DoesDamage":"DoesDamage","./Game":"Game","./Projectile":"Projectile","./UpgradesManager":"UpgradesManager"}],AudioButton:[function(e,t,i){"use strict";cc._RF.push(t,"f4a8a+S6MhCFo/hZE2x29nH","AudioButton");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../Audio/AudioScene"),s=e("../Singleton"),r=cc._decorator,c=r.ccclass,l=r.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.frameOn=null,t.frameOff=null,t}return n(t,e),t.prototype.onLoad=function(){this.instance=s.default.getInstance(),this.button=this.node.getComponent(cc.Sprite)},t.prototype.start=function(){this.checkState()},t.prototype.checkState=function(){var e=this.instance.audioManager.enableAudio;this.button.spriteFrame=e?this.frameOn:this.frameOff},t.prototype.switchState=function(){this.instance.switchAudioState(),this.checkState(),s.default.getInstance().audioManager.playSfx(a.SFXKey.button_generic)},o([l(cc.SpriteFrame)],t.prototype,"frameOn",void 0),o([l(cc.SpriteFrame)],t.prototype,"frameOff",void 0),t=o([c],t)}(cc.Component);i.default=h,cc._RF.pop()},{"../Audio/AudioScene":"AudioScene","../Singleton":"Singleton"}],AudioLevelConfig:[function(e,t,i){"use strict";cc._RF.push(t,"da5725DxZJAr5C688BtBfci","AudioLevelConfig"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){}return e.timePlayAmbience=10,e.levelBossMusic=["boss_01","boss_02","boss_03"],e.levelTabuAmbience=["section_02_E1","section_03_E1","section_03_E2","section_04_E1","section_05_E1","section_05_E2","section_06_E1","section_07_E1","section_07_E2","section_08_E1","section_08_E2","section_09_E1","section_09_E2","section_10_E1","section_11_E1","section_11_E2","section_12_E1","section_12_E2","section_13_E1","section_13_E2","section_14_E1","section_15_E1","section_15_E2","boss_01","boss_02","boss_03"],e.levelMusicConfig={boss_01:{initIndoor:!1,levelMusic:0},boss_02:{initIndoor:!1,levelMusic:1},boss_03:{initIndoor:!1,levelMusic:2},section_01_01:{initIndoor:!1,levelMusic:0},section_01_02:{initIndoor:!0,levelMusic:0},section_02_01:{initIndoor:!1,levelMusic:0},section_02_02:{initIndoor:!0,levelMusic:0},section_02_E1:{initIndoor:!0,levelMusic:0},section_03_01:{initIndoor:!1,levelMusic:0},section_03_02:{initIndoor:!0,levelMusic:0},section_03_E1:{initIndoor:!0,levelMusic:0},section_03_E2:{initIndoor:!1,levelMusic:0},section_04_01:{initIndoor:!1,levelMusic:0},section_04_02:{initIndoor:!1,levelMusic:0},section_04_E1:{initIndoor:!0,levelMusic:0},section_05_01:{initIndoor:!1,levelMusic:0},section_05_02:{initIndoor:!0,levelMusic:0},section_05_E1:{initIndoor:!0,levelMusic:0},section_05_E2:{initIndoor:!1,levelMusic:0},section_06_01:{initIndoor:!1,levelMusic:1},section_06_02:{initIndoor:!0,levelMusic:1},section_06_E1:{initIndoor:!0,levelMusic:1},section_07_01:{initIndoor:!1,levelMusic:1},section_07_02:{initIndoor:!1,levelMusic:1},section_07_E1:{initIndoor:!0,levelMusic:1},section_07_E2:{initIndoor:!0,levelMusic:1},section_08_01:{initIndoor:!1,levelMusic:1},section_08_02:{initIndoor:!0,levelMusic:1},section_08_E1:{initIndoor:!0,levelMusic:1},section_08_E2:{initIndoor:!0,levelMusic:1},section_09_01:{initIndoor:!0,levelMusic:1},section_09_02:{initIndoor:!1,levelMusic:1},section_09_E1:{initIndoor:!0,levelMusic:1},section_09_E2:{initIndoor:!0,levelMusic:1},section_10_01:{initIndoor:!1,levelMusic:1},section_10_02:{initIndoor:!0,levelMusic:1},section_10_E1:{initIndoor:!0,levelMusic:1},section_11_01:{initIndoor:!1,levelMusic:2},section_11_02:{initIndoor:!0,levelMusic:2},section_11_E1:{initIndoor:!0,levelMusic:2},section_11_E2:{initIndoor:!0,levelMusic:2},section_12_01:{initIndoor:!0,levelMusic:2},section_12_02:{initIndoor:!1,levelMusic:2},section_12_E1:{initIndoor:!0,levelMusic:2},section_12_E2:{initIndoor:!0,levelMusic:2},section_13_01:{initIndoor:!1,levelMusic:2},section_13_02:{initIndoor:!0,levelMusic:2},section_13_E1:{initIndoor:!0,levelMusic:2},section_13_E2:{initIndoor:!0,levelMusic:2},section_14_01:{initIndoor:!1,levelMusic:2},section_14_02:{initIndoor:!1,levelMusic:2},section_14_E1:{initIndoor:!0,levelMusic:2},section_15_01:{initIndoor:!1,levelMusic:2},section_15_02:{initIndoor:!0,levelMusic:2},section_15_E1:{initIndoor:!0,levelMusic:2},section_15_E2:{initIndoor:!0,levelMusic:2},"test-section_01_01":{initIndoor:!1,levelMusic:2},"test-section_01_02":{initIndoor:!0,levelMusic:2}},e}();i.default=n,cc._RF.pop()},{}],AudioManager:[function(e,t,i){"use strict";cc._RF.push(t,"d2ecdeTNMREd7N3dB833XEu","AudioManager");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./AudioScene"),a=e("../../../balance/AudioLevelConfig"),s=function(e){function t(){var t=e.call(this)||this;return t.lockSfxPlayback=!1,t.currentMusic=null,t.singleSFXPlayingList={},t.levelMusic=[{indoor:o.HowlsKey.ambience1b,outdoor:o.HowlsKey.ambience1a},{indoor:o.HowlsKey.ambience2b,outdoor:o.HowlsKey.ambience2a},{indoor:o.HowlsKey.ambience3b,outdoor:o.HowlsKey.ambience3a}],t.currentMusicLevelIn=null,t.currentMusicLevelOut=null,t.lastMusicLevel=null,t.musicId=null,t._musicVolume=.5,t.indexJumpCharacter=0,t.limitJumpCharacter=3,t.indexAttackCharacter=0,t.limitAttackCharacter=8,t.indexHitwallCharacter=0,t.limitHitwallCharacter=2,t.indexFinalBossPunch=0,t.limitFinalBossPunch=2,t.indexFinalBossDoublePunch=0,t.limitFinalBossDoublePunch=2,t.indexFinalBossAlertPunch=0,t.limitFinalBossAlertPunch=2,t.indexMud=0,t.limitMud=3,t.indexCoin=0,t.limitCoin=10,t.indexHitEnemy=0,t.limitHitEnemy=2,t.indexKillEnemy=0,t.limitKillEnemy=3,t.indexLevelIntro=0,t.limitLevelIntro=7,t.indexTygra=0,t.limitTygra=2,t.indexCheetaraIn=0,t.limitCheetaraIn=2,t.indexCheetaraOut=0,t.limitCheetaraOut=2,t.indexWilyKids=0,t.limitWilyKids=2,t.indexPanthro=0,t.limitPanthro=2,t.indexFloor=0,t.limitFloor=2,t.indexAmbience=0,t.limitAmbience=3,t.slideWallID=-1,t.waterID=-1,t.stunID=-1,t.fireInID=-1,t.fireLoopID=-1,t.fireOutID=-1,t.fireLoop=[],t.music=[],t.audioSprite=null,t.enableAudio=!0,t}return n(t,e),Object.defineProperty(t.prototype,"musicVolume",{get:function(){return this._musicVolume},set:function(e){this._musicVolume=e,this.currentMusic&&this.currentMusic.volume(e,this.musicId)},enumerable:!0,configurable:!0}),t.prototype.loadMusic=function(e,t){this.music[e]=new Howl({src:t,loop:!0,onload:this.onEndLoad.bind(this),volume:this.musicVolume})},t.prototype.loadAudioSprite=function(e,t){this.audioSprite=new Howl({src:e,onload:this.onEndLoad.bind(this),sprite:t}),this.audioSprite._sprite.character_mud4[2]=!0,this.audioSprite._sprite.obstacle_fire2[2]=!0,this.audioSprite._sprite.bosslevel_mummra7b[2]=!0,this.audioSprite._sprite.bosslevel_mutants7b[2]=!0},t.prototype.onEndLoad=function(e){this.emit("loaded")},t.prototype.enableAll=function(){this.enableAudio=!0,this.currentMusic&&this.currentMusic.play(),this.lastMusicLevel&&this.lastMusicLevel.play()},t.prototype.disableAll=function(){this.enableAudio=!1,this.currentMusic&&this.currentMusic.stop(),this.audioSprite&&this.audioSprite.stop(),this.lastMusicLevel&&this.lastMusicLevel.stop()},t.prototype.pause=function(){this.currentMusic&&this.currentMusic.pause(),this.lastMusicLevel&&this.lastMusicLevel.pause(),this.currentMusicLevelOut&&(this.currentMusicLevelOut.stop(),this.currentMusicLevelOut=null),this.audioSprite&&this.audioSprite.pause()},t.prototype.resume=function(){!Howler.ctx||"suspended"!==Howler.ctx.state&&"interrupted"!==Howler.ctx.state||Howler.ctx.resume(),this.currentMusic&&this.unpause(this.currentMusic),this.lastMusicLevel&&this.unpause(this.lastMusicLevel),this.audioSprite&&this.unpause(this.audioSprite)},t.prototype.initLevelMusic=function(e){this.currentMusic&&(this.currentMusic.stop(),this.currentMusic=null),this.currentMusicLevelConfig=a.default.levelMusicConfig[e];var t=this.levelMusic[this.currentMusicLevelConfig.levelMusic];this.currentMusicLevelConfig.initIndoor?this.currentMusicLevelIn=this.music[t.indoor]:this.currentMusicLevelIn=this.music[t.outdoor],this.playMusicLevel()},t.prototype.setLevelMusic=function(e){var t=this.levelMusic[this.currentMusicLevelConfig.levelMusic];this.currentMusicLevelIn=e?this.music[t.indoor]:this.music[t.outdoor],this.playMusicLevel()},t.prototype.playMusicLevel=function(){this.currentMusicLevelIn&&this.lastMusicLevel!==this.currentMusicLevelIn&&(this.lastMusicLevel&&(this.currentMusicLevelOut=this.lastMusicLevel,this.playMusicLevelOut()),this.lastMusicLevel=this.currentMusicLevelIn,this.playMusicLevelIn())},t.prototype.playMusicLevelIn=function(){this.enableAudio&&(this.currentMusicLevelIn.play(),this.currentMusicLevelIn.fade(0,this.musicVolume,500))},t.prototype.playMusicLevelOut=function(){this.enableAudio&&this.currentMusicLevelOut.fade(this.musicVolume,0,500)},t.prototype.playMusic=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=!0);var n=this.music[e];if(n&&n!==this.currentMusic&&(this.currentMusic&&this.currentMusic.stop(),this.currentMusicLevelOut&&(this.currentMusicLevelOut.stop(),this.currentMusicLevelOut=null),this.lastMusicLevel&&(this.lastMusicLevel.stop(),this.lastMusicLevel=null),this.currentMusic=n,this.enableAudio)){var o=this.currentMusic.play();this.musicId=o,this.currentMusic.loop(!!i,o),t>0&&this.currentMusic.fade(0,this.musicVolume,t,o)}},t.prototype.playCurrentMusicFadeOut=function(e){if(void 0===e&&(e=0),this.currentMusic&&this.enableAudio){this.currentMusic.fade(this.musicVolume,0,e);var t=this.currentMusic;this.currentMusic.on("fade",function(){t.stop(),t.volume(this.musicVolume)}.bind(this)),this.currentMusic=null}},t.prototype.stopMusic=function(){this.currentMusic&&this.currentMusic.stop(),this.currentMusicLevelOut&&(this.currentMusicLevelOut.stop(),this.currentMusicLevelOut=null),this.lastMusicLevel&&(this.lastMusicLevel.stop(),this.lastMusicLevel=null),this.currentMusic=null},t.prototype.changeVolumentMusic=function(e){e?this.currentMusicLevelIn&&this.currentMusicLevelIn.fade(0,.5*this.musicVolume,500):this.currentMusicLevelIn&&this.currentMusicLevelIn.fade(0,this.musicVolume,500)},t.prototype.playSfx=function(e){if(!this.audioSprite||this.lockSfxPlayback)return-1;if(this.enableAudio){var t=this.audioSprite.play(o.SFXKey[e]);return null===t&&console.warn("[SFX] El audiosprite no tiene: "+o.SFXKey[e]),t}},t.prototype.playSingleSfx=function(e){var t=this;if(this.audioSprite&&!this.singleSFXPlayingList[o.SFXKey[e]]){var i=this.playSfx(e);null!=i&&(this.singleSFXPlayingList[o.SFXKey[e]]=!0,this.audioSprite.once("end",function(){t.singleSFXPlayingList[o.SFXKey[e]]=!1},i))}},t.prototype.stopSfx=function(e){this.audioSprite&&null!=e&&this.enableAudio&&this.audioSprite.stop(e)},t.prototype.getSfxDuration=function(e){if(this.audioSprite&&null!=e)return this.audioSprite.duration(e)},t.prototype.doOnceSfxFinish=function(e,t){this.audioSprite&&this.audioSprite.once("end",t,e)},t.prototype.mute=function(e){Howler.mute(e)},t.prototype.unpause=function(e){for(var t,i=0;i<e._sounds.length;i++)e._sounds[i]._paused&&!e._sounds[i]._ended&&(0,t=e._sounds[i]._id,e.play(t))},t.prototype.playSfxFloor=function(){this.playSfx(o.SFXKey.character_floor+this.indexFloor),this.indexFloor=this.indexFloor+1===this.limitFloor?0:this.indexFloor+1},t.prototype.playSfxJump=function(){this.playSfx(o.SFXKey.character_jump1+this.indexJumpCharacter),this.indexJumpCharacter=this.indexJumpCharacter+1===this.limitJumpCharacter?0:this.indexJumpCharacter+1},t.prototype.playSfxAttack=function(){this.playSfx(o.SFXKey.character_sword1+this.indexAttackCharacter),this.indexAttackCharacter=this.indexAttackCharacter+1===this.limitAttackCharacter?0:this.indexAttackCharacter+1},t.prototype.playSfxHitwall=function(){this.playSfx(o.SFXKey.character_hitwall1+this.indexHitwallCharacter),this.indexHitwallCharacter=this.indexHitwallCharacter+1===this.limitHitwallCharacter?0:this.indexHitwallCharacter+1},t.prototype.initSlideWall=function(){if(this.audioSprite&&-1===this.slideWallID){var e=this.playSfx(o.SFXKey.character_slidewall);this.slideWallID=e}},t.prototype.endSlideWall=function(){-1!==this.slideWallID&&(this.stopSfx(this.slideWallID),this.slideWallID=-1)},t.prototype.playSfxFinalBossPunch=function(){this.playSfx(o.SFXKey.bosslevel_mummra1+this.indexFinalBossPunch),this.indexFinalBossPunch=this.indexFinalBossPunch+1===this.limitFinalBossPunch?0:this.indexFinalBossPunch+1},t.prototype.playSfxFinalBossDoublePunch=function(){this.playSfx(o.SFXKey.bosslevel_mummra3+this.indexFinalBossDoublePunch),this.indexFinalBossDoublePunch=this.indexFinalBossDoublePunch+1===this.limitFinalBossDoublePunch?0:this.indexFinalBossDoublePunch+1},t.prototype.playSfxFinalBossAlertPunch=function(){this.playSfx(o.SFXKey.bosslevel_mummra10+this.indexFinalBossAlertPunch),this.indexFinalBossAlertPunch=this.indexFinalBossAlertPunch+1===this.limitFinalBossAlertPunch?0:this.indexFinalBossAlertPunch+1},t.prototype.playSfxWater=function(){this.playSfx(o.SFXKey.character_mud1+this.indexMud),this.indexMud=this.indexMud+1===this.limitMud?0:this.indexMud+1},t.prototype.initWaterLoop=function(){if(this.audioSprite&&-1===this.waterID){var e=this.playSfx(o.SFXKey.character_mud4);this.waterID=e}},t.prototype.endWaterLoop=function(){-1!==this.waterID&&(this.stopSfx(this.waterID),this.waterID=-1)},t.prototype.initStunLoop=function(e){if(this.audioSprite&&-1===this.stunID){var t=e?o.SFXKey.bosslevel_mummra7b:o.SFXKey.bosslevel_mutants7b,i=this.playSfx(t);this.stunID=i}},t.prototype.endStunLoop=function(){-1!==this.stunID&&(this.stopSfx(this.stunID),this.stunID=-1)},t.prototype.playSfxCoin=function(){this.playSfx(o.SFXKey.coin1+this.indexCoin),this.indexCoin=this.indexCoin+1===this.limitCoin?0:this.indexCoin+1},t.prototype.playSfxHitEnemy=function(){this.playSfx(o.SFXKey.enemy_hit1+this.indexHitEnemy),this.indexHitEnemy=this.indexHitEnemy+1===this.limitHitEnemy?0:this.indexHitEnemy+1},t.prototype.playSfxKillEnemy=function(){this.playSfx(o.SFXKey.enemy_kill1+this.indexKillEnemy),this.indexKillEnemy=this.indexKillEnemy+1===this.limitKillEnemy?0:this.indexKillEnemy+1},t.prototype.playSfxLevelIntro=function(){this.playSfx(o.SFXKey.level_in1+this.indexLevelIntro),this.indexLevelIntro=this.indexLevelIntro+1===this.limitLevelIntro?0:this.indexLevelIntro+1},t.prototype.playSfxTygra=function(){this.playSfx(o.SFXKey.special_tygra1+this.indexTygra),this.indexTygra=this.indexTygra+1===this.limitTygra?0:this.indexTygra+1},t.prototype.playSfxCheetaraIn=function(){this.playSfx(o.SFXKey.special_cheetara1+this.indexCheetaraIn),this.indexCheetaraIn=this.indexCheetaraIn+1===this.limitCheetaraIn?0:this.indexCheetaraIn+1},t.prototype.playSfxCheetaraOut=function(){this.playSfx(o.SFXKey.special_cheetara3+this.indexCheetaraOut),this.indexCheetaraOut=this.indexCheetaraOut+1===this.limitCheetaraOut?0:this.indexCheetaraOut+1},t.prototype.playSfxWilyKids=function(){this.playSfx(o.SFXKey.special_wilykids1+this.indexWilyKids),this.indexWilyKids=this.indexWilyKids+1===this.limitWilyKids?0:this.indexWilyKids+1},t.prototype.playSfxPanthro=function(){this.playSfx(o.SFXKey.special_panthro2+this.indexPanthro),this.indexPanthro=this.indexPanthro+1===this.limitPanthro?0:this.indexPanthro+1},t.prototype.isSoundInCamera=function(e){var t=cc.find("Canvas/Main Camera"),i=t.getComponent(cc.Camera),n=t.parent.width/i.zoomRatio,o=t.parent.height/i.zoomRatio,a=t.x,s=t.y;return cc.rect(a,s,n,o).intersects(e)},t.prototype.playSfxRegion=function(e,t){return this.isSoundInCamera(t)?this.playSfx(e):-1},t.prototype.playFireIn=function(e){if(this.audioSprite)if(-1===this.fireInID&&this.isSoundInCamera(e.getRectSfx())){var t=this.playSfx(o.SFXKey.obstacle_fire1);this.fireInID=t,this.doOnceSfxFinish(t,this.addFireLoop.bind(this,e))}else this.addFireLoop(e)},t.prototype.addFireLoop=function(e){this.fireLoop.push(e),this.fireInID=-1,this.playFireLoop(e)},t.prototype.playFireLoop=function(e){if(this.audioSprite&&-1!==this.fireLoop.indexOf(e)){for(var t=!1,i=0,n=this.fireLoop.length;i<n;i++)t=this.isSoundInCamera(this.fireLoop[i].getRectSfx());if(t&&-1===this.fireLoopID){var a=this.playSfx(o.SFXKey.obstacle_fire2);this.fireLoopID=a}else t||-1===this.fireLoopID||(this.stopSfx(this.fireLoopID),this.fireLoopID=-1)}},t.prototype.playFireOut=function(e){if(this.audioSprite&&(-1!==this.fireLoop.indexOf(e)&&(this.fireLoop.splice(this.fireLoop.indexOf(e),1),0===this.fireLoop.length&&(this.stopSfx(this.fireLoopID),this.fireLoopID=-1)),-1===this.fireOutID&&this.isSoundInCamera(e.getRectSfx()))){var t=this.playSfx(o.SFXKey.obstacle_fire3);this.fireOutID=t,this.doOnceSfxFinish(t,this.onCompletedFireOut.bind(this))}},t.prototype.onCompletedFireOut=function(){this.fireOutID=-1},t.prototype.playSfxAmbience=function(e){var t;if(e)t=this.playSfx(o.SFXKey.bg_ambience0);else{var i=Math.floor(Math.random()*this.limitAmbience);i===this.indexAmbience&&(i=i+1>=this.limitAmbience?0:i),this.indexAmbience=i,t=this.playSfx(o.SFXKey.bg_ambience1+this.indexAmbience)}return t},t.prototype.clearAllSfx=function(){this.audioSprite&&(-1!==this.fireLoopID&&(this.stopSfx(this.fireLoopID),this.fireLoopID=-1),this.fireLoop=[],this.stunID=-1,this.waterID=-1,this.fireInID=-1,this.fireOutID=-1,this.audioSprite.stop())},t}(cc.Node);i.default=s,cc._RF.pop()},{"../../../balance/AudioLevelConfig":"AudioLevelConfig","./AudioScene":"AudioScene"}],AudioScene:[function(e,t,i){"use strict";cc._RF.push(t,"95e03nUMPpDnqojSOFFaiCb","AudioScene");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("../Singleton"),r=cc._decorator,c=r.ccclass,l=r.property;(function(e){e[e.audiosprite=0]="audiosprite",e[e.ambience1a=1]="ambience1a",e[e.ambience1b=2]="ambience1b",e[e.ambience2a=3]="ambience2a",e[e.ambience2b=4]="ambience2b",e[e.ambience3a=5]="ambience3a",e[e.ambience3b=6]="ambience3b",e[e.music_boss=7]="music_boss",e[e.music_menu=8]="music_menu",e[e.music_store=9]="music_store"})(a=i.HowlsKey||(i.HowlsKey={})),function(e){e[e.button_play=0]="button_play",e[e.button_pause=1]="button_pause",e[e.button_back=2]="button_back",e[e.no_coins=3]="no_coins",e[e.upgrade_select=4]="upgrade_select",e[e.upgrade_buy=5]="upgrade_buy",e[e.popup_store=6]="popup_store",e[e.level_passed=7]="level_passed",e[e.level_unlocked=8]="level_unlocked",e[e.popup_confirmation=9]="popup_confirmation",e[e.level_failed=10]="level_failed",e[e.level_completed1=11]="level_completed1",e[e.level_completed2=12]="level_completed2",e[e.button_generic=13]="button_generic",e[e.upgrade_alert=14]="upgrade_alert",e[e.character_jump1=15]="character_jump1",e[e.character_jump2=16]="character_jump2",e[e.character_jump3=17]="character_jump3",e[e.character_sword1=18]="character_sword1",e[e.character_sword2=19]="character_sword2",e[e.character_sword3=20]="character_sword3",e[e.character_sword4=21]="character_sword4",e[e.character_sword5=22]="character_sword5",e[e.character_sword6=23]="character_sword6",e[e.character_sword7=24]="character_sword7",e[e.character_sword8=25]="character_sword8",e[e.character_floor=26]="character_floor",e[e.character_floor2=27]="character_floor2",e[e.character_random=28]="character_random",e[e.character_damage=29]="character_damage",e[e.character_hitwall1=30]="character_hitwall1",e[e.character_hitwall2=31]="character_hitwall2",e[e.character_slidewall=32]="character_slidewall",e[e.character_winner=33]="character_winner",e[e.bosslevel_in1=34]="bosslevel_in1",e[e.bosslevel_in2=35]="bosslevel_in2",e[e.bosslevel_win1=36]="bosslevel_win1",e[e.bosslevel_win2=37]="bosslevel_win2",e[e.bosslevel_lose1=38]="bosslevel_lose1",e[e.bosslevel_lose2=39]="bosslevel_lose2",e[e.bosslevel_mutants1=40]="bosslevel_mutants1",e[e.bosslevel_mutants2=41]="bosslevel_mutants2",e[e.bosslevel_mutants3=42]="bosslevel_mutants3",e[e.bosslevel_mutants4=43]="bosslevel_mutants4",e[e.bosslevel_mutants5=44]="bosslevel_mutants5",e[e.bosslevel_mutants6=45]="bosslevel_mutants6",e[e.bosslevel_mutants7=46]="bosslevel_mutants7",e[e.bosslevel_mutants8=47]="bosslevel_mutants8",e[e.bosslevel_mutants9=48]="bosslevel_mutants9",e[e.bosslevel_mutants10=49]="bosslevel_mutants10",e[e.bosslevel_mutants11=50]="bosslevel_mutants11",e[e.bosslevel_mummra1=51]="bosslevel_mummra1",e[e.bosslevel_mummra2=52]="bosslevel_mummra2",e[e.bosslevel_mummra3=53]="bosslevel_mummra3",e[e.bosslevel_mummra4=54]="bosslevel_mummra4",e[e.bosslevel_mummra5=55]="bosslevel_mummra5",e[e.bosslevel_mummra6=56]="bosslevel_mummra6",e[e.bosslevel_mummra7=57]="bosslevel_mummra7",e[e.bosslevel_mummra8=58]="bosslevel_mummra8",e[e.bosslevel_mummra9=59]="bosslevel_mummra9",e[e.bosslevel_mummra10=60]="bosslevel_mummra10",e[e.bosslevel_mummra11=61]="bosslevel_mummra11",e[e.obstacle_wall1=62]="obstacle_wall1",e[e.obstacle_wall2=63]="obstacle_wall2",e[e.obstacle_spines=64]="obstacle_spines",e[e.character_mud1=65]="character_mud1",e[e.character_mud2=66]="character_mud2",e[e.character_mud3=67]="character_mud3",e[e.character_mud4=68]="character_mud4",e[e.item_snarf1=69]="item_snarf1",e[e.item_snarf2=70]="item_snarf2",e[e.item_snarf3=71]="item_snarf3",e[e.door_open=72]="door_open",e[e.door_close=73]="door_close",e[e.box_hit1=74]="box_hit1",e[e.box_hit2=75]="box_hit2",e[e.heart=76]="heart",e[e.coin1=77]="coin1",e[e.coin2=78]="coin2",e[e.coin3=79]="coin3",e[e.coin4=80]="coin4",e[e.coin5=81]="coin5",e[e.coin6=82]="coin6",e[e.coin7=83]="coin7",e[e.coin8=84]="coin8",e[e.coin9=85]="coin9",e[e.coin10=86]="coin10",e[e.enemy_hit1=87]="enemy_hit1",e[e.enemy_hit2=88]="enemy_hit2",e[e.enemy_kill1=89]="enemy_kill1",e[e.enemy_kill2=90]="enemy_kill2",e[e.enemy_kill3=91]="enemy_kill3",e[e.level_in0=92]="level_in0",e[e.level_in1=93]="level_in1",e[e.level_in2=94]="level_in2",e[e.level_in3=95]="level_in3",e[e.level_in4=96]="level_in4",e[e.level_in5=97]="level_in5",e[e.level_in6=98]="level_in6",e[e.level_in7=99]="level_in7",e[e.level_in8=100]="level_in8",e[e.character_level_in=101]="character_level_in",e[e.special_tygra1=102]="special_tygra1",e[e.special_tygra2=103]="special_tygra2",e[e.special_cheetara1=104]="special_cheetara1",e[e.special_cheetara2=105]="special_cheetara2",e[e.special_cheetara3=106]="special_cheetara3",e[e.special_cheetara4=107]="special_cheetara4",e[e.special_wilykids1=108]="special_wilykids1",e[e.special_wilykids2=109]="special_wilykids2",e[e.special_wilykids3=110]="special_wilykids3",e[e.special_panthro1=111]="special_panthro1",e[e.special_panthro2=112]="special_panthro2",e[e.special_panthro3=113]="special_panthro3",e[e.obstacle_turret1=114]="obstacle_turret1",e[e.obstacle_turret2=115]="obstacle_turret2",e[e.enemy_mortar1=116]="enemy_mortar1",e[e.enemy_mortar2=117]="enemy_mortar2",e[e.enemy_bird=118]="enemy_bird",e[e.enemy_worm=119]="enemy_worm",e[e.enemy_slime=120]="enemy_slime",e[e.enemy_bee1=121]="enemy_bee1",e[e.enemy_bee2=122]="enemy_bee2",e[e.enemy_frog=123]="enemy_frog",e[e.enemy_lizard=124]="enemy_lizard",e[e.enemy_crab1=125]="enemy_crab1",e[e.enemy_crab2=126]="enemy_crab2",e[e.obstacle_fire1=127]="obstacle_fire1",e[e.obstacle_fire2=128]="obstacle_fire2",e[e.obstacle_fire3=129]="obstacle_fire3",e[e.snarf1=130]="snarf1",e[e.snarf2=131]="snarf2",e[e.snarf3=132]="snarf3",e[e.character_lose=133]="character_lose",e[e.obstacle_platform1=134]="obstacle_platform1",e[e.obstacle_platform2=135]="obstacle_platform2",e[e.comic=136]="comic",e[e.combo3=137]="combo3",e[e.bosslevel_mutants7b=138]="bosslevel_mutants7b",e[e.bosslevel_mummra7b=139]="bosslevel_mummra7b",e[e.bg_ambience0=140]="bg_ambience0",e[e.bg_ambience1=141]="bg_ambience1",e[e.bg_ambience2=142]="bg_ambience2",e[e.bg_ambience3=143]="bg_ambience3"}(i.SFXKey||(i.SFXKey={}));var h=function(){function e(){this.id=a.audiosprite,this.nameFile="",this.isAudioSprite=!1,this.jsonAudioSprite=null}return o([l({type:cc.Enum(a)})],e.prototype,"id",void 0),o([l(cc.String)],e.prototype,"nameFile",void 0),o([l(cc.Boolean)],e.prototype,"isAudioSprite",void 0),o([l(cc.JsonAsset)],e.prototype,"jsonAudioSprite",void 0),e=o([c("AudioResource")],e)}(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.playInPreview=!0,t.formats=["m4a","mp3","ogg"],t.audioResources=[],t.isAllLoaded=!1,t.fileLoaded=0,t}var i;return n(t,e),i=t,t.prototype.onLoad=function(){this.instance=s.default.getInstance(),this.isAllLoaded=!1,this.playInPreview,this.initLoadAudio()},t.prototype.initLoadAudio=function(){this.fileLoaded=0,this.totalFiles=this.audioResources.length,this.loadHowl()},t.prototype.loadHowl=function(){var e;this.instance.audioManager.on("loaded",this.onLoadedHowl,this);for(var t=0,n=this.audioResources.length;t<n;t++){e=[];for(var o=0,a=this.formats.length;o<a;o++)e.push(i.pathAudio+this.audioResources[t].nameFile+"."+this.formats[o]);this.audioResources[t].isAudioSprite?this.instance.audioManager.loadAudioSprite(e,this.audioResources[t].jsonAudioSprite.json.sprite):this.instance.audioManager.loadMusic(this.audioResources[t].id,e)}},t.prototype.onLoadedHowl=function(){this.fileLoaded++,this.checkOnCompletedLoad()},t.prototype.checkOnCompletedLoad=function(){this.fileLoaded>=this.totalFiles&&(this.node.emit("loadAudio"),this.isAllLoaded=!0)},t.pathAudio="assets/audio/",o([l(cc.Boolean)],t.prototype,"playInPreview",void 0),o([l([cc.String])],t.prototype,"formats",void 0),o([l([h])],t.prototype,"audioResources",void 0),t=i=o([c],t)}(cc.Component);i.default=u,cc._RF.pop()},{"../Singleton":"Singleton"}],AudioSettingsController:[function(e,t,i){"use strict";cc._RF.push(t,"1ddcfbMhJ5FT6rnb5Pof0E9","AudioSettingsController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,r=a.property,c=a.menu,l=function(){function e(){this.normal=null,this.pressed=null,this.hover=null,this.disabled=null}return o([r(cc.SpriteFrame)],e.prototype,"normal",void 0),o([r(cc.SpriteFrame)],e.prototype,"pressed",void 0),o([r(cc.SpriteFrame)],e.prototype,"hover",void 0),o([r(cc.SpriteFrame)],e.prototype,"disabled",void 0),e=o([s("AudioSettingButtonSprites")],e)}();i.AudioSettingButtonSprites=l;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.musicButton=null,t.sfxButton=null,t.musicEnabledSprites=new l,t.musicDisabledSprites=new l,t.sfxEnabledSprites=new l,t.sfxDisabledSprites=new l,t}return n(t,e),t.prototype.switchMusicState=function(){this.playButtonSound();var e={isMusicEnabled:!0,isSFXEnabled:!0};e.isMusicEnabled=!e.isMusicEnabled,e.isMusicEnabled?this.changeButtonSprites(this.musicButton,this.musicEnabledSprites):this.changeButtonSprites(this.musicButton,this.musicDisabledSprites)},t.prototype.switchSFXState=function(){this.playButtonSound();var e={isMusicEnabled:!0,isSFXEnabled:!0};e.isSFXEnabled=!e.isSFXEnabled,e.isSFXEnabled?this.changeButtonSprites(this.sfxButton,this.sfxEnabledSprites):this.changeButtonSprites(this.sfxButton,this.sfxDisabledSprites)},t.prototype.playButtonSound=function(){var e=void 0;e&&e.playButtonClip()},t.prototype.changeButtonSprites=function(e,t){e.normalSprite=t.normal,e.pressedSprite=t.pressed,e.hoverSprite=t.hover,e.disabledSprite=t.disabled},t.prototype.suscribeSwitchBehaviour=function(e,t){var i=new cc.Component.EventHandler;i.target=this.node,i.component="AudioSettingsController",i.handler=t,e.clickEvents.push(i)},t.prototype.onLoad=function(){var e=!0,t=!0;this.musicEnabledSprites.size=this.musicButton.node.getContentSize(),this.sfxEnabledSprites.size=this.sfxButton.node.getContentSize(),this.musicDisabledSprites.size=this.musicButton.node.getContentSize(),this.sfxDisabledSprites.size=this.sfxButton.node.getContentSize(),e?this.changeButtonSprites(this.musicButton,this.musicEnabledSprites):this.changeButtonSprites(this.musicButton,this.musicDisabledSprites),t?this.changeButtonSprites(this.sfxButton,this.sfxEnabledSprites):this.changeButtonSprites(this.sfxButton,this.sfxDisabledSprites),this.suscribeSwitchBehaviour(this.musicButton,"switchMusicState"),this.suscribeSwitchBehaviour(this.sfxButton,"switchSFXState")},o([r(cc.Button)],t.prototype,"musicButton",void 0),o([r(cc.Button)],t.prototype,"sfxButton",void 0),o([r(l)],t.prototype,"musicEnabledSprites",void 0),o([r(l)],t.prototype,"musicDisabledSprites",void 0),o([r(l)],t.prototype,"sfxEnabledSprites",void 0),o([r(l)],t.prototype,"sfxDisabledSprites",void 0),t=o([s,c("Game Component/AudioSettingsController")],t)}(cc.Component);i.default=h,cc._RF.pop()},{}],AutoDestroySelf:[function(e,t,i){"use strict";cc._RF.push(t,"4b5cfSezZ5Ds7dnUKFcCQM/","AutoDestroySelf");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./PausableComponent"),s=cc._decorator,r=s.ccclass,c=s.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeRemaining=0,t}return n(t,e),t.prototype.update=function(e){this.timeRemaining-=e,this.timeRemaining<=0&&this.node.destroy()},o([c],t.prototype,"timeRemaining",void 0),t=o([r],t)}(a.default);i.default=l,cc._RF.pop()},{"./PausableComponent":"PausableComponent"}],AutoPauseAnimation:[function(e,t,i){"use strict";cc._RF.push(t,"6f9bbxljY9Hs5fWcLBsLgob","AutoPauseAnimation");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./PausableComponent"),s=cc._decorator,r=s.ccclass,c=s.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetNodePath="",t.animation=null,t}return n(t,e),t.prototype.onPause=function(){e.prototype.onPause.call(this),this.animation&&this.animation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.animation&&this.animation.resume()},t.prototype.onLoad=function(){if(e.prototype.onLoad.call(this),""!=this.targetNodePath){var t=cc.find(this.targetNodePath,this.node);t&&(this.animation=t.getComponent(cc.Animation))}else this.animation=this.node.getComponent(cc.Animation)},o([c],t.prototype,"targetNodePath",void 0),t=o([r],t)}(a.default);i.default=l,cc._RF.pop()},{"./PausableComponent":"PausableComponent"}],AutoScale:[function(e,t,i){"use strict";cc._RF.push(t,"41004C+ZFFHEZ/bonakP01L","AutoScale");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./Singleton"),s=e("./ResizeScreenManager"),r=e("./Utils"),c=cc._decorator,l=c.ccclass,h=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.widthMax=960,t.widthMin=640,t.maxScale=1.2,t.minScale=.8,t}return n(t,e),t.prototype.onLoad=function(){r.isMobile&&(a.default.getInstance().resizeScreenManager.on(s.default.KEY_SIGNAL_RESIZE,this.updateScale,this),this.updateScale())},t.prototype.updateScale=function(){var e,t=cc.view.getVisibleSize().width,i=this.widthMax-t,n=this.widthMax-this.widthMin,o=this.maxScale-this.minScale,a=this.node.getComponent(cc.Widget);e=t>=this.widthMax?this.maxScale:t<=this.widthMin?this.minScale:this.maxScale-o*(i/n),console.log("[Scale]"+e),this.node.scaleX=e,this.node.scaleY=e,a&&a.updateAlignment()},o([h],t.prototype,"widthMax",void 0),o([h],t.prototype,"widthMin",void 0),o([h],t.prototype,"maxScale",void 0),o([h],t.prototype,"minScale",void 0),t=o([l],t)}(cc.Component);i.default=u,cc._RF.pop()},{"./ResizeScreenManager":"ResizeScreenManager","./Singleton":"Singleton","./Utils":"Utils"}],Barrier:[function(e,t,i){"use strict";cc._RF.push(t,"b6176biTnJJZqJP383kSWIj","Barrier");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./Config"),s=e("./Destructable"),r=e("./Placeholder"),c=e("../core/Singleton"),l=e("../core/audio/AudioScene"),h=e("./PausableComponent"),u=e("./Game"),p=cc._decorator,d=p.ccclass,f=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.barrierFrame1=null,t.barrierFrame2=null,t.barrierFrame3=null,t.type=r.ActorColorType.GREEN,t.destructable=null,t.sprite=null,t}return n(t,e),t.prototype.onPause=function(){e.prototype.onPause.call(this)},t.prototype.onResume=function(){e.prototype.onResume.call(this)},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.destructable=this.getComponent(s.default),this.destructable&&(this.destructable.spriteNode=this.node),this.sprite=this.getComponent(cc.Sprite),this.sprite.spriteFrame=this.barrierFrame1},t.prototype.start=function(){var e=this;this.type==r.ActorColorType.GREEN&&(this.destructable.fullHealth=a.GreenBarrierConfig.health),this.type==r.ActorColorType.PINK&&(this.destructable.fullHealth=a.PinkBarrierConfig.health),this.node.on("onDamageTaken",function(t){var i=e.sprite.spriteFrame,n=t,o=Math.floor(100*n.remainingHealth/n.fullHealth);o>66?e.sprite.spriteFrame=e.barrierFrame1:o>33?e.sprite.spriteFrame=e.barrierFrame2:o>=0&&(e.sprite.spriteFrame=e.barrierFrame3),o>0?c.default.getInstance().audioManager.playSfx(l.SFXKey.obstacle_wall1):c.default.getInstance().audioManager.playSfx(l.SFXKey.obstacle_wall2),(i!=e.sprite.spriteFrame||n.remainingHealth<=0)&&u.default.instance.spawnPuff(e.node.position,e.type==r.ActorColorType.GREEN?u.PuffType.GREEN_BARRIER_PUFF:u.PuffType.PINK_BARRIER_PUFF)})},o([f(cc.SpriteFrame)],t.prototype,"barrierFrame1",void 0),o([f(cc.SpriteFrame)],t.prototype,"barrierFrame2",void 0),o([f(cc.SpriteFrame)],t.prototype,"barrierFrame3",void 0),o([f({type:cc.Enum(r.ActorColorType)})],t.prototype,"type",void 0),t=o([d],t)}(h.default);i.default=m,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/audio/AudioScene":"AudioScene","./Config":"Config","./Destructable":"Destructable","./Game":"Game","./PausableComponent":"PausableComponent","./Placeholder":"Placeholder"}],BootController:[function(e,t,i){"use strict";cc._RF.push(t,"2e778fNwg9CVKwmytjqfowP","BootController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../core/Singleton"),s=e("../game/controllers/TransitionController"),r=cc._decorator,c=r.ccclass,l=r.property,h=0,u=1,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transition=null,t.progressBar=null,t.startButton=null,t.TargetLevel="",t.LevelsToLoad=[],t.currentLoadingLevel=h,t.loaded=!1,t.maxLoadPerLevel=u,t}return n(t,e),t.prototype.onLoad=function(){this.node.on("loadAudio",this.checkLoadedCompleted,this),this.instance=a.default.getInstance();this.startButton.getComponent(cc.Button).interactable=!1,this.loadLevel(this.LevelsToLoad[this.currentLoadingLevel]),this.maxLoadPerLevel=1/this.LevelsToLoad.length,this.progressBar.progress=0,window.resizeBy(1,0)},t.prototype.loadLevel=function(e){var t=this;cc.director.preloadScene(e,function(e,i){t.levelLoading(e,i)},function(e,i){t.levelLoaded(e,i)})},t.prototype.levelLoaded=function(e,t){e&&(console.error("Error "+e.name+" while loading: "+t.name),this.loaded=!1);this.currentLoadingLevel==this.LevelsToLoad.length-1?(this.loaded=!0,this.checkLoadedCompleted()):(this.currentLoadingLevel++,this.loadLevel(this.LevelsToLoad[this.currentLoadingLevel]))},t.prototype.levelLoading=function(e,t){var i=e/t*this.maxLoadPerLevel+this.maxLoadPerLevel*this.currentLoadingLevel;this.progressBar&&(this.progressBar.progress=i)},t.prototype.checkLoadedCompleted=function(){this.loaded&&(this.startButton.active=!0,this.progressBar.node.active=!1,this.startButton.getComponent(cc.Button).interactable=!0)},t.prototype.pressStart=function(){this.startButton.getComponent(cc.Button).interactable=!1,this.showTransition(this.boot)},t.prototype.boot=function(){this.loaded&&cc.director.loadScene(this.TargetLevel)},t.prototype.showTransition=function(e){this.transition&&this.transition.showTransition(e.bind(this))},o([l(s.default)],t.prototype,"transition",void 0),o([l(cc.ProgressBar)],t.prototype,"progressBar",void 0),o([l(cc.Node)],t.prototype,"startButton",void 0),o([l],t.prototype,"TargetLevel",void 0),o([l([cc.String])],t.prototype,"LevelsToLoad",void 0),t=o([c],t)}(cc.Component);i.default=p,cc._RF.pop()},{"../core/Singleton":"Singleton","../game/controllers/TransitionController":"TransitionController"}],BossShip:[function(e,t,i){"use strict";cc._RF.push(t,"4b151rfDD9PKryraN/sOFQ1","BossShip");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./Game"),r=e("./Config"),c=e("../core/Utils"),l=e("./PatrollingPassiveEnemy"),h=e("./DoesDamage"),u=e("./Projectile"),p=e("./UpgradesManager"),d=e("../Testing/TesterLevelData"),f=e("./Missiles"),m=e("../core/Singleton"),g=e("../core/audio/AudioScene"),y=e("./PausableComponent"),v=cc._decorator,C=v.ccclass,_=v.property;(function(e){e[e.FIRST_ENCOUNTER=0]="FIRST_ENCOUNTER",e[e.SECOND_ENCOUNTER=1]="SECOND_ENCOUNTER"})(a=i.BossShipStage||(i.BossShipStage={})),function(e){e[e.LAUNCHING_MISSILES=0]="LAUNCHING_MISSILES",e[e.REFUELING=1]="REFUELING"}(i.BossShipState||(i.BossShipState={}));var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stage=a.FIRST_ENCOUNTER,t.bossShipPrefab=null,t.missileProjectilePrefab=null,t.missileAlertPrefab=null,t.missileExplosionPrefab=null,t.laneExplosionPrefab=null,t.plasmaGunPrefab=null,t.plasmaProjectilePrefab=null,t.plasmaAlertPrefab=null,t.patrollingEnemyPrefab=null,t.lifeIconHigh=null,t.lifeIconMedium=null,t.lifeIconLow=null,t.bossNode=null,t.spine=null,t.collider=null,t.originalMaterial=null,t.animation=null,t.glowNode=null,t.health=0,t.enraged=!1,t.spawnedFirstEnemies=!1,t.spawnedSecondEnemies=!1,t.prevMissilesPatternIndex=-1,t.prevPlasmaPatternIndex=-1,t.plasmaGunNodes=[],t}var i;return n(t,e),i=t,Object.defineProperty(t.prototype,"instance",{get:function(){return i._instance},enumerable:!0,configurable:!0}),t.prototype.onBeginContact=function(e,t,i){var n=this;if(i.tag==s.ColliderTag.PLAYER_ATTACK_AREA&&t.enabled){var o=i.getComponent(h.default);if(this.health-=o.attackDamage,this.spine.setMaterial(0,s.default.instance.spineOverlayColorMaterial),this.glowNode.active=!1,this.spine.scheduleOnce(function(){n.spine.setMaterial(0,n.originalMaterial),n.enraged&&n.health>0&&(n.glowNode.active=!0)},r.CommonEnemiesConfig.damageWhiteFlashTime),this.spine.setAnimation(0,"hit",!1),this.spine.addAnimation(0,"movement",!0),this.health<=.6666*this.maxHealth&&!this.spawnedFirstEnemies&&(this.spawnedFirstEnemies=!0,this.stage==a.SECOND_ENCOUNTER&&this.spawnPatrollingEnemies()),this.health<=.3333*this.maxHealth&&!this.spawnedSecondEnemies&&(this.spawnedSecondEnemies=!0,this.stage==a.SECOND_ENCOUNTER&&this.spawnPatrollingEnemies()),this.health<=.5*this.maxHealth&&!this.enraged)this.health=.5*this.maxHealth,this.updateLifeBar(),this.enterRageMode(),m.default.getInstance().audioManager.playSfxHitEnemy(),s.default.instance.shakeCamera(s.CameraShakeLevel.HIGH);else if(this.health<=0){m.default.getInstance().audioManager.endStunLoop(),this.health=0,this.updateLifeBar(),this.collider.enabled=!1,this.bossNode.cleanup(),m.default.getInstance().audioManager.playCurrentMusicFadeOut(500),this.scheduleOnce(function(){return m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_win1)},.5),this.spine.setAnimation(0,"defeat",!1),this.glowNode.active=!1,this.spine.setCompleteListener(function(){n.spine.setCompleteListener(null),n.spine.setAnimation(1,"out_refuel",!1)}),s.default.instance.shakeCamera(s.CameraShakeLevel.MEDIUM),s.default.instance.getPlayer().setImmune(15),p.default.instance.lastLevelWasCompleted=!0,d.default.instances.endTimerLevel();var c=this.stage==a.FIRST_ENCOUNTER?16:6;cc.tween(this.bossNode).to(5,{position:cc.v2(0,s.default.TILE_SIZE.height*c)},{easing:"quadIn"}).start(),this.scheduleOnce(function(){s.default.instance.spawnCollectables(n.node.position,n.cookiesCount),n.scheduleOnce(function(){s.default.instance.gameplayUI.hideAllUI(),s.default.instance.getPlayer().disableInput(),s.default.instance.getPlayer().doVictoryAnimation(),m.default.getInstance().audioManager.playSfx(g.SFXKey.character_winner),n.scheduleOnce(function(){return s.default.instance.levelComplete(1)},3)},6)},3.5)}else m.default.getInstance().audioManager.playSfxHitEnemy(),this.updateLifeBar(),s.default.instance.shakeCamera(s.CameraShakeLevel.LOW)}},t.prototype.spawnBossShip=function(){var e=this;this.bossNode=this.node,this.bossNode.position=cc.v2(0,14*s.default.TILE_SIZE.height),this.bossNode.scale=.6,this.bossNode.removeFromParent(),s.default.instance.actorsMiddleLayer.insertChild(this.bossNode,0),this.collider.enabled=!1,this.spine.setSkin("normal"),this.spine.setAnimation(0,"movement",!0),cc.tween(this.bossNode).delay(3).call(function(){m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_in1)}).to(6,{position:cc.v2(0,this.baseTerrainYCoord+12*s.default.TILE_SIZE.height)},{easing:"quadOut"}).call(function(){s.default.instance.gameplayUI.showBossUI(),s.default.instance.gameplayUI.showPauseButton(),s.default.instance.getPlayer().doIntroAnimation(function(){m.default.getInstance().audioManager.playMusic(g.HowlsKey.music_boss,0,!0),s.default.instance.getPlayer().enableInput(),e.scheduleOnce(function(){return e.attack()},1)})}).start()},t.prototype.spawnMissileProjectile=function(e){var t=cc.instantiate(this.missileProjectilePrefab);t.getComponent(f.default).init(this,e,this.missileDamage),s.default.instance.actorsFrontLayer.addChild(t),m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_mutants10)},t.prototype.spawnMissileAlert=function(e){var t=cc.instantiate(this.missileAlertPrefab),i=this.getMissileLanePosition(e);t.position=i,s.default.instance.actorsFrontLayer.addChild(t),m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_mutants9)},t.prototype.spawnPlasmaProjectile=function(e){var t=this,i=this.getPlasmaLanePosition(e),n=this.getPlasmaLaneDirection(e),o=cc.instantiate(this.plasmaAlertPrefab);o.position=i.add(cc.v2(n==c.Direction.LEFT?-200:200,0)),s.default.instance.actorsFrontLayer.addChild(o),m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_mutants11),this.scheduleOnce(function(){m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_mutants3),t.plasmaGunNodes[e].getChildByName("sprite").getComponent(cc.Animation).play("FX_laser_charge")},.2),this.scheduleOnce(function(){m.default.getInstance().audioManager.playSingleSfx(g.SFXKey.bosslevel_mutants4);var o=cc.instantiate(t.plasmaProjectilePrefab),a=o.getComponent(u.default);o.position=i.add(cc.v2(n==c.Direction.LEFT?-50:50)),a.throwSpeed=t.plasmaProjectileSpeed,a.throwAngle=t.getPlasmaLaneDirection(e)==c.Direction.LEFT?Math.PI:0,a.gravityScale=0,a.collidesWithPlatforms=!1;o.getComponent(h.default);s.default.instance.actorsBackLayer.addChild(o)},.5)},t.prototype.spawnPatrollingEnemies=function(){for(var e=0,t=0;t<this.enemySpawnsCount;++t){var i=cc.instantiate(this.patrollingEnemyPrefab),n=.5*-(this.missileLanesCount*this.missileLaneWidthTiles),o=-n,a=Math.random()<.5?c.Direction.RIGHT:c.Direction.LEFT,r=a==c.Direction.RIGHT?n-e-2:o+e+2,h=cc.v2(r*s.default.TILE_SIZE.width,this.baseTerrainYCoord+this.patrollingEnemyPrefab.data.position.y);i.position=h;var u=i.getComponent(l.default);u.leftLimitTiles=r-n,u.rightLimitTiles=o-r,u.initialDirection=a,u.disableBoundsCheck(),s.default.instance.actorsMiddleLayer.addChild(i),e+=2}m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_mutants6)},t.prototype.attack=function(){var e=this;console.info("performing "+this.attacksCount+" attacks!");for(var t=0,i=0;i<this.attacksCount;++i){t=this.stage==a.SECOND_ENCOUNTER&&this.enraged&&i%2==0?this.shootPlasma(t):this.launchMissiles(t),t+=this.attacksCooldownTime+1}this.scheduleOnce(function(){return e.beginRefuel()},t)},t.prototype.launchMissiles=function(e){var t=this,i=this.getMissilePattern(),n=Math.random()<.5;console.info("  missiles pattern: "+i+(n?" (reversed)":"")),this.scheduleOnce(function(){m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_mutants1),t.scheduleOnce(function(){m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_mutants1)},.2),t.scheduleOnce(function(){m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_mutants1)},.4),t.spine.setAnimation(0,"attack",!1),t.spine.addAnimation(0,"movement",!0)},e),e+=1;for(var o=function(o){var s=i.charAt(o);if(" "==s)e+=a.missilesSequenceDelay;else{var r=parseInt(s);r&&(n&&(r=a.missileLanesCount+1-r),a.scheduleOnce(function(){return t.spawnMissileAlert(r-1)},e),a.scheduleOnce(function(){return t.spawnMissileProjectile(r-1)},e+.5))}},a=this,s=0;s<i.length;++s)o(s);return e+.5},t.prototype.shootPlasma=function(e){var t=this,i=this.getPlasmaPattern(),n=Math.random()<.5;console.info("  plasma pattern: "+i+(n?" (reversed)":"")),e+=1;for(var o=function(o){var s=i.charAt(o);if(" "==s)e+=a.plasmaSequenceDelay;else{var r=parseInt(s);r&&(n&&(r=a.plasmaLanesCount+1-r),a.scheduleOnce(function(){return t.spawnPlasmaProjectile(r-1)},e))}},a=this,s=0;s<i.length;++s)o(s);return e},t.prototype.beginRefuel=function(){var e=this;console.info("begin refuel!"),this.spine.setAnimation(1,"in_refuel",!1),this.spine.addAnimation(1,"refuel",!0);var t=cc.tween,i=cc.tween(this.spine.node);m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_mutants7),m.default.getInstance().audioManager.initStunLoop(!1),t(this.bossNode).parallel(t().to(2,{position:cc.v2(0,this.baseTerrainYCoord+6*s.default.TILE_SIZE.height)},{easing:"quadOut"}),i.to(2,{scale:1},{easing:"quadIn"})).call(function(){e.collider.enabled=!0}).delay(this.refuelTime).call(function(){return e.endRefuel()}).start()},t.prototype.endRefuel=function(){var e=this;console.info("end refuel!"),this.collider.enabled=!1,this.spine.setAnimation(1,"out_refuel",!1);var t=cc.tween,i=cc.tween(this.spine.node);m.default.getInstance().audioManager.endStunLoop(),m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_mutants8),t(this.bossNode).parallel(t().to(2,{position:cc.v2(0,this.baseTerrainYCoord+12*s.default.TILE_SIZE.height)},{easing:"quadOut"}),i.to(2,{scale:.6},{easing:"quadOut"})).call(function(){return e.attack()}).start()},t.prototype.enterRageMode=function(){if(this.enraged=!0,this.spine.setSkin("rage"),this.glowNode.active=!0,this.stage==a.FIRST_ENCOUNTER)this.attacksCount=r.FirstBossShipConfig.hardAttacksCount,this.attacksCooldownTime=r.FirstBossShipConfig.hardAttacksCooldownTime,this.missilesSequenceDelay=r.FirstBossShipConfig.hardMissilesSequenceDelay,this.missilePatterns=r.FirstBossShipConfig.hardMissilePatterns;else if(this.stage==a.SECOND_ENCOUNTER){this.attacksCount=r.SecondBossShipConfig.hardAttacksCount,this.attacksCooldownTime=r.SecondBossShipConfig.hardAttacksCooldownTime,this.missilesSequenceDelay=r.SecondBossShipConfig.hardMissilesSequenceDelay,this.missilePatterns=r.SecondBossShipConfig.hardMissilePatterns;for(var e=0;e<this.plasmaLanesCount;++e){var t=cc.instantiate(this.plasmaGunPrefab),i=this.getPlasmaLaneDirection(e),n=this.getPlasmaLanePosition(e),o=n.add(cc.v2(i==c.Direction.LEFT?100:-100,0));t.position=o,i==c.Direction.LEFT&&(t.getChildByName("sprite").scaleX=-1),s.default.instance.actorsFrontLayer.addChild(t),this.plasmaGunNodes.push(t),cc.tween(t).to(2,{position:n},{easing:"quadOut"}).start()}}this.bossNode.cleanup(),this.endRefuel()},t.prototype.bossWin=function(){this.unscheduleAllCallbacks(),m.default.getInstance().audioManager.playCurrentMusicFadeOut(500),this.scheduleOnce(function(){return m.default.getInstance().audioManager.playSfx(g.SFXKey.bosslevel_lose1)},.5)},t.prototype.getMissileLanePosition=function(e){var t=-.5*this.missileLanesCount*this.missileLaneWidthPixels+this.missileLaneWidthPixels*(e+.5);return cc.v2(t,this.baseTerrainYCoord)},t.prototype.getMissileLaneWidthPixels=function(){return this.missileLaneWidthPixels},t.prototype.getPlasmaLanePosition=function(e){var t=e%2==0?this.leftWallXCoord:this.rightWallYCoord,i=this.baseTerrainYCoord+this.plasmaLaneHeightPixels*(e+.5);return cc.v2(t,i)},t.prototype.getPlasmaLaneDirection=function(e){return e%2==0?c.Direction.RIGHT:c.Direction.LEFT},t.prototype.getMissilePattern=function(){var e=Math.floor(Math.random()*this.missilePatterns.length);return e==this.prevMissilesPatternIndex&&++e,e>=this.missilePatterns.length&&(e=0),this.prevMissilesPatternIndex=e,this.missilePatterns[e]},t.prototype.getPlasmaPattern=function(){var e=Math.floor(Math.random()*this.plasmaPatterns.length);return e==this.prevPlasmaPatternIndex&&++e,e>=this.plasmaPatterns.length&&(e=0),this.prevPlasmaPatternIndex=e,this.plasmaPatterns[e]},t.prototype.updateLifeBar=function(e){void 0===e&&(e=!1);var t=this.health/this.maxHealth*this.lifeWidth;e?this.lifeBarNode.width=t:cc.tween(this.lifeBarNode).to(.5,{width:t}).start(),this.health/this.maxHealth>.5?this.lifeIconNode.getComponent(cc.Sprite).spriteFrame=this.lifeIconHigh:this.health/this.maxHealth>.25?this.lifeIconNode.getComponent(cc.Sprite).spriteFrame=this.lifeIconMedium:this.lifeIconNode.getComponent(cc.Sprite).spriteFrame=this.lifeIconLow},t.prototype.setup=function(){this.stage==a.FIRST_ENCOUNTER?(this.baseTerrainYCoord=11*-s.default.TILE_SIZE.height,this.leftWallXCoord=16*-s.default.TILE_SIZE.width,this.rightWallYCoord=-this.leftWallXCoord,this.maxHealth=r.FirstBossShipConfig.shipHealth,this.refuelTime=r.FirstBossShipConfig.shipRefuelTime,this.missileDamage=r.FirstBossShipConfig.missileDamage,this.missileLanesCount=r.FirstBossShipConfig.missileLanesCount,this.missileLaneWidthTiles=r.FirstBossShipConfig.missileLaneWidth,this.missileLaneWidthPixels=this.missileLaneWidthTiles*s.default.TILE_SIZE.width,this.attacksCount=r.FirstBossShipConfig.easyAttacksCount,this.enemySpawnsCount=r.FirstBossShipConfig.enemySpawnsCount,this.attacksCooldownTime=r.FirstBossShipConfig.easyAttacksCooldownTime,this.missilesSequenceDelay=r.FirstBossShipConfig.easyMissilesSequenceDelay,this.missilePatterns=r.FirstBossShipConfig.easyMissilePatterns,this.cookiesCount=r.FirstBossShipConfig.cookiesSpawnCount):this.stage==a.SECOND_ENCOUNTER&&(this.baseTerrainYCoord=11*-s.default.TILE_SIZE.height,this.leftWallXCoord=16*-s.default.TILE_SIZE.width,this.rightWallYCoord=-this.leftWallXCoord,this.maxHealth=r.SecondBossShipConfig.shipHealth,this.refuelTime=r.SecondBossShipConfig.shipRefuelTime,this.missileDamage=r.SecondBossShipConfig.missileDamage,this.missileLanesCount=r.SecondBossShipConfig.missileLanesCount,this.missileLaneWidthTiles=r.SecondBossShipConfig.missileLaneWidth,this.missileLaneWidthPixels=this.missileLaneWidthTiles*s.default.TILE_SIZE.width,this.plasmaProjectileDamage=r.SecondBossShipConfig.plasmaDamage,this.plasmaProjectileSpeed=r.SecondBossShipConfig.plasmaSpeed*s.default.TILE_SIZE.width,this.plasmaLanesCount=r.SecondBossShipConfig.plasmaLanesCount,this.plasmaLaneHeightPixels=r.SecondBossShipConfig.plasmaLaneHeight*s.default.TILE_SIZE.height,this.attacksCount=r.SecondBossShipConfig.easyAttacksCount,this.enemySpawnsCount=r.SecondBossShipConfig.enemySpawnsCount,this.attacksCooldownTime=r.SecondBossShipConfig.easyAttacksCooldownTime,this.missilesSequenceDelay=r.SecondBossShipConfig.easyMissilesSequenceDelay,this.missilePatterns=r.SecondBossShipConfig.easyMissilePatterns,this.plasmaSequenceDelay=r.SecondBossShipConfig.plasmaSequenceDelay,this.plasmaPatterns=r.SecondBossShipConfig.plasmaPatterns,this.cookiesCount=r.SecondBossShipConfig.cookiesSpawnCount),this.health=this.maxHealth,this.updateLifeBar(),this.spawnBossShip()},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.spine.paused=!0,this.animation.pause(),console.info("BossShip paused!")},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.spine.paused=!1,this.animation.resume(),console.info("BossShip resumed!")},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),null==i._instance&&(i._instance=this),this.spine=this.getComponentInChildren(sp.Skeleton),this.collider=this.getComponent(cc.PhysicsBoxCollider),this.originalMaterial=this.spine.getMaterial(0),this.animation=this.getComponent(cc.Animation),this.glowNode=this.node.getChildByName("glow"),cc.systemEvent.on("player-defeated",this.bossWin,this)},t.prototype.start=function(){this.lifeBarNode=cc.find("Canvas/UI/Game/boss_life_bar"),this.lifeIconNode=cc.find("Canvas/UI/Game/boss_life_icon"),this.lifeWidth=this.lifeBarNode.width,this.glowNode.active=!1,this.animation.play("FX_glow"),s.default.instance.gameplayUI.hidePauseButton()},t._instance=null,o([_({type:cc.Enum(a)})],t.prototype,"stage",void 0),o([_(cc.Prefab)],t.prototype,"bossShipPrefab",void 0),o([_(cc.Prefab)],t.prototype,"missileProjectilePrefab",void 0),o([_(cc.Prefab)],t.prototype,"missileAlertPrefab",void 0),o([_(cc.Prefab)],t.prototype,"missileExplosionPrefab",void 0),o([_(cc.Prefab)],t.prototype,"laneExplosionPrefab",void 0),o([_(cc.Prefab)],t.prototype,"plasmaGunPrefab",void 0),o([_(cc.Prefab)],t.prototype,"plasmaProjectilePrefab",void 0),o([_(cc.Prefab)],t.prototype,"plasmaAlertPrefab",void 0),o([_(cc.Prefab)],t.prototype,"patrollingEnemyPrefab",void 0),o([_(cc.SpriteFrame)],t.prototype,"lifeIconHigh",void 0),o([_(cc.SpriteFrame)],t.prototype,"lifeIconMedium",void 0),o([_(cc.SpriteFrame)],t.prototype,"lifeIconLow",void 0),t=i=o([C],t)}(y.default);i.default=b,cc._RF.pop()},{"../Testing/TesterLevelData":"TesterLevelData","../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Config":"Config","./DoesDamage":"DoesDamage","./Game":"Game","./Missiles":"Missiles","./PatrollingPassiveEnemy":"PatrollingPassiveEnemy","./PausableComponent":"PausableComponent","./Projectile":"Projectile","./UpgradesManager":"UpgradesManager"}],CameraController:[function(e,t,i){"use strict";cc._RF.push(t,"4f0507KohJNIIxpXFDShoPr","CameraController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../Game"),s=e("../PausableComponent"),r=cc._decorator,c=r.ccclass,l=(r.property,r.requireComponent),h=r.menu,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.camera=null,t.currentPosition=null,t.targetNode=null,t.targetOffset=cc.Vec2.ZERO,t.worldMapNode=null,t.respectWorldBounds=!0,t.boundsPadding=cc.v2(10,10),t.targetZoom=1,t.currentZoom=1,t.followHorizontal=!0,t.followVertical=!0,t.shaker=null,t.latestDt=0,t}var i;return n(t,e),i=t,Object.defineProperty(t.prototype,"zoom",{get:function(){return this.currentZoom},set:function(e){this.setZoom(e,!0)},enumerable:!0,configurable:!0}),t.prototype.setCameraSpeed=function(e,t,i){},t.prototype.setTargetNode=function(e,t){if(this.targetNode=e,t){var i=this.targetNode.parent.convertToWorldSpaceAR(this.targetNode.position.add(this.targetOffset)),n=this.node.parent.convertToNodeSpaceAR(i);this.node.x=n.x,this.node.y=n.y}},t.prototype.setTargetOffset=function(e){this.targetOffset=e},t.prototype.setBoundsPadding=function(e){this.boundsPadding=e},t.prototype.setWorld=function(e,t){this.worldMapNode=e,this.respectWorldBounds=t},t.prototype.setZoom=function(e,t){this.targetZoom=e,t&&(this.currentZoom=this.targetZoom,this.camera.zoomRatio=this.currentZoom,a.default.instance.scaleBackground())},t.prototype.setFollow=function(e,t){this.followHorizontal=e,this.followVertical=t},t.prototype.setPosition=function(e){var t=this.node.parent.convertToNodeSpaceAR(e);this.currentPosition=t,this.node.position=this.currentPosition},t.prototype.setShaker=function(e){this.shaker=e},t.prototype.getViewPortHalfWidth=function(e,t,i){return i||(i=this.currentZoom),.5*e.width/t/i},t.prototype.getViewPortHalfHeight=function(e,t,i){return i||(i=this.currentZoom),.5*e.height/t/i},t.prototype.calculateZoomToFit=function(e){var t=cc.view.getViewportRect(),i=this.getViewPortHalfWidth(t,cc.view.getScaleX(),1),n=this.getViewPortHalfHeight(t,cc.view.getScaleY(),1),o=2*i/e.width,a=2*n/e.height;return Math.min(o,a)},t.prototype.calculateZoomToFitWidth=function(e){var t=cc.view.getViewportRect();return 2*this.getViewPortHalfWidth(t,cc.view.getScaleX(),1)/e},t.prototype.calculateZoomToFitHeight=function(e){var t=cc.view.getViewportRect();return 2*this.getViewPortHalfHeight(t,cc.view.getScaleY(),1)/e},t.prototype.adjustPositionToWorldBounds=function(e,t){if(void 0===t&&(t=cc.Vec2.ZERO),!this.worldMapNode)return e;var i=cc.view.getViewportRect(),n=this.getViewPortHalfWidth(i,cc.view.getScaleX(),this.currentZoom),o=this.getViewPortHalfHeight(i,cc.view.getScaleY(),this.currentZoom),a=.5*this.worldMapNode.width,s=.5*this.worldMapNode.height,r=this.node.parent.convertToNodeSpaceAR(this.worldMapNode.convertToWorldSpaceAR(cc.Vec2.ZERO)),c=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO);return a>n+t.x?c.x-n<-a+t.x?e.x+=-a+t.x-(c.x-n):n+c.x>a-t.x&&(e.x-=n+c.x-(a-t.x)):e.x=r.x,s>o+t.y?c.y-o<-s+t.y?e.y+=-s+t.y-(c.y-o):o+c.y>s-t.y&&(e.y-=o+c.y-(s-t.y)):e.y=r.y,e},t.prototype.updateCameraPosition=function(e){if(this.targetNode&&this.targetNode.parent){var t=this.targetNode.parent.convertToWorldSpaceAR(this.targetNode.position),i=this.node.parent.convertToNodeSpaceAR(t);i.x,this.node.x,i.y,this.node.y;this.currentPosition||(this.currentPosition=this.node.position),this.followHorizontal&&(this.currentPosition.x=i.x),this.followVertical&&(this.currentPosition.y=i.y);var n=this.currentPosition.add(this.targetOffset);this.node.position=n,this.respectWorldBounds&&(n=this.adjustPositionToWorldBounds(n,this.boundsPadding)),this.shaker?this.node.position=n.add(this.shaker.getOffset(e)):this.node.position=n}},t.prototype.onPause=function(){e.prototype.onPause.call(this)},t.prototype.onResume=function(){e.prototype.onResume.call(this)},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.main=this,this.camera=this.node.getComponent(cc.Camera),this.targetZoom=this.camera.zoomRatio,this.currentZoom=this.targetZoom},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.start=function(){},t.prototype.update=function(e){this.latestDt=e,this.updateCameraPosition(e)},t.prototype.afterUpdate=function(){var e=cc.director.getDeltaTime();this.updateCameraPosition(e)},t.main=null,t=i=o([c,h("Game Component/Controllers/CameraController"),l(cc.Camera)],t)}(s.default);i.default=u,cc._RF.pop()},{"../Game":"Game","../PausableComponent":"PausableComponent"}],ChangeMusicLevel:[function(e,t,i){"use strict";cc._RF.push(t,"1fb18UIXvBJBKJXB1/AndjK","ChangeMusicLevel");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("../../game/Game"),r=e("../Singleton"),c=cc._decorator,l=c.ccclass,h=c.property;(function(e){e[e.Indoor=0]="Indoor",e[e.Outdoor=1]="Outdoor"})(a=i.MusicLevel||(i.MusicLevel={}));var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.musicOnCollision=a.Indoor,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){i.tag==s.ColliderTag.PLAYER_BODY&&r.default.getInstance().audioManager.setLevelMusic(this.musicOnCollision===a.Indoor)},t.prototype.onLoad=function(){this.node.children[0].active=!1},o([h({type:cc.Enum(a)})],t.prototype,"musicOnCollision",void 0),t=o([l],t)}(cc.Component);i.default=u,cc._RF.pop()},{"../../game/Game":"Game","../Singleton":"Singleton"}],CharacterAnimationController:[function(e,t,i){"use strict";cc._RF.push(t,"c2844JhtJRJvr8ldFq48xyT","CharacterAnimationController"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e){this._externalControl=!1,this.spine=e,this.animationLists={},this.animationsTransitions={}}return Object.defineProperty(e.prototype,"externalControl",{get:function(){return this._externalControl},set:function(e){this._externalControl=e,e||this.resolveAnimation()},enumerable:!0,configurable:!0}),e.prototype.getAnimationList=function(e){return this.animationLists[e]?this.animationLists[e].animations:[]},e.prototype.setAnimationList=function(e,t){this.animationLists[e]={animations:t,fulfilled:!1}},e.prototype.getCondition=function(e){return!!this.animationLists[e]&&this.animationLists[e].fulfilled},e.prototype.setCondition=function(e,t,i){void 0===i&&(i=!0),this.animationLists[e]&&(this.animationLists[e].fulfilled=t,i&&this.resolveAnimation())},e.prototype.getTransition=function(e){return this.animationsTransitions[e]?this.animationsTransitions[e]:null},e.prototype.setTransition=function(e,t){this.animationsTransitions&&(this.animationsTransitions[e]=t)},e.prototype.resolveAnimation=function(){var e=this;if(!this.externalControl){for(var t,i=Object.keys(this.animationLists),n=0;n<i.length;++n){var o=i[n];this.animationLists[o].fulfilled&&(t=t?this.animationLists[o].animations.filter(function(e){return-1!=t.indexOf(e)}):this.animationLists[o].animations)}if(t&&0!==t.length){var a=t[0],s=this.animationsTransitions[a];if(a!==this.spine.animation)if(s){this.spine.setAnimation(0,a,!1);var r=function(t){var i=e.animationsTransitions[t];i?(e.spine.setAnimation(0,t,!1),e.spine.setCompleteListener(function(){r(i)})):(e.spine.setAnimation(0,t,!0),e.spine.setCompleteListener(null))};this.spine.setCompleteListener(function(){r(s)})}else this.spine.setAnimation(0,a,!0),this.spine.setCompleteListener(null)}}},e}();i.default=n,cc._RF.pop()},{}],CharacterBaseController:[function(e,t,i){"use strict";cc._RF.push(t,"1b9a1+SvNVDk7kC7Zc/TSoL","CharacterBaseController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./CharacterAnimationController"),s=e("../../core/Utils"),r=e("../../core/Singleton"),c=e("../../core/audio/AudioScene"),l=e("../PausableComponent"),h=e("../Game"),u=e("../DoesDamage"),p=e("../Config"),d=e("../TrapPlatform"),f=e("../UpgradesManager"),m=e("../Projectile"),g=e("../../Testing/TesterLevelData"),y=cc._decorator,v=y.ccclass,C=y.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lifeIconHigh=null,t.lifeIconMedium=null,t.lifeIconLow=null,t._spine=null,t._body=null,t.originalMaterial=null,t.inputController=null,t.speed=cc.v2(0,0),t.maxSpeed=cc.v2(500,1500),t.drag=2450,t.gravityScale=1,t.jumpDelay=.01,t.initialFacingDirection=s.Direction.LEFT,t.poisonDamage=10,t.poisonImmuneTime=2,t.wallGrabLostMoveControlTime=1,t.wallJumpLostMoveControlTime=.5,t.knockbackLostMoveControlTime=.5,t.knockbackLostJumpControlTime=.5,t.knockbackImpulseSpeed=750,t.knockbackFrictionFactor=.5,t.knockbackLiftThreshold=0,t.shortJumpInertiaFactor=.5,t.simpleAttackDamage=10,t.simpleAttackCooldownTime=.5,t.quickButtonReleaseTime=.25,t.gravity=0,t.maxMoveVelocity=cc.v2(0,0),t.moveAcceleration=0,t.groundFriction=0,t.airFriction=0,t.iceFriction=0,t.mudMaxVelocity=0,t.poisonMaxVelocity=0,t.maxWallGrabFallVelocity=0,t.wallGrabFallAcceleration=0,t.jumpMaxHeight=0,t.jumpMinHeight=0,t.jumpPeakTime=0,t.jumpSpeed=0,t.generalImmuneTime=0,t.flashingHalfCycleFrames=0,t.maxHealth=100,t.health=100,t.moveVelocity=cc.v2(0,0),t.jumpRequested=!1,t.jumpBaseYPosition=0,t.jumpCurrentHeight=0,t.shortJump=!1,t.leftWallContacts=0,t.rightWallContacts=0,t.groundContacts=0,t.iceContacts=0,t.mudContacts=0,t.poisonContacts=0,t.attackCooldownTimeLeft=0,t.lostMoveControlTimeLeft=0,t.lostJumpControlTimeLeft=0,t.chainAttackCount=0,t.chargingStrongAttack=!1,t.strongAttackPerformed=!1,t.jumpInertiaDirection=s.Direction.NONE,t.jumpInertiaTimeLeft=0,t.mustReleaseToJumpAgain=!0,t.groundCollider=null,t.resolveCornerCollisionOffset=cc.v2(0,0),t.grounded=!1,t.groundedAccumulatedTime=0,t.jumping=!1,t.falling=!1,t.wallGrabbing=!1,t.attacking=!1,t.dashMoveSpeed=0,t.dashMinTime=0,t.dashMaxTime=0,t.dashTimeLeft=0,t.dashCooldownTimeLeft=0,t.aerialAttackPerformed=!1,t.onIce=!1,t.onMud=!1,t.onPoison=!1,t.takingDamage=!1,t.immuneTimeLeft=0,t.flashinTimeLeft=0,t.frameIntermittency=0,t.wasAerial=!1,t.wasWallGrabbing=!1,t.beignTouchedByEnemy=null,t.waterSurfacePosition=0,t.idleAtentionTime=8,t.idleAtentionTimeLeft=t.idleAtentionTime,t.playingIdleAtentionAnimation=!1,t.defaultFriction=.2,t.facingDirection=s.Direction.LEFT,t.moveDirection=s.Direction.NONE,t.moveToCoord=null,t.moveToCallback=null,t.isFrozen=!1,t.isGoingToJump=!1,t.jumpAnimCompleted=!0,t.isSpawn=!1,t.isShowIcon=!1,t.signalOn=[!1,!1,!1,!1,!1,!1],t.actionOn=[!1,!1,!1],t.inFrontOfDoor=null,t.sfxRandomID=-1,t}var i;return n(t,e),i=t,Object.defineProperty(t.prototype,"spine",{get:function(){return this._spine},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"body",{get:function(){return this._body},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isGrounded",{get:function(){return this.grounded},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isJumping",{get:function(){return this.jumping},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAerial",{get:function(){return this.jumping||this.falling},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isImmune",{get:function(){return this.immuneTimeLeft>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isWallGrabbing",{get:function(){return this.wallGrabbing},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAttacking",{get:function(){return this.attacking},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDashing",{get:function(){return this.dashTimeLeft>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isIdle",{get:function(){return this.isGrounded&&!this.isAttacking&&!this.isDashing&&this.moveDirection==s.Direction.NONE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"winAnimationName",{get:function(){return"win"},enumerable:!0,configurable:!0}),t.prototype.getHealth=function(){return this.health},t.prototype.getMaxHealth=function(){return this.maxHealth},t.prototype.setImmune=function(e){this.immuneTimeLeft=e},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.maxHealth=f.default.instance.howToLifeUnlocked?p.UpgradesConfig.extendedLifeHealth:p.PlayerConfig.maxHealth,this.health=this.maxHealth,this.poisonDamage=p.PlayerConfig.poisonDamage,this.poisonImmuneTime=p.PlayerConfig.poisonImmuneTime,this.wallGrabLostMoveControlTime=p.PlayerConfig.wallGrabLostMoveControlTime,this.wallJumpLostMoveControlTime=p.PlayerConfig.wallJumpLostMoveControlTime,this.knockbackLostMoveControlTime=p.PlayerConfig.knockbackLostMoveControlTime,this.knockbackLostJumpControlTime=p.PlayerConfig.knockbackLostJumpControlTime,this.knockbackImpulseSpeed=p.PlayerConfig.knockbackImpulseSpeed*h.default.TILE_SIZE.width,this.knockbackFrictionFactor=p.PlayerConfig.knockbackFrictionFactor,this.knockbackLiftThreshold=p.PlayerConfig.knockbackLiftThreshold,this.shortJumpInertiaFactor=p.PlayerConfig.shortJumpInertiaFactor,this.simpleAttackDamage=p.PlayerConfig.simpleAttackDamage,this.simpleAttackCooldownTime=p.PlayerConfig.simpleAttackCooldownTime,this.gravity=-h.default.TILE_SIZE.height*p.PlayerConfig.gravityMagnitude,this.maxMoveVelocity=cc.v2(h.default.TILE_SIZE.width*p.PlayerConfig.maxHorizontalSpeed,h.default.TILE_SIZE.height*p.PlayerConfig.maxVerticalSpeed),this.moveAcceleration=this.maxMoveVelocity.x/Math.max(p.PlayerConfig.moveAccelerationTime,1e-4),this.groundFriction=this.maxMoveVelocity.x/Math.max(p.PlayerConfig.groundFrictionTime,1e-4),this.airFriction=this.maxMoveVelocity.x/Math.max(p.PlayerConfig.airFrictionTime,1e-4),this.iceFriction=this.maxMoveVelocity.x/Math.max(p.PlayerConfig.iceFrictionTime,1e-4),this.mudMaxVelocity=h.default.TILE_SIZE.width*p.PlayerConfig.mudMaxMoveSpeed,this.poisonMaxVelocity=h.default.TILE_SIZE.width*p.PlayerConfig.poisonMaxMoveSpeed,this.maxWallGrabFallVelocity=-h.default.TILE_SIZE.height*p.PlayerConfig.maxWallSlideFallSpeed,this.wallGrabFallAcceleration=this.maxWallGrabFallVelocity/Math.max(p.PlayerConfig.wallSlideFallAccelerationTime,1e-4),this.jumpMaxHeight=h.default.TILE_SIZE.height*p.PlayerConfig.jumpMaxPeakHeight,this.jumpMinHeight=h.default.TILE_SIZE.height*p.PlayerConfig.jumpMinPeakHeight,this.jumpPeakTime=Math.sqrt(-2*this.jumpMaxHeight/this.gravity),this.jumpSpeed=2*this.jumpMaxHeight/this.jumpPeakTime,this.generalImmuneTime=p.PlayerConfig.generalImmuneTime,this.flashingHalfCycleFrames=Math.max(Math.floor(p.PlayerConfig.immuneFlashingCycleTime*cc.game.getFrameRate()/2),1),this.dashMoveSpeed=h.default.TILE_SIZE.width*p.UpgradesConfig.dashMoveSpeed,this.dashMinTime=h.default.TILE_SIZE.width*p.UpgradesConfig.dashMinDistance/this.dashMoveSpeed,this.dashMaxTime=h.default.TILE_SIZE.width*p.UpgradesConfig.dashMaxDistance/this.dashMoveSpeed,h.default.instance.setGravity(this.gravity),this._body=this.getComponent(cc.RigidBody),this._spine=this.getComponentInChildren(sp.Skeleton),this.originalMaterial=this._spine.getMaterial(0),this.inputController=this,this.defaultFriction=this.node.getComponent(cc.PhysicsCollider).friction,this.animationController=new a.default(this._spine);this.animationController.setAnimationList("grounded",["idle","run","jump_out"]),this.animationController.setAnimationList("aerial",["jump_in","jump_loop","jump_out"]),this.animationController.setAnimationList("moving",["run","jump_in","jump_out","jump_loop"]),this.animationController.setAnimationList("landing",["jump_out"]),this.animationController.setAnimationList("wallgrabbing",["wall_slide"]),this.animationController.setAnimationList("attacking",["attack_1"]),this.animationController.setTransition("jump_in","jump_loop"),this.animationController.setTransition("jump_out",""),this._body.gravityScale=i.groundGravityScale},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),cc.director.getPhysicsManager().off("before-step",this.groundReset,this)},t.prototype.start=function(){this.facingDirection=this.initialFacingDirection},t.prototype.update=function(e){var t=this;++this.frameIntermittency,this.frameIntermittency>=2*this.flashingHalfCycleFrames&&(this.frameIntermittency=0);var i=this.wasAerial&&this.grounded;this.onIce=this.grounded&&this.iceContacts>0,this.onMud=this.grounded&&this.mudContacts>0,this.onPoison=this.grounded&&this.poisonContacts>0,(this.onMud||this.onPoison)&&Math.abs(this.moveVelocity.x)>0?r.default.getInstance().audioManager.initWaterLoop():r.default.getInstance().audioManager.endWaterLoop(),this.flashinTimeLeft>0&&(this.flashinTimeLeft-=e,this.flashinTimeLeft<=0?(this.flashinTimeLeft=0,this.spine.setMaterial(0,this.originalMaterial)):this.frameIntermittency>=this.flashingHalfCycleFrames?this.spine.setMaterial(0,h.default.instance.spineOverlayColorMaterial):this.spine.setMaterial(0,this.originalMaterial)),this.immuneTimeLeft-=e,this.immuneTimeLeft<=0&&(this.immuneTimeLeft=0),this.attackCooldownTimeLeft-=e,this.attackCooldownTimeLeft<0&&(this.attackCooldownTimeLeft=0),this.lostMoveControlTimeLeft-=e,this.lostMoveControlTimeLeft<0&&(this.lostMoveControlTimeLeft=0),this.lostJumpControlTimeLeft-=e,this.lostJumpControlTimeLeft<0&&(this.lostJumpControlTimeLeft=0),this.dashTimeLeft>0&&(this.dashTimeLeft-=e,this.dashTimeLeft<=0&&(console.info("dashTimeLeft < 0"),this.dashTimeLeft=0,this.dashCooldownTimeLeft=p.UpgradesConfig.dashCooldownTime,this.animationController.externalControl=!1,r.default.getInstance().audioManager.playSfxCheetaraOut())),this.dashCooldownTimeLeft-=e,this.dashCooldownTimeLeft<0&&(this.dashCooldownTimeLeft=0),this.jumpInertiaTimeLeft>0&&(this.jumpInertiaTimeLeft-=e,this.jumpInertiaTimeLeft<=0&&(this.jumpInertiaTimeLeft=0,this.jumpInertiaDirection=s.Direction.NONE)),this.isIdle&&this.isInputEnabled()&&!h.default.instance.isBossStage?(this.idleAtentionTimeLeft-=e,this.idleAtentionTimeLeft<=0&&this.doIdleAtentionAnimation()):this.resetIdleAtentionState(),this.onPoison&&this.updateHealth(-this.poisonDamage,this.poisonImmuneTime),this.beignTouchedByEnemy&&!this.isImmune&&("Spikes"===this.beignTouchedByEnemy.node.name?r.default.getInstance().audioManager.playSfx(c.SFXKey.obstacle_spines):"FlyingChaserEnemy"===this.beignTouchedByEnemy.node.name?r.default.getInstance().audioManager.playSfx(c.SFXKey.enemy_bee2):"PatrollingEnemy"===this.beignTouchedByEnemy.node.name?r.default.getInstance().audioManager.playSfx(c.SFXKey.enemy_worm):"StaticPassiveEnemy"===this.beignTouchedByEnemy.node.name&&r.default.getInstance().audioManager.playSfx(c.SFXKey.enemy_slime),this.updateHealth(-this.beignTouchedByEnemy.touchDamage,this.generalImmuneTime)),(this.leftWallContacts>0||this.rightWallContacts>0)&&this.moveVelocity.y<=0&&!this.grounded?(this.wallGrabbing||(this.moveVelocity.y=0,this.lostMoveControlTimeLeft=this.wallGrabLostMoveControlTime,r.default.getInstance().audioManager.playSfxHitwall(),r.default.getInstance().audioManager.initSlideWall()),this.wallGrabbing=!0,this.jumping=!1,this.falling=!1,this.aerialAttackPerformed=!1,this.leftWallContacts>this.rightWallContacts?this.facingDirection=s.Direction.LEFT:this.facingDirection=s.Direction.RIGHT):(r.default.getInstance().audioManager.endSlideWall(),this.wallGrabbing=!1,this.moveDirection==s.Direction.NONE||this.isAttacking||this.isDashing||(this.facingDirection=this.moveDirection));var n;this.wasWallGrabbing&&this.wallGrabbing;this.falling=this.moveVelocity.y<0&&!this.grounded&&!this.wallGrabbing,this.facingDirection==s.Direction.LEFT&&(this.node.children[0].scaleX=-1),this.facingDirection==s.Direction.RIGHT&&(this.node.children[0].scaleX=1),this.grounded?(this.groundedAccumulatedTime+=e,n=this.onIce?this.iceFriction:this.groundFriction):(this.groundedAccumulatedTime=0,n=this.airFriction),this.jumpInertiaDirection==s.Direction.LEFT&&this.moveDirection==s.Direction.RIGHT&&(this.jumpInertiaDirection=s.Direction.NONE),this.jumpInertiaDirection==s.Direction.RIGHT&&this.moveDirection==s.Direction.LEFT&&(this.jumpInertiaDirection=s.Direction.NONE),this.jumpInertiaDirection==s.Direction.LEFT&&this.moveDirection==s.Direction.NONE&&this.isAerial&&(0==this.lostMoveControlTimeLeft&&(this.moveVelocity.x-=this.moveAcceleration*e),this.moveVelocity.x<0&&(n=0)),this.jumpInertiaDirection==s.Direction.RIGHT&&this.moveDirection==s.Direction.NONE&&this.isAerial&&(0==this.lostMoveControlTimeLeft&&(this.moveVelocity.x+=this.moveAcceleration*e),this.moveVelocity.x>0&&(n=0)),this.moveDirection!=s.Direction.LEFT||this.isAttacking||this.isDashing||(0==this.lostMoveControlTimeLeft&&(this.moveVelocity.x-=this.moveAcceleration*e),this.moveVelocity.x<0&&(n=0)),this.moveDirection!=s.Direction.RIGHT||this.isAttacking||this.isDashing||(0==this.lostMoveControlTimeLeft&&(this.moveVelocity.x+=this.moveAcceleration*e),this.moveVelocity.x>0&&(n=0)),this.isDashing&&(this.moveVelocity.x=this.facingDirection==s.Direction.LEFT?-this.dashMoveSpeed:this.dashMoveSpeed,n=0),this.lostMoveControlTimeLeft>0&&(n*=this.knockbackFrictionFactor),this.moveVelocity.x<0&&(this.moveVelocity.x+=n*e,this.moveVelocity.x>0&&(this.moveVelocity.x=0)),this.moveVelocity.x>0&&(this.moveVelocity.x-=n*e,this.moveVelocity.x<0&&(this.moveVelocity.x=0)),this.grounded||(this.isWallGrabbing?this.moveVelocity.y+=this.wallGrabFallAcceleration*e:this.moveVelocity.y+=this.gravity*this.gravityScale*e),this.jumpRequested&&this.isGrounded&&!this.isAttacking&&0==this.lostJumpControlTimeLeft&&(r.default.getInstance().audioManager.playSfxJump(),this.grounded=!1,this.jumping=!0,this.shortJump=!1,this.aerialAttackPerformed=!1,this.moveVelocity.y=this.jumpSpeed,this.jumpBaseYPosition=this.node.y,this.lostMoveControlTimeLeft=0,this.lostJumpControlTimeLeft=0,this.mustReleaseToJumpAgain&&(this.jumpRequested=!1),this.jumpInertiaDirection=s.Direction.NONE,this.jumpInertiaTimeLeft=0,h.default.instance.spawnPuff(this.node.position,h.PuffType.JUMP_DUST)),this.jumpRequested&&this.isWallGrabbing&&this.leftWallContacts>0&&0==this.lostJumpControlTimeLeft&&(r.default.getInstance().audioManager.playSfxJump(),this.jumping=!0,this.shortJump=!1,this.aerialAttackPerformed=!1,this.moveVelocity.x=this.maxMoveVelocity.x,this.moveVelocity.y=this.jumpSpeed,this.jumpBaseYPosition=this.node.y,this.facingDirection=s.Direction.RIGHT,this.lostMoveControlTimeLeft=this.wallJumpLostMoveControlTime,this.lostJumpControlTimeLeft=0,this.mustReleaseToJumpAgain&&(this.jumpRequested=!1),p.PlayerConfig.wallJumpKeepInertiaMaxTime>0&&(this.jumpInertiaDirection=s.Direction.RIGHT,this.jumpInertiaTimeLeft=p.PlayerConfig.wallJumpKeepInertiaMaxTime)),this.jumpRequested&&this.isWallGrabbing&&this.rightWallContacts>0&&0==this.lostJumpControlTimeLeft&&(r.default.getInstance().audioManager.playSfxJump(),this.jumping=!0,this.shortJump=!1,this.aerialAttackPerformed=!1,this.moveVelocity.x=-this.maxMoveVelocity.x,this.moveVelocity.y=this.jumpSpeed,this.jumpBaseYPosition=this.node.y,this.facingDirection=s.Direction.LEFT,this.lostMoveControlTimeLeft=this.wallJumpLostMoveControlTime,this.lostJumpControlTimeLeft=0,this.mustReleaseToJumpAgain&&(this.jumpRequested=!1),p.PlayerConfig.wallJumpKeepInertiaMaxTime>0&&(this.jumpInertiaDirection=s.Direction.LEFT,this.jumpInertiaTimeLeft=p.PlayerConfig.wallJumpKeepInertiaMaxTime)),this.jumping&&(this.jumpCurrentHeight=this.node.y-this.jumpBaseYPosition,this.shortJump&&this.jumpCurrentHeight>this.jumpMinHeight&&(this.shortJump=!1,this.moveVelocity.y*=this.shortJumpInertiaFactor)),!this.isDashing&&this.moveVelocity.x>this.maxMoveVelocity.x&&(this.moveVelocity.x=this.maxMoveVelocity.x),!this.isDashing&&this.moveVelocity.x<-this.maxMoveVelocity.x&&(this.moveVelocity.x=-this.maxMoveVelocity.x),this.moveVelocity.y>this.maxMoveVelocity.y&&(this.moveVelocity.y=this.maxMoveVelocity.y),this.moveVelocity.y<-this.maxMoveVelocity.y&&(this.moveVelocity.y=-this.maxMoveVelocity.y),this.isWallGrabbing&&this.moveVelocity.y<this.maxWallGrabFallVelocity&&(this.moveVelocity.y=this.maxWallGrabFallVelocity),this.onMud&&this.moveVelocity.x>this.mudMaxVelocity&&(this.moveVelocity.x=this.mudMaxVelocity),this.onMud&&this.moveVelocity.x<-this.mudMaxVelocity&&(this.moveVelocity.x=-this.mudMaxVelocity),this.onPoison&&this.moveVelocity.x>this.poisonMaxVelocity&&(this.moveVelocity.x=this.poisonMaxVelocity),this.onPoison&&this.moveVelocity.x<-this.poisonMaxVelocity&&(this.moveVelocity.x=-this.poisonMaxVelocity);var o=new cc.Vec2;o.x=Math.max(this.node.position.x,.5*-h.default.instance.worldMapSize.width*h.default.TILE_SIZE.width+.5*h.default.TILE_SIZE.width),o.x=Math.min(o.x,.5*h.default.instance.worldMapSize.width*h.default.TILE_SIZE.width-.5*h.default.TILE_SIZE.width),o.y=Math.max(this.node.position.y,.5*-h.default.instance.worldMapSize.height*h.default.TILE_SIZE.height+.5*h.default.TILE_SIZE.height),o.y=Math.min(o.y,.5*h.default.instance.worldMapSize.height*h.default.TILE_SIZE.height-.5*h.default.TILE_SIZE.height),null!=this.moveToCoord&&(this.moveDirection==s.Direction.LEFT&&this.node.position.x<=this.moveToCoord&&(o.x=this.moveToCoord,this.moveToCoord=null,this.moveToCallback&&this.moveToCallback()),this.moveDirection==s.Direction.RIGHT&&this.node.position.x>=this.moveToCoord&&(o.x=this.moveToCoord,this.moveToCoord=null,this.moveToCallback&&this.moveToCallback())),h.default.instance.isBossStage&&(o.y=Math.min(o.y,h.default.instance.bossLevelMaxHeight*h.default.TILE_SIZE.height)),o.equals(this.node.position)||(this.node.position=o),this.body.linearVelocity=this.moveVelocity,this.wasAerial=this.isAerial,this.wasWallGrabbing=this.isWallGrabbing,this.isGrounded?(i&&!this.animationController.externalControl&&(this.animationController.externalControl=!0,this.animationController.setCondition("aerial",!1,!1),this.animationController.setCondition("grounded",!0,!1),this.animationController.setCondition("landing",!1),r.default.getInstance().audioManager.playSfxFloor(),this._spine.setAnimation(0,"jump_out",!1),this.spine.setCompleteListener(function(){t.spine.setCompleteListener(null),t.animationController.externalControl=!1}),h.default.instance.spawnPuff(this.node.position,h.PuffType.LAND_DUST),i=!1),this.moveDirection==s.Direction.NONE&&(this.animationController.setCondition("grounded",!0),this.animationController.setCondition("moving",!1)),this.moveDirection==s.Direction.LEFT&&this.animationController.setCondition("moving",!0),this.moveDirection==s.Direction.RIGHT&&this.animationController.setCondition("moving",!0),this.animationController.setCondition("aerial",!1),this.animationController.setCondition("wallgrabbing",!1)):this.isWallGrabbing?(this.animationController.setCondition("grounded",!1),this.animationController.setCondition("moving",!1),this.animationController.setCondition("aerial",!1),this.animationController.setCondition("wallgrabbing",!0)):this.isAerial&&!this.animationController.getCondition("aerial")&&(this.animationController.setCondition("grounded",!1),this.animationController.setCondition("moving",!1),this.animationController.setCondition("aerial",!0),this.animationController.setCondition("wallgrabbing",!1))},t.prototype.applyKnockback=function(e,t){void 0===t&&(t=1);var i=e.mul(this.knockbackImpulseSpeed*t);this.moveVelocity=i,this.lostMoveControlTimeLeft=this.knockbackLostMoveControlTime,this.lostJumpControlTimeLeft=this.knockbackLostJumpControlTime},t.prototype.setMoveRequest=function(e){e!=s.Direction.NONE&&this.resetIdleAtentionState(),this.moveDirection=e},t.prototype.setJumpRequest=function(e){var t=this;if(this.resetIdleAtentionState(),this.jumpRequested=e,!this.jumpRequested&&!this.shortJump&&this.jumping&&this.moveVelocity.y>0&&(this.shortJump=!0),!p.PlayerConfig.alternativeAerialAttackControls&&e&&this.moveVelocity.y>=.3*-this.jumpSpeed&&this.isAerial&&!this.aerialAttackPerformed&&f.default.instance.aerialSlashUnlocked){this.aerialAttackPerformed=!0,this.attacking=!0;var i=cc.Vec2.ZERO;i.x+=this.facingDirection==s.Direction.LEFT?-40:40,i.y+=80,h.default.instance.spawnBoxAttackArea(i,cc.size(120,200),this.facingDirection,this.simpleAttackDamage,.4,h.ColliderTag.PLAYER_ATTACK_AREA,this.node),this.moveVelocity.y=.5*this.jumpSpeed,this.animationController.externalControl=!0,r.default.getInstance().audioManager.playSfxAttack(),this._spine.setAnimation(0,"aerial_slash",!0),this.spine.setCompleteListener(function(){t.attacking=!1,t.spine.setCompleteListener(null),t.animationController.externalControl=!1}),this.attackCooldownTimeLeft=.4+this.simpleAttackCooldownTime,this.immuneTimeLeft=Math.max(this.immuneTimeLeft,.4)}},t.prototype.setAttackRequest=function(e){var t=this;if(this.isGrounded&&this.inFrontOfDoor){g.default.instances.endTimerSection(),this.inFrontOfDoor.open(),this.jumpRequested=!1;this.lostJumpControlTimeLeft=1,this.lostMoveControlTimeLeft=1,this.moveVelocity=cc.Vec2.ZERO,this.moveDirection=s.Direction.NONE;var i=this.inFrontOfDoor;return this.inputController.disableInput(),void this.scheduleOnce(function(){return h.default.instance.changeScene(i.sceneName,i.entryNodeName)},1)}if(this.isGrounded&&0==this.attackCooldownTimeLeft){this.chainAttackCount=1,this.attacking=!0,r.default.getInstance().audioManager.playSfxAttack();var n=.1;(o=this.node.position).x+=this.facingDirection==s.Direction.LEFT?-70:70,o.y+=70,h.default.instance.spawnBoxAttackArea(o,cc.size(140,150),this.facingDirection,this.simpleAttackDamage,n,h.ColliderTag.PLAYER_ATTACK_AREA),this.animationController.externalControl=!0,this._spine.setAnimation(0,"attack_1",!1),this.spine.setCompleteListener(function(){t.attacking=!1,t.spine.setCompleteListener(null),t.animationController.externalControl=!1}),this.attackCooldownTimeLeft=n+this.simpleAttackCooldownTime}else if(this.isGrounded&&this.attackCooldownTimeLeft>0&&f.default.instance.rapidSlashUnlocked&&1==this.chainAttackCount){this.chainAttackCount=2,this.attacking=!0,r.default.getInstance().audioManager.playSfxAttack();n=.2;(o=this.node.position).x+=this.facingDirection==s.Direction.LEFT?-70:70,o.y+=70,h.default.instance.spawnBoxAttackArea(o,cc.size(140,150),this.facingDirection,p.UpgradesConfig.secondAttackDamage,n,h.ColliderTag.PLAYER_ATTACK_AREA),this.animationController.externalControl=!0,this._spine.setAnimation(0,"attack_2",!1),this.spine.setCompleteListener(function(){t.attacking=!1,t.spine.setCompleteListener(null),t.animationController.externalControl=!1}),this.attackCooldownTimeLeft=n+this.simpleAttackCooldownTime}else if(this.isGrounded&&this.attackCooldownTimeLeft>0&&f.default.instance.rapidSlashUnlocked&&2==this.chainAttackCount){this.chainAttackCount=0,this.attacking=!0,r.default.getInstance().audioManager.playSfx(c.SFXKey.combo3);var o;n=.4;(o=this.node.position).x+=this.facingDirection==s.Direction.LEFT?-90:90,o.y+=70,h.default.instance.spawnBoxAttackArea(o,cc.size(180,150),this.facingDirection,p.UpgradesConfig.thirdAttackDamage,n,h.ColliderTag.PLAYER_ATTACK_AREA),this.animationController.externalControl=!0,this._spine.setAnimation(0,"attack_3",!1),this.spine.setCompleteListener(function(){t.attacking=!1,t.spine.setCompleteListener(null),t.animationController.externalControl=!1}),this.attackCooldownTimeLeft=n+this.simpleAttackCooldownTime}},t.prototype.onAttackButtonPressed=function(e){var t=this;if(this.resetIdleAtentionState(),p.PlayerConfig.alternativeAerialAttackControls&&this.isAerial&&!this.aerialAttackPerformed&&f.default.instance.aerialSlashUnlocked){this.aerialAttackPerformed=!0,this.attacking=!0;var i=.4;(n=cc.Vec2.ZERO).x+=this.facingDirection==s.Direction.LEFT?-40:40,n.y+=80,h.default.instance.spawnBoxAttackArea(n,cc.size(120,200),this.facingDirection,this.simpleAttackDamage,i,h.ColliderTag.PLAYER_ATTACK_AREA,this.node),this.moveVelocity.y=.5*this.jumpSpeed,this.animationController.externalControl=!0,r.default.getInstance().audioManager.playSfxAttack(),this._spine.setAnimation(0,"aerial_slash",!0),this.spine.setCompleteListener(function(){t.attacking=!1,t.spine.setCompleteListener(null),t.animationController.externalControl=!1}),this.attackCooldownTimeLeft=i+this.simpleAttackCooldownTime,this.immuneTimeLeft=Math.max(this.immuneTimeLeft,i)}if(!p.PlayerConfig.alternativeAerialAttackControls&&this.isAerial&&f.default.instance.tygraUnlocked&&!this.aerialAttackPerformed){this.aerialAttackPerformed=!0,this.attacking=!0;var n;i=.4;(n=cc.Vec2.ZERO).x+=this.facingDirection==s.Direction.LEFT?-50:50,n.y+=30,this.gravityScale=0,this.moveVelocity.x=0,this.moveVelocity.y=0,h.default.instance.spawnBoxAttackArea(n,cc.size(120,100),this.facingDirection,this.simpleAttackDamage,i,h.ColliderTag.PLAYER_ATTACK_AREA,this.node),this.scheduleOnce(function(){t.gravityScale=1,t.moveVelocity.x+=t.facingDirection==s.Direction.LEFT?-500:500,t.moveVelocity.y=-500},.1),this.animationController.externalControl=!0,r.default.getInstance().audioManager.playSfxTygra(),this._spine.setAnimation(0,"tygra",!0),this.spine.setCompleteListener(function(){t.attacking=!1,t.spine.setCompleteListener(null),t.animationController.externalControl=!1}),this.attackCooldownTimeLeft=i+this.simpleAttackCooldownTime,this.immuneTimeLeft=Math.max(this.immuneTimeLeft,i)}},t.prototype.onAttackButtonHeld=function(e){var t=this;if(this.resetIdleAtentionState(),e>this.quickButtonReleaseTime&&this.isGrounded&&!this.isDashing&&f.default.instance.panthroUnlocked&&!this.chargingStrongAttack&&!this.strongAttackPerformed&&(this.chargingStrongAttack=!0,this.strongAttackPerformed=!1,this.attacking=!0,this.animationController.externalControl=!0,r.default.getInstance().audioManager.playSfx(c.SFXKey.special_panthro1),this._spine.setAnimation(0,"charge",!0)),e>=p.UpgradesConfig.strongAttackChargeTime&&this.chargingStrongAttack){this.chargingStrongAttack=!1,this.strongAttackPerformed=!0,this.attacking=!0;var i=this.node.position;i.x+=this.facingDirection==s.Direction.LEFT?-170:170,i.y+=70,this.scheduleOnce(function(){h.default.instance.spawnBoxAttackArea(i,cc.size(250,150),t.facingDirection,p.UpgradesConfig.strongAttackDamage,.4,h.ColliderTag.PLAYER_ATTACK_AREA),h.default.instance.shakeCamera(h.CameraShakeLevel.EXTREME)},.3),this.animationController.externalControl=!0,r.default.getInstance().audioManager.playSfxPanthro(),this._spine.setAnimation(0,"call",!0),this._spine.setAnimation(1,"panthro",!1),this.spine.setCompleteListener(function(){t.attacking=!1,t.spine.setCompleteListener(null),t.animationController.externalControl=!1}),this.attackCooldownTimeLeft=.4+this.simpleAttackCooldownTime}},t.prototype.onAttackButtonReleased=function(e){this.resetIdleAtentionState(),e<=this.quickButtonReleaseTime&&!this.isDashing&&this.setAttackRequest(!0),e<p.UpgradesConfig.strongAttackChargeTime&&this.chargingStrongAttack&&(this.chargingStrongAttack=!1,this.strongAttackPerformed=!1,this.attacking=!1,this.animationController.externalControl=!1),this.strongAttackPerformed&&(this.strongAttackPerformed=!1)},t.prototype.onSpecialButtonPressed=function(e){var t=this;if(this.resetIdleAtentionState(),p.PlayerConfig.alternativeAerialAttackControls&&this.isAerial&&f.default.instance.tygraUnlocked&&!this.aerialAttackPerformed){this.aerialAttackPerformed=!0,this.attacking=!0;var i=cc.Vec2.ZERO;i.x+=this.facingDirection==s.Direction.LEFT?-50:50,i.y+=30,this.gravityScale=0,this.moveVelocity.x=0,this.moveVelocity.y=0,h.default.instance.spawnBoxAttackArea(i,cc.size(120,100),this.facingDirection,this.simpleAttackDamage,.4,h.ColliderTag.PLAYER_ATTACK_AREA,this.node),this.scheduleOnce(function(){t.gravityScale=1,t.moveVelocity.x+=t.facingDirection==s.Direction.LEFT?-500:500,t.moveVelocity.y=-500},.1),this.animationController.externalControl=!0,r.default.getInstance().audioManager.playSfxTygra(),this._spine.setAnimation(0,"tygra",!0),this.spine.setCompleteListener(function(){t.attacking=!1,t.spine.setCompleteListener(null),t.animationController.externalControl=!1}),this.attackCooldownTimeLeft=.4+this.simpleAttackCooldownTime,this.immuneTimeLeft=Math.max(this.immuneTimeLeft,.4)}},t.prototype.onSpecialButtonHeld=function(e){this.resetIdleAtentionState(),e>this.quickButtonReleaseTime&&this.groundedAccumulatedTime>this.quickButtonReleaseTime&&this.isGrounded&&!this.isAttacking&&f.default.instance.cheetaraUnlocked&&!this.isDashing&&0==this.dashCooldownTimeLeft&&(this.dashTimeLeft=this.dashMaxTime,this.animationController.externalControl=!0,this._spine.setAnimation(0,"cheetara",!0),r.default.getInstance().audioManager.playSfxCheetaraIn()),this.isGrounded&&this.isDashing&&(this.immuneTimeLeft=Math.max(this.immuneTimeLeft,.1)),!this.isGrounded&&this.isDashing&&(this.dashTimeLeft=0,r.default.getInstance().audioManager.playSfxCheetaraOut(),this.dashCooldownTimeLeft=p.UpgradesConfig.dashCooldownTime,this.animationController.externalControl=!1)},t.prototype.onSpecialButtonReleased=function(e){var t=this;if(this.resetIdleAtentionState(),e<=this.quickButtonReleaseTime&&this.isGrounded&&!this.isAttacking&&f.default.instance.wilykatWilykitUnlocked){this.attacking=!0;var i=p.UpgradesConfig.rangeAttackProjectileSpeed*h.default.TILE_SIZE.width,n=cc.misc.degreesToRadians(p.UpgradesConfig.rangeAttackProjectileAngle);this.facingDirection==s.Direction.LEFT&&(n=Math.PI-n),this.scheduleOnce(function(){return h.default.instance.spawnProjectile(t.node.position.add(cc.v2(0,180)),i,n,1,p.UpgradesConfig.rangeAttackDamage,m.ProjectileType.CAPSULE)},.2),h.default.instance.updateUI(),this.animationController.externalControl=!0,this._spine.setAnimation(0,"call",!0),this._spine.setAnimation(1,"willykatwilikit",!1),r.default.getInstance().audioManager.playSfxWilyKids(),this.spine.setCompleteListener(function(){t.attacking=!1,t.spine.setCompleteListener(null),t.animationController.externalControl=!1})}this.isDashing&&(this.dashTimeLeft=Math.min(this.dashTimeLeft,this.dashMinTime),this.dashCooldownTimeLeft=p.UpgradesConfig.dashCooldownTime)},t.prototype.onBeginContact=function(e,t,i){var n=t.getAABB(),o=i.getAABB();if(t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.PLATFORM){var a=o.yMax-n.yMin;if(this.moveVelocity.y>0)return e.disabled=!0,void++this.groundContacts;if(a>.5*h.default.TILE_SIZE.height)return e.disabled=!0,void++this.groundContacts;var l=i.node.getComponent(d.default);l&&l.onTouched()}var f=e.getWorldManifold().normal;if(t.tag==h.ColliderTag.PLAYER_BODY&&(i.tag==h.ColliderTag.TERRAIN||i.tag==h.ColliderTag.PLATFORM)&&(++this.groundContacts,f.fuzzyEquals(cc.v2(0,-1),.1)&&((!this.groundCollider||n.center.x>o.xMin&&n.center.x<o.xMax)&&(this.groundCollider=i),this.grounded=!0,this.jumping=!1,this.falling=!1,r.default.getInstance().audioManager.endSlideWall(),this.wallGrabbing=!1,this.aerialAttackPerformed=!1,this.moveVelocity.y=0,this.body.linearVelocity=this.moveVelocity,this.lostMoveControlTimeLeft=0,this.lostJumpControlTimeLeft=0,this.jumpInertiaDirection=s.Direction.NONE),(f.fuzzyEquals(cc.v2(1,0),.1)||f.fuzzyEquals(cc.v2(-1,0),.1))&&this.groundCollider&&this.groundCollider!=i)){var m=this.groundCollider.getAABB();o.yMax==m.yMax&&n.center.x>m.xMin&&n.center.x<m.xMax&&(e.disabledOnce=!0)}t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.TERRAIN&&f.fuzzyEquals(cc.v2(0,1),.1)&&(this.moveVelocity.y=0,this.jumping&&(this.shortJump=!0));var g=i.getComponent(u.default);if(t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.ENEMY_ATTACK_AREA&&!this.isImmune&&g){this.updateHealth(-g.attackDamage,this.generalImmuneTime);var y=s.directionToAngle(g.attackDirection);if(y)this.applyKnockback(s.polarToCartesianVector(y,1)),console.info("enemy attack received! hit angle: "+y);else{var v=t.getAABB().center.sub(i.getAABB().center).normalize();(C=cc.v2(v)).y<this.knockbackLiftThreshold&&(C.y=0,C.normalizeSelf()),this.applyKnockback(C),console.info("enemy attack received! hit dir: "+v+" knock dir: "+C)}h.default.instance.setTimeScale(1e-4,.1),h.default.instance.shakeCamera(h.CameraShakeLevel.LOW)}if(t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.ENEMY_BODY&&g&&(this.beignTouchedByEnemy=g),t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.ENEMY_BODY&&!this.isImmune&&g){this.updateHealth(-g.touchDamage,this.generalImmuneTime),"Spikes"===g.node.name?r.default.getInstance().audioManager.playSfx(c.SFXKey.obstacle_spines):"FlyingChaserEnemy"===g.node.name?r.default.getInstance().audioManager.playSfx(c.SFXKey.enemy_bee2):"PatrollingEnemy"===g.node.name?r.default.getInstance().audioManager.playSfx(c.SFXKey.enemy_worm):"StaticPassiveEnemy"===g.node.name&&r.default.getInstance().audioManager.playSfx(c.SFXKey.enemy_slime);var C;v=t.getAABB().center.sub(i.getAABB().center).normalize();(C=cc.v2(v)).y<this.knockbackLiftThreshold&&(C.y=0,C.normalizeSelf()),this.applyKnockback(C),console.info("touched by an enemy! hit dir: "+v+" knock dir: "+C),p.PlayerConfig.hitStopTime>0&&h.default.instance.setTimeScale(.01,p.PlayerConfig.hitStopTime),h.default.instance.shakeCamera(h.CameraShakeLevel.LOW)}t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.MUD_AREA&&(this.waterSurfacePosition=o.yMax-4,h.default.instance.spawnPuff(cc.v2(this.node.position.x,this.waterSurfacePosition),h.PuffType.WATER_SPLASH),++this.mudContacts),t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.POISON_AREA&&(this.waterSurfacePosition=o.yMax-4,h.default.instance.spawnPuff(cc.v2(this.node.position.x,this.waterSurfacePosition),h.PuffType.POISON_SPLASH),++this.poisonContacts),t.tag==h.ColliderTag.PLAYER_LEFT_GRAB&&i.tag==h.ColliderTag.TERRAIN&&++this.leftWallContacts,t.tag==h.ColliderTag.PLAYER_RIGHT_GRAB&&i.tag==h.ColliderTag.TERRAIN&&++this.rightWallContacts,t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.ICE_AREA&&++this.iceContacts},t.prototype.onEndContact=function(e,t,i){e.getWorldManifold().normal;t.tag!=h.ColliderTag.PLAYER_BODY||i.tag!=h.ColliderTag.TERRAIN&&i.tag!=h.ColliderTag.PLATFORM||(--this.groundContacts,this.groundCollider==i&&(this.groundCollider=null)),this.groundContacts<=0&&(this.groundContacts=0,this.grounded=!1,this.groundCollider=null),t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.ENEMY_BODY&&this.beignTouchedByEnemy==i.getComponent(u.default)&&(this.beignTouchedByEnemy=null),t.tag==h.ColliderTag.PLAYER_LEFT_GRAB&&i.tag==h.ColliderTag.TERRAIN&&--this.leftWallContacts,t.tag==h.ColliderTag.PLAYER_RIGHT_GRAB&&i.tag==h.ColliderTag.TERRAIN&&--this.rightWallContacts,t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.ICE_AREA&&--this.iceContacts,t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.MUD_AREA&&--this.mudContacts,t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.POISON_AREA&&--this.poisonContacts},t.prototype.onPreSolve=function(e,t,i){if(!i.sensor&&!e.disabled){var n=t.getAABB(),o=i.getAABB(),a=e.getWorldManifold().normal;if(t.tag==h.ColliderTag.PLAYER_BODY&&(i.tag==h.ColliderTag.TERRAIN||i.tag==h.ColliderTag.PLATFORM)&&(a.fuzzyEquals(cc.v2(0,-1),.1)&&(!this.groundCollider||n.center.x>o.xMin&&n.center.x<o.xMax&&this.groundCollider!=i)&&(this.groundCollider=i),(a.fuzzyEquals(cc.v2(1,0),.1)||a.fuzzyEquals(cc.v2(-1,0),.1))&&this.groundCollider&&this.groundCollider!=i)){var s=this.groundCollider.getAABB();if(s.yMax==o.yMax&&n.center.x>s.xMin&&n.center.x<s.xMax)return void(e.disabledOnce=!0)}if(t.tag!=h.ColliderTag.PLAYER_BODY||i.tag!=h.ColliderTag.PLATFORM){if(t.tag==h.ColliderTag.PLAYER_BODY&&i.tag==h.ColliderTag.TERRAIN&&!this.grounded){var r=this._body.linearVelocity;o.xMax-n.xMin<2?(this.resolveCornerCollisionOffset.x=.5,r.x<10&&(r.x=10,this._body.linearVelocity=r),e.disabledOnce=!0):n.xMax-o.xMin<2&&(this.resolveCornerCollisionOffset.x=-.5,r.x>-10&&(r.x=-10,this._body.linearVelocity=r),e.disabledOnce=!0)}}else 0!=e.getWorldManifold().normal.x&&(e.disabled=!0)}},t.prototype.onPostSolve=function(e,t,i){},t.prototype.setLeft=function(){this.node.children[0].scaleX=1},t.prototype.setRight=function(){this.node.children[0].scaleX=-1},t.prototype.spawn=function(){this.lifeBarNode=cc.find("Canvas/UI/Game/life_bar"),this.lifeIconNode=cc.find("Canvas/UI/Game/life_icon"),this.lifeBarExtraNode=cc.find("Canvas/UI/Game/extra_life/extra_life_bar_container/extra_life_bar"),this.lifeBarWidth=this.lifeBarNode.width,this.lifeBarExtraWidth=this.lifeBarExtraNode.width,this.isSpawn=!0,this.node.opacity=255,this.jumping=!1,this.jumpAnimCompleted=!0,this.isFrozen=!0,this.updateLifeBar(!0)},t.prototype.gameOver=function(){this.node.emit("gameOver")},t.prototype.doIntroAnimation=function(e){var t=this;void 0===e&&(e=null),this.moveVelocity=cc.v2(0,0),this.moveDirection=s.Direction.NONE,this.isFrozen=!0,this.animationController.externalControl=!0,this.spine.setAnimation(0,"intro",!1),r.default.getInstance().audioManager.playSfx(c.SFXKey.character_level_in),this.spine.setCompleteListener(function(){t.spine.setCompleteListener(null),t.animationController.externalControl=!1,e&&e()})},t.prototype.doVictoryAnimation=function(){this.moveVelocity=cc.v2(0,0),this.moveDirection=s.Direction.NONE,this.animationController.externalControl=!0,this.spine.setAnimation(0,"IN_victory",!1),this.spine.addAnimation(0,"LOOP_victory",!0),this.spine.setCompleteListener(null)},t.prototype.doDefeatAnimation=function(){this.moveVelocity=cc.v2(0,0),this.moveDirection=s.Direction.NONE,this.isFrozen=!0;var e=Math.random()<.5?"":"2";this.animationController.externalControl=!0,this.spine.setAnimation(0,"IN_defeat"+e,!1),this.spine.addAnimation(0,"LOOP_defeat"+e,!0),this.spine.setCompleteListener(null),h.default.instance.isBossStage||r.default.getInstance().audioManager.playSfx(c.SFXKey.character_lose)},t.prototype.doParryAnimation=function(){var e=this;this.attacking=!1,this.animationController.externalControl=!0,this.spine.setAnimation(0,"parry",!1),this.spine.setCompleteListener(function(){e.spine.setCompleteListener(null),e.animationController.externalControl=!1})},t.prototype.doIdleAtentionAnimation=function(){var e=this;this.playingIdleAtentionAnimation||(this.playingIdleAtentionAnimation=!0,this.animationController.externalControl=!0,this.spine.setAnimation(0,"random_1",!1),this.spine.setCompleteListener(function(){e.spine.setCompleteListener(null),e.animationController.externalControl=!1,e.playingIdleAtentionAnimation=!1,e.idleAtentionTimeLeft=e.idleAtentionTime}),this.sfxRandomID=r.default.getInstance().audioManager.playSfx(c.SFXKey.character_random))},t.prototype.resetIdleAtentionState=function(){this.idleAtentionTimeLeft=this.idleAtentionTime,this.playingIdleAtentionAnimation&&(this.playingIdleAtentionAnimation=!1,this.spine.setCompleteListener(null),this.animationController.externalControl=!1,-1!==this.sfxRandomID&&r.default.getInstance().audioManager.stopSfx(this.sfxRandomID))},t.prototype.autoMoveBy=function(e,t){e>=0?(this.moveDirection=s.Direction.RIGHT,this.facingDirection=s.Direction.RIGHT,this.moveToCoord=this.node.position.x+e,this.moveToCallback=t):(this.moveDirection=s.Direction.LEFT,this.facingDirection=s.Direction.LEFT,this.moveToCoord=this.node.position.x+e,this.moveToCallback=t)},t.prototype.onPause=function(){e.prototype.onPause.call(this),this._spine.paused=!0},t.prototype.onResume=function(){e.prototype.onResume.call(this),this._spine.paused=!1},t.prototype.updateHealth=function(e,t){if(e>=0)this.health+=e,this.health>=this.maxHealth&&(this.health=this.maxHealth),this.immuneTimeLeft=Math.max(this.immuneTimeLeft,t),this.updateLifeBar();else{if(this.isImmune)return;this.health+=e,r.default.getInstance().audioManager.playSfx(c.SFXKey.character_damage),this.health<=0?(this.health=0,this.inputController.disableInput(),this.doDefeatAnimation(),h.default.instance.getPlayer().isActive=!1,this.scheduleOnce(function(){return h.default.instance.levelComplete()},3),this.immuneTimeLeft=10,this.flashinTimeLeft=0,cc.systemEvent.emit("player-defeated")):(this.immuneTimeLeft=Math.max(this.immuneTimeLeft,t),this.flashinTimeLeft=Math.max(this.immuneTimeLeft,t)),this.updateLifeBar()}},t.prototype.updateLifeBar=function(e){void 0===e&&(e=!1);var t=1,i=0;if(f.default.instance.howToLifeUnlocked?this.health>p.PlayerConfig.maxHealth?i=(this.health-p.PlayerConfig.maxHealth)/(this.maxHealth-p.PlayerConfig.maxHealth):t=this.health/p.PlayerConfig.maxHealth:t=this.health/this.maxHealth,e)this.lifeBarNode.width=this.lifeBarWidth*t,this.lifeBarExtraNode.width=this.lifeBarExtraWidth*i;else{var n=this.lifeBarWidth*t,o=this.lifeBarExtraWidth*i;this.lifeBarNode.width!==n&&this.lifeBarExtraNode.width!==o?(cc.tween(this.lifeBarNode).to(.2,{width:n}).start(),cc.tween(this.lifeBarExtraNode).delay(.2).to(.2,{width:o}).start()):this.lifeBarNode.width!==n?cc.tween(this.lifeBarNode).to(.4,{width:n}).start():cc.tween(this.lifeBarExtraNode).to(.4,{width:o}).start()}this.health/this.maxHealth>.5?this.lifeIconNode.getComponent(cc.Sprite).spriteFrame=this.lifeIconHigh:this.health/this.maxHealth>.25?this.lifeIconNode.getComponent(cc.Sprite).spriteFrame=this.lifeIconMedium:this.lifeIconNode.getComponent(cc.Sprite).spriteFrame=this.lifeIconLow},t.groundGravityScale=0,o([C(cc.SpriteFrame)],t.prototype,"lifeIconHigh",void 0),o([C(cc.SpriteFrame)],t.prototype,"lifeIconMedium",void 0),o([C(cc.SpriteFrame)],t.prototype,"lifeIconLow",void 0),t=i=o([v],t)}(l.default);i.default=_,cc._RF.pop()},{"../../Testing/TesterLevelData":"TesterLevelData","../../core/Singleton":"Singleton","../../core/Utils":"Utils","../../core/audio/AudioScene":"AudioScene","../Config":"Config","../DoesDamage":"DoesDamage","../Game":"Game","../PausableComponent":"PausableComponent","../Projectile":"Projectile","../TrapPlatform":"TrapPlatform","../UpgradesManager":"UpgradesManager","./CharacterAnimationController":"CharacterAnimationController"}],CheatManager:[function(e,t,i){"use strict";cc._RF.push(t,"33202iR5h5O+r9xD8Azsoh6","CheatManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Singleton"),o=function(){function e(){e.cheatEnabled&&this.initInput()}return Object.defineProperty(e,"instances",{get:function(){return e._instances||(e._instances=new e),e._instances},enumerable:!0,configurable:!0}),e.prototype.initCheatMainMenu=function(){this.currentScene="mainmenu"},e.prototype.endCheat=function(){this.currentScene=""},e.prototype.initInput=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onInputDown,this)},e.prototype.onInputDown=function(e){if("mainmenu"===this.currentScene)switch(e.keyCode){case cc.macro.KEY[1]:this.cheatMoney()}},e.prototype.cheatMoney=function(){console.log("[Cheat]: Money");var e=n.default.getInstance().dataManager.getCookies();n.default.getInstance().dataManager.setCookies(e+500)},e._instances=null,e.cheatEnabled=!1,e}();i.default=o,cc._RF.pop()},{"./Singleton":"Singleton"}],Collectable:[function(e,t,i){"use strict";cc._RF.push(t,"46ff5ReIClKjI0kDm2DhyoW","Collectable");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./Game"),r=e("./Config"),c=e("./UpgradesManager"),l=e("../core/Singleton"),h=e("../core/audio/AudioScene"),u=e("./PausableComponent"),p=cc._decorator,d=p.ccclass,f=p.property;(function(e){e[e.COOKIE=0]="COOKIE",e[e.COOKIE_BATCH=1]="COOKIE_BATCH",e[e.AMMO_BATCH=2]="AMMO_BATCH",e[e.HEART=3]="HEART"})(a=i.CollectableType||(i.CollectableType={}));var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=a.COOKIE,t.rigidBody=null,t.spriteNode=null,t.sprite=null,t.throwAngle=0,t.throwSpeed=0,t.gravityScale=1,t.bouncesCount=0,t._canBeCollected=!1,t.fadingOut=!1,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){var n=this;if(i.tag==s.ColliderTag.TERRAIN||i.tag==s.ColliderTag.PLATFORM){if(++this.bouncesCount,2==this.bouncesCount&&(this._canBeCollected=!0),3==this.bouncesCount){var o=this.getComponent(cc.PhysicsBoxCollider);o.restitution=0,o.apply(),this._canBeCollected=!0}}else i.tag==s.ColliderTag.POISON_AREA?(this.sprite.setMaterial(0,s.default.instance.spriteOverlayColorMaterial),this.sprite.scheduleOnce(function(){n.node.destroy()},.2)):i.tag==s.ColliderTag.PLAYER_BODY&&this._canBeCollected?(e.disabled=!0,s.default.instance.getPlayer().getHealth()>0&&this.collect()):e.disabled=!0},t.prototype.canBeCollected=function(){return this._canBeCollected},t.prototype.collect=function(){var e=this;switch(this.type){case a.COOKIE:l.default.getInstance().audioManager.playSfxCoin(),c.default.instance.cookiesCount+=1;break;case a.COOKIE_BATCH:l.default.getInstance().audioManager.playSfxCoin(),c.default.instance.cookiesCount+=r.CollectablesConfig.cookieBatchIncreaseAmount;break;case a.AMMO_BATCH:c.default.instance.ammoCount+=r.CollectablesConfig.ammoIncreaseAmount;break;case a.HEART:s.default.instance.getPlayer().updateHealth(r.CollectablesConfig.heartHealthAmount,0),l.default.getInstance().audioManager.playSfx(h.SFXKey.heart)}this._canBeCollected=!1,this.sprite.setMaterial(0,s.default.instance.spriteOverlayColorMaterial),this.sprite.scheduleOnce(function(){e.node.destroy()},.2),s.default.instance.updateUI()},t.prototype.fadeOut=function(){var e=this;this.fadingOut||(this.fadingOut=!0,cc.tween(this.spriteNode).to(.3,{opacity:63},{easing:"sineInOut"}).to(.3,{opacity:255},{easing:"sineInOut"}).delay(.1).to(.2,{opacity:63},{easing:"sineInOut"}).to(.2,{opacity:255},{easing:"sineInOut"}).delay(.1).to(.1,{opacity:63},{easing:"sineInOut"}).to(.1,{opacity:255},{easing:"sineInOut"}).delay(.1).to(.05,{opacity:63},{easing:"sineInOut"}).to(.05,{opacity:255},{easing:"sineInOut"}).delay(.1).to(.05,{opacity:0},{easing:"sineInOut"}).call(function(){return e.node.destroy()}).start())},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.spriteNode.pauseAllActions()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.spriteNode.resumeAllActions()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){var e=this;this.rigidBody=this.getComponent(cc.RigidBody),this.spriteNode=this.node.getChildByName("sprite"),this.sprite=this.spriteNode.getComponent(cc.Sprite);var t=this.throwSpeed*Math.cos(this.throwAngle),i=this.throwSpeed*Math.sin(this.throwAngle);this.rigidBody.gravityScale=this.gravityScale,this.rigidBody.linearVelocity=cc.v2(t,i),r.CollectablesConfig.fadeOutTime>0&&this.scheduleOnce(function(){return e.fadeOut()},r.CollectablesConfig.fadeOutTime)},o([f({type:cc.Enum(a)})],t.prototype,"type",void 0),t=o([d],t)}(u.default);i.default=m,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/audio/AudioScene":"AudioScene","./Config":"Config","./Game":"Game","./PausableComponent":"PausableComponent","./UpgradesManager":"UpgradesManager"}],ComicController:[function(e,t,i){"use strict";cc._RF.push(t,"b628eoUeI9MtL0W6+OyylvK","ComicController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../game/controllers/TransitionController"),s=e("../core/Singleton"),r=e("../core/audio/AudioScene"),c=cc._decorator,l=c.ccclass,h=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transitionPrefab=null,t.comicIntro=!0,t.comicEnd=!1,t}return n(t,e),t.prototype.onLoad=function(){this.canvas=cc.find("Canvas"),this.transitionNode=cc.instantiate(this.transitionPrefab),this.transitionController=this.transitionNode.getComponent(a.default),this.canvas.addChild(this.transitionNode),this.transitionNode.active=!0},t.prototype.start=function(){this.instance=s.default.getInstance(),this.comicIntro=this.instance.dataManager.getSeeComicIntro(),this.comicEnd=this.instance.dataManager.getSeeComicEnd(),this.getElementsUI(),this.transitionController&&this.transitionController.hideTransition(this.checkComic.bind(this))},t.prototype.getElementsUI=function(){this.introNode=cc.find("Canvas/node_intro"),this.outroNode=cc.find("Canvas/node_outro"),this.introButtonNodeYes=cc.find("Canvas/node_intro/node_yes"),this.outroButtonNodeYes=cc.find("Canvas/node_outro/node_yes"),this.introSceneNodes=[],this.outroSceneNodes=[];for(var e=0;e<6;e++)this.introSceneNodes[e]=cc.find("Canvas/node_intro/c"+(e+1)),this.outroSceneNodes[e]=cc.find("Canvas/node_outro/c"+(e+1));this.introNode.active=!1===this.comicIntro,this.outroNode.active=!0===this.comicIntro&&!1===this.comicEnd},t.prototype.checkComic=function(){!1===this.comicIntro?(this.instance.dataManager.seeComicIntro(),this.currentIndexScene=0,this.currentSceneNodes=this.introSceneNodes,this.currentButton=this.introButtonNodeYes,this.isIntro=!0,this.playSceneComicIn()):!1===this.comicEnd&&(this.instance.dataManager.seeComicEnd(),this.currentIndexScene=0,this.currentSceneNodes=this.outroSceneNodes,this.currentButton=this.outroButtonNodeYes,this.isIntro=!1,this.playSceneComicIn())},t.prototype.playSceneComicIn=function(){var e=this.isIntro?"IN_c"+(this.currentIndexScene+1):"IN_c"+(this.currentIndexScene+1)+"_outro",t=this.currentSceneNodes[this.currentIndexScene].getComponent(cc.Animation);s.default.getInstance().audioManager.playSfx(r.SFXKey.comic),t.play(e,0),t.once("finished",this.playSceneComicLoop,this)},t.prototype.playSceneComicLoop=function(){var e=this.isIntro?"LOOP_c"+(this.currentIndexScene+1):"LOOP_c"+(this.currentIndexScene+1)+"_outro",t=this.isIntro&&2===this.currentIndexScene?.5:1;this.currentSceneNodes[this.currentIndexScene].getComponent(cc.Animation).play(e,0);this.scheduleOnce(this.playSceneComicOut,t)},t.prototype.playSceneComicOut=function(){this.currentIndexScene++,this.currentIndexScene<this.currentSceneNodes.length?this.playSceneComicIn():this.currentButton.getComponent(cc.Animation).play("IN_yes")},t.prototype.nextScene=function(){var e;s.default.getInstance().audioManager.playSfx(r.SFXKey.button_generic),this.currentButton.children[0].getComponent(cc.Button).interactable=!1;for(var t=0;t<6;t++)(e=this.currentSceneNodes[t].getComponent(cc.Animation)).stop();this.isIntro?((e=this.introNode.getComponent(cc.Animation)).play("OUT_intro"),e.once("finished",this.nextSceneStep2,this)):((e=this.outroNode.getComponent(cc.Animation)).play("OUT_outro"),e.once("finished",this.nextSceneStep2,this))},t.prototype.nextSceneStep2=function(){this.changeSceneTransition("level_select")},t.prototype.changeSceneTransition=function(e){this.transitionNode?this.showTransition(function(){cc.director.loadScene(e)}):cc.director.loadScene(e)},t.prototype.showTransition=function(e){this.transitionController.showTransition(e.bind(this))},o([h(cc.Prefab)],t.prototype,"transitionPrefab",void 0),t=o([l],t)}(cc.Component);i.default=u,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/audio/AudioScene":"AudioScene","../game/controllers/TransitionController":"TransitionController"}],Config:[function(e,t,i){"use strict";cc._RF.push(t,"16ed7QR2ktNzoat15m/VbJG","Config");var n=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,a=o.ccclass,s=(o.property,function(){function e(){}return e.maxHealth=100,e.maxAmmo=10,e.gravityMagnitude=50,e.maxHorizontalSpeed=10,e.maxVerticalSpeed=30,e.moveAccelerationTime=.3,e.groundFrictionTime=.15,e.airFrictionTime=.5,e.iceFrictionTime=3,e.mudMaxMoveSpeed=4,e.poisonMaxMoveSpeed=5,e.poisonDamage=10,e.poisonImmuneTime=2,e.maxWallSlideFallSpeed=4,e.wallSlideFallAccelerationTime=2,e.wallGrabLostMoveControlTime=.2,e.wallJumpLostMoveControlTime=0,e.wallJumpKeepInertiaMaxTime=.3,e.jumpMaxPeakHeight=4.5,e.jumpMinPeakHeight=2,e.shortJumpInertiaFactor=.5,e.simpleAttackDamage=10,e.simpleAttackCooldownTime=.5,e.generalImmuneTime=1.5,e.immuneFlashingCycleTime=.3,e.knockbackLostMoveControlTime=.5,e.knockbackLostJumpControlTime=.5,e.knockbackImpulseSpeed=15,e.knockbackFrictionFactor=.5,e.knockbackLiftThreshold=0,e.hitStopTime=.1,e.alternativeAerialAttackControls=!0,e=n([a],e)}());i.PlayerConfig=s;var r=function(){function e(){}return e.damageWhiteFlashTime=.2,e}();i.CommonEnemiesConfig=r;var c=function(){function e(){}return e.health=20,e.touchDamage=10,e.cookiesSpawnCount=4,e}();i.GreenStaticPassiveEnemyConfig=c;var l=function(){function e(){}return e.health=30,e.touchDamage=10,e.cookiesSpawnCount=6,e}();i.PinkStaticPassiveEnemyConfig=l;var h=function(){function e(){}return e.health=30,e.touchDamage=10,e.attackDamage=20,e.cookiesSpawnCount=8,e.attackAreaRadius=200,e.attackBuildTime=2,e.attackDamageTime=.5,e.attackCooldownTime=5.57,e}();i.GreenStaticAgressiveEnemyConfig=h;var u=function(){function e(){}return e.health=40,e.touchDamage=15,e.attackDamage=30,e.cookiesSpawnCount=12,e.attackAreaRadius=200,e.attackBuildTime=1.5,e.attackDamageTime=.5,e.attackCooldownTime=4.2,e}();i.PinkStaticAgressiveEnemyConfig=u;var p=function(){function e(){}return e.health=30,e.touchDamage=10,e.cookiesSpawnCount=10,e.projectileSpeed=15,e.projectileAngle=30,e.projectileGravityScale=1,e.attackDamage=15,e.attackCooldownTime=2,e}();i.GreenStaticMortarEnemyConfig=p;var d=function(){function e(){}return e.health=40,e.touchDamage=15,e.cookiesSpawnCount=15,e.projectileSpeed=15,e.projectileAngle=30,e.projectileGravityScale=1,e.attackDamage=20,e.attackCooldownTime=5,e}();i.PinkStaticMortarEnemyConfig=d;var f=function(){function e(){}return e.health=20,e.touchDamage=10,e.cookiesSpawnCount=4,e.maxMoveSpeed=3,e.moveAccelerationTime=.2,e.knockbackSpeed=5,e.knockbackFrictionTime=.5,e.stunnedTime=.5,e}();i.GreenPatrollingPassiveEnemyConfig=f;var m=function(){function e(){}return e.health=30,e.touchDamage=20,e.cookiesSpawnCount=10,e.maxMoveSpeed=4,e.moveAccelerationTime=.2,e.knockbackSpeed=4,e.knockbackFrictionTime=.5,e.stunnedTime=.5,e}();i.PinkPatrollingPassiveEnemyConfig=m;var g=function(){function e(){}return e.health=30,e.touchDamage=10,e.cookiesSpawnCount=8,e.jumpHeight=3,e.jumpDistance=4,e.gravityFactor=1,e.groundDelayTime=1,e}();i.GreenPatrollingJumperEnemyConfig=g;var y=function(){function e(){}return e.health=40,e.touchDamage=20,e.cookiesSpawnCount=14,e.jumpHeight=3,e.jumpDistance=4,e.gravityFactor=1,e.groundDelayTime=1,e}();i.PinkPatrollingJumperEnemyConfig=y;var v=function(){function e(){}return e.health=40,e.touchDamage=15,e.cookiesSpawnCount=20,e.maxWalkSpeed=4,e.maxRunSpeed=8,e.moveAccelerationTime=.2,e.detectionDistance=6,e.persuitDistance=15,e.nearDistance=2.5,e.persuitMoveExtensionDistance=3,e.attackDamage=20,e.attackBuildTime=.96,e.attackDamageTime=1,e}();i.GreenPatrollingAgressiveEnemyConfig=v;var C=function(){function e(){}return e.health=50,e.touchDamage=15,e.cookiesSpawnCount=25,e.maxWalkSpeed=5,e.maxRunSpeed=9,e.moveAccelerationTime=.2,e.detectionDistance=6,e.persuitDistance=15,e.nearDistance=2.5,e.persuitMoveExtensionDistance=5,e.attackDamage=30,e.attackBuildTime=.96,e.attackDamageTime=1,e}();i.PinkPatrollingAgressiveEnemyConfig=C;var _=function(){function e(){}return e.health=20,e.touchDamage=10,e.cookiesSpawnCount=14,e.maxMoveSpeed=5,e.moveAccelerationTime=.1,e.horizontalDetectionRange=.5,e.verticalDetectionRange=20,e.projectileGravityScale=.4,e.attackDamage=15,e.attackCooldownTime=1,e}();i.GreenFlyingBomberEnemyConfig=_;var b=function(){function e(){}return e.health=30,e.touchDamage=15,e.cookiesSpawnCount=18,e.maxMoveSpeed=7,e.moveAccelerationTime=.1,e.horizontalDetectionRange=.5,e.verticalDetectionRange=20,e.projectileGravityScale=.4,e.attackDamage=20,e.attackCooldownTime=.6,e}();i.PinkFlyingBomberEnemyConfig=b;var S=function(){function e(){}return e.health=20,e.touchDamage=10,e.cookiesSpawnCount=10,e.maxMoveSpeed=3,e.moveAccelerationTime=.5,e.detectionRange=10,e.nearPositioningRange=5,e.enableTerrainCollisions=!1,e.knockbackSpeed=5,e.knockbackFrictionTime=.5,e.stunnedTime=.5,e}();i.GreenFlyingChaserEnemyConfig=S;var T=function(){function e(){}return e.health=30,e.touchDamage=15,e.cookiesSpawnCount=15,e.maxMoveSpeed=5,e.moveAccelerationTime=.5,e.detectionRange=10,e.nearPositioningRange=5,e.enableTerrainCollisions=!1,e.knockbackSpeed=5,e.knockbackFrictionTime=.5,e.stunnedTime=.5,e}();i.PinkFlyingChaserEnemyConfig=T;var E=function(){function e(){}return e.touchDamage=10,e}();i.SpikesConfig=E;var P=function(){function e(){}return e.activeTime=3,e.inactiveTime=3,e.touchDamage=10,e}();i.FlamesConfig=P;var L=function(){function e(){}return e.projectileDamage=20,e.projectileSpeed=10,e.cooldownTime=3,e}();i.TurretConfig=L;var A=function(){function e(){}return e.activeTime=1,e.inactiveTime=1,e}();i.GreenTrapPlatformConfig=A;var I=function(){function e(){}return e.activeTime=.5,e.inactiveTime=1,e}();i.PinkTrapPlatformConfig=I;var k=function(){function e(){}return e.health=10,e.cookiesSpawnCount=25,e}();i.SmallCrateConfig=k;var M=function(){function e(){}return e.health=20,e.cookiesSpawnCount=35,e}();i.MediumCrateConfig=M;var D=function(){function e(){}return e.health=30,e.cookiesSpawnCount=50,e}();i.BigCrateConfig=D;var O=function(){function e(){}return e.health=30,e}();i.GreenBarrierConfig=O;var R=function(){function e(){}return e.health=50,e}();i.PinkBarrierConfig=R;var N=function(){function e(){}return e.fadeOutTime=7,e.maxSingleCookiesToSpawn=5,e.cookieBatchIncreaseAmount=5,e.heartSpawnMinPlayerHealthFactor=.75,e.heartSpawnProbability=.8,e.heartHealthAmount=30,e.ammoSpawnMinAmmoFactor=1,e.ammoSpawnProbability=.5,e.ammoIncreaseAmount=1,e}();i.CollectablesConfig=N;var w=function(){function e(){}return e.aerialSlashUnlockCost=400,e.rapidSlashUnlockCost=150,e.parryUnlockCost=450,e.howToLifeUnlockCost=600,e.willykatWillykitUnlockCost=700,e.panthroUnlockCost=1e3,e.tygraUnlockCost=600,e.cheetharaUnlockCost=1e3,e.secondAttackDamage=10,e.thirdAttackDamage=15,e.extendedLifeHealth=150,e.rangeAttackDamage=20,e.rangeAttackMaxProjectiles=10,e.rangeAttackProjectileSpeed=25,e.rangeAttackProjectileAngle=0,e.rangeAttackProjectileGravityScale=1,e.strongAttackChargeTime=1,e.strongAttackDamage=80,e.dashMoveSpeed=25,e.dashMinDistance=5,e.dashMaxDistance=15,e.dashCooldownTime=1,e}();i.UpgradesConfig=w;var x=function(){function e(){}return e.verticalOffsetFactor=.45,e.lowScreenShakeMagnitude=4,e.lowScreenShakeDuration=.2,e.lowScreenShakeBumpsCount=2,e.mediumScreenShakeMagnitude=6,e.mediumScreenShakeDuration=.2,e.mediumScreenShakeBumpsCount=3,e.highScreenShakeMagnitude=10,e.highScreenShakeDuration=.3,e.highScreenShakeBumpsCount=4,e}();i.CameraConfig=x;var F=function(){function e(){}return e.shipHealth=300,e.shipRefuelTime=3,e.cookiesSpawnCount=70,e.missileDamage=20,e.missileLanesCount=6,e.missileLaneWidth=5,e.easyAttacksCount=3,e.easyAttacksCooldownTime=1.5,e.hardAttacksCount=3,e.hardAttacksCooldownTime=.8,e.enemySpawnsCount=0,e.easyMissilesSequenceDelay=.8,e.easyMissilePatterns=["2 4 6","1 3 5","2 5","1 4","1 2 5","3 4 6","3 6"],e.hardMissilesSequenceDelay=.7,e.hardMissilePatterns=["1 2 5","3 4 6","1 6 2 5 3","3 41 25 6","1 2 5 63 4","1 6 53 4","16 25 34"],e}();i.FirstBossShipConfig=F;var B=function(){function e(){}return e.shipHealth=500,e.shipRefuelTime=3,e.cookiesSpawnCount=70,e.missileDamage=20,e.missileLanesCount=6,e.missileLaneWidth=5,e.plasmaDamage=20,e.plasmaSpeed=10,e.plasmaLanesCount=3,e.plasmaLaneHeight=2,e.easyAttacksCount=3,e.easyAttacksCooldownTime=1.5,e.hardAttacksCount=6,e.hardAttacksCooldownTime=.8,e.enemySpawnsCount=2,e.easyMissilesSequenceDelay=.8,e.easyMissilePatterns=["2 4 6","1 3 5","2 5","1 4","3 6","1 2 3","6 5 4"],e.hardMissilesSequenceDelay=.7,e.hardMissilePatterns=["1 5 2 1 3","6 4 25 31","1 2","5 6","34 1 2","1 2 5 6","1 62 53 4","16 25 34"],e.plasmaSequenceDelay=1.3,e.plasmaPatterns=["1 3 2","1 2","3 2","3 2 1","32","12"],e}();i.SecondBossShipConfig=B;var U=function(){function e(){}return e.health=800,e.restTime=1,e.stunTime=3,e.punchDamage=20,e.punchLanesCount=4,e.punchLaneWidth=9,e.enemySpawnsCount=3,e.cookiesSpawnCount=70,e.easyPunchChargeTime=1.5,e.easyPunchAttackTime=2,e.easyPunchCooldownTime=1,e.hardPunchChargeTime=1.5,e.hardSinglePunchAttackTime=1,e.hardDoublePunchAttackTime=1.5,e.hardPunchCooldownTime=.5,e.hardPunchesSequenceDelay=.5,e.hardPunchPatterns=["1 2 3 23","4 1 2 41","3 2 1 13","4 2 3 24"],e}();i.FinalBossConfig=U,cc._RF.pop()},{}],ConfirmationController:[function(e,t,i){"use strict";cc._RF.push(t,"276928I/0RNpbCkSAJSpDNk","ConfirmationController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../core/Singleton"),s=e("../core/audio/AudioScene"),r=e("../core/Utils"),c=cc._decorator.ccclass,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var i;return n(t,e),i=t,t.prototype.onLoad=function(){this.description=cc.find("confirmation_container/base/description",this.node).getComponent(cc.Label),this.animation=cc.find("confirmation_container",this.node).getComponent(cc.Animation),this.buttonYes=cc.find("confirmation_container/base/yes",this.node).getComponent(cc.Button),this.buttonNo=cc.find("confirmation_container/base/no",this.node).getComponent(cc.Button),this.description.string=a.default.getInstance().getLocalizationString("confirmation_title"),r.fixBigFontLabelLocalization(this.description),"ar"===a.default.getInstance().localizationManager.locale&&(this.description.fontSize=28,this.description.node.x=-22);for(var e=0,t=this.node.children.length;e<t;e++)this.node.children[e].active=!1},t.prototype.show=function(){a.default.getInstance().audioManager.playSfx(s.SFXKey.popup_confirmation),this.disableButtons();for(var e=0,t=this.node.children.length;e<t;e++)this.node.children[e].active=!0;this.animation.play("IN_confirmation"),this.animation.on("finished",this.showStep2,this)},t.prototype.showStep2=function(){this.enableButtons(),this.animation.off("finished",this.showStep2,this)},t.prototype.hide=function(){this.disableButtons(),this.animation.play("OUT_confirmation"),this.animation.on("finished",this.hideStep2,this)},t.prototype.hideStep2=function(){this.animation.off("finished",this.hideStep2,this);for(var e=0,t=this.node.children.length;e<t;e++)this.node.children[e].active=!1},t.prototype.disableButtons=function(){this.buttonNo.interactable=!1,this.buttonYes.interactable=!1},t.prototype.enableButtons=function(){this.buttonNo.interactable=!0,this.buttonYes.interactable=!0},t.prototype.pressYes=function(){a.default.getInstance().audioManager.playSfx(s.SFXKey.button_generic),this.node.emit(i.KEY_SIGNAL_YES)},t.prototype.pressNo=function(){a.default.getInstance().audioManager.playSfx(s.SFXKey.button_back),this.hide(),this.node.emit(i.KEY_SIGNAL_NO)},t.KEY_SIGNAL_YES="yes",t.KEY_SIGNAL_NO="no",t=i=o([c],t)}(cc.Component);i.default=l,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene"}],Crate:[function(e,t,i){"use strict";cc._RF.push(t,"77d1922Q39Pm5fXWjDaFoRf","Crate");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./Config"),s=e("./Game"),r=e("../core/Utils"),c=e("./DoesDamage"),l=e("./Placeholder"),h=e("../core/Singleton"),u=e("../core/audio/AudioScene"),p=cc._decorator,d=p.ccclass,f=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sizeType=l.ActorSizeType.SMALL,t.facingDirection=r.Direction.LEFT,t.bodySprites=[],t.persistentKey="",t.health=100,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){var n=this;if(i.tag==s.ColliderTag.PLAYER_ATTACK_AREA&&0!=this.health){var o=i.getComponent(c.default);this.health-=o.attackDamage,this.health<=0?(this.health=0,this.scheduleOnce(function(){return n.node.destroy()},.5),this.animation.play("FX_box_open"),h.default.getInstance().audioManager.playSingleSfx(u.SFXKey.box_hit2),s.default.instance.shakeCamera(s.CameraShakeLevel.MEDIUM),s.default.instance.spawnCollectables(this.node.position,this.cookiesSpawnCount),s.default.instance.persistencyStates[this.persistentKey]=!0):(h.default.getInstance().audioManager.playSfx(u.SFXKey.box_hit1),s.default.instance.shakeCamera(s.CameraShakeLevel.LOW));for(var a=function(e){e.setMaterial(0,s.default.instance.spriteOverlayColorMaterial),e.scheduleOnce(function(){e.setMaterial(0,s.default.instance.builtinSpriteMaterial)},.3)},r=0,l=this.bodySprites;r<l.length;r++){a(l[r])}}},t.prototype.onLoad=function(){this.sizeType==l.ActorSizeType.SMALL?(this.spriteNode=this.node.getChildByName("box_opening_small"),this.health=a.SmallCrateConfig.health,this.cookiesSpawnCount=a.SmallCrateConfig.cookiesSpawnCount):this.sizeType==l.ActorSizeType.MEDIUM?(this.spriteNode=this.node.getChildByName("box_opening_medium"),this.health=a.MediumCrateConfig.health,this.cookiesSpawnCount=a.MediumCrateConfig.cookiesSpawnCount):this.sizeType==l.ActorSizeType.BIG&&(this.spriteNode=this.node.getChildByName("box_opening_big"),this.health=a.BigCrateConfig.health,this.cookiesSpawnCount=a.BigCrateConfig.cookiesSpawnCount),this.animation=this.spriteNode.getComponent(cc.Animation),this.bodySprites=r.getAllSubChildrenSprites(this.spriteNode)},t.prototype.start=function(){this.facingDirection==r.Direction.LEFT?this.spriteNode.scaleX=Math.abs(this.spriteNode.scaleX):(this.facingDirection=r.Direction.RIGHT,this.spriteNode.scaleX=-Math.abs(this.spriteNode.scaleX))},o([f({type:cc.Enum(l.ActorSizeType)})],t.prototype,"sizeType",void 0),t=o([d],t)}(cc.Component);i.default=m,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Config":"Config","./DoesDamage":"DoesDamage","./Game":"Game","./Placeholder":"Placeholder"}],DataManager:[function(e,t,i){"use strict";cc._RF.push(t,"c0f7d+bQFdG6rNmC8Vd3OYD","DataManager"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=e("../game/UpgradesManager");(function(e){e[e.snarfFounds=0]="snarfFounds"})(i.LocalDataKey||(i.LocalDataKey={})),function(e){e[e.none=0]="none",e[e.completed=1]="completed",e[e.completedSnarf=2]="completedSnarf"}(n=i.CongratulationType||(i.CongratulationType={}));var a=function(){function e(){this.localData=[],this.version=e.STORAGE_VERSION,this.storageKey="thundercats-roar",this.loadData()}return e.prototype.initData=function(){for(var e,t=[],i=[],a=0;a<8;a++)t.push(!1);for(a=0;a<o.default.REGULAR_LEVELS_COUNT;++a)i[a]=[!1,!1,!1];e={version:this.version,sounds:!0,cookies:0,upgrades:t,unlockedRegularLevels:1,unlockedBossLevels:0,seeAnimationLevelClear:!0,seeAnimationLevelUnlock:!1,seeAnimationBar:!1,seeComicIntro:!1,seeComicEnd:!1,collectables:i,seeTutorialStore:!1,seeCongratulation:n.none},this.storageData=e,this.saveData()},e.prototype.loadData=function(){var e=cc.sys.localStorage.getItem(this.storageKey);this.storageData=JSON.parse(e),null!==e&&this.storageData.version===this.version||this.initData()},e.prototype.saveData=function(){cc.sys.localStorage.setItem(this.storageKey,JSON.stringify(this.storageData))},e.prototype.getLocalKey=function(e){return void 0!==this.localData[e]?this.localData[e]:null},e.prototype.setLocalKey=function(e,t){this.localData[e]=t},e.prototype.clearAllLocalKey=function(){for(var e in this.localData)delete this.localData[e]},e.prototype.getSounds=function(){return this.storageData.sounds},e.prototype.getCookies=function(){return this.storageData.cookies},e.prototype.getUpgrades=function(){return this.storageData.upgrades.slice()},e.prototype.getUnlockedRegularLevels=function(){return this.storageData.unlockedRegularLevels},e.prototype.getUnlockedBossLevels=function(){return this.storageData.unlockedBossLevels},e.prototype.getSeeAnimationBar=function(){return this.storageData.seeAnimationBar},e.prototype.getSeeComicIntro=function(){return this.storageData.seeComicIntro},e.prototype.getSeeComicEnd=function(){return this.storageData.seeComicEnd},e.prototype.getSeeAnimationLevelUnlock=function(){return this.storageData.seeAnimationLevelUnlock},e.prototype.getCollectables=function(){return this.storageData.collectables.slice()},e.prototype.getSeeTutorialStore=function(){return this.storageData.seeTutorialStore},e.prototype.getCongratulation=function(){return this.storageData.seeCongratulation},e.prototype.setSounds=function(e){this.storageData.sounds=e,this.saveData()},e.prototype.setCookies=function(e){this.storageData.cookies=e,this.saveData()},e.prototype.setUpgrades=function(e){this.storageData.upgrades=e,this.saveData()},e.prototype.setUnlockedLevels=function(e,t){this.storageData.unlockedRegularLevels!==e&&this.storageData.unlockedBossLevels!==t||(this.storageData.seeAnimationLevelUnlock=!1),this.storageData.unlockedRegularLevels=e,this.storageData.unlockedBossLevels=t,this.saveData()},e.prototype.seeAnimationBar=function(){this.storageData.seeAnimationBar=!0,this.saveData()},e.prototype.seeComicIntro=function(){this.storageData.seeComicIntro=!0,this.saveData()},e.prototype.seeComicEnd=function(){this.storageData.seeComicEnd=!0,this.saveData()},e.prototype.seeAnimationLevelUnlock=function(){this.storageData.seeAnimationLevelUnlock=!0,this.saveData()},e.prototype.setCollectables=function(e){for(var t=0;t<o.default.REGULAR_LEVELS_COUNT;++t)this.storageData.collectables[t]=[e[t].foundFirst,e[t].foundSecond,e[t].foundThird];this.saveData()},e.prototype.seeTutorialStore=function(){this.storageData.seeTutorialStore=!0,this.saveData()},e.prototype.setCongratulation=function(e){this.storageData.seeCongratulation=e,this.saveData()},e.STORAGE_VERSION="1.0.0",e}();i.default=a,cc._RF.pop()},{"../game/UpgradesManager":"UpgradesManager"}],Destructable:[function(e,t,i){"use strict";cc._RF.push(t,"cbc853AdwxBV7cCLHAU3WL7","Destructable");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./Game"),s=e("./DoesDamage"),r=e("../core/Utils"),c=cc._decorator,l=c.ccclass,h=c.property,u=function(){return function(){this.fullHealth=0,this.remainingHealth=0,this.damageTaken=0,this.selfCollider=null,this.otherCollider=null}}();i.DamageTakenData=u;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._fullHealth=100,t.remainingHealth=100,t.spriteNode=null,t.sprites=[],t}return n(t,e),Object.defineProperty(t.prototype,"fullHealth",{get:function(){return this._fullHealth},set:function(e){this._fullHealth=e,this.remainingHealth=e},enumerable:!0,configurable:!0}),t.prototype.onBeginContact=function(e,t,i){if(i.tag==a.ColliderTag.PLAYER_ATTACK_AREA){console.info("destructable contact!");var n=i.getComponent(s.default);this.remainingHealth-=n.attackDamage,this.remainingHealth<=0?(this.remainingHealth=0,this.node.destroy(),a.default.instance.shakeCamera(a.CameraShakeLevel.MEDIUM)):a.default.instance.shakeCamera(a.CameraShakeLevel.LOW);for(var o=function(e){e.setMaterial(0,a.default.instance.spriteOverlayColorMaterial),e.scheduleOnce(function(){e.setMaterial(0,a.default.instance.builtinSpriteMaterial)},.3)},r=0,c=this.sprites;r<c.length;r++){o(c[r])}var l=new u;l.fullHealth=this.fullHealth,l.remainingHealth=this.remainingHealth,l.damageTaken=n.attackDamage,l.selfCollider=t,l.otherCollider=i,this.node.emit("onDamageTaken",l)}},t.prototype.start=function(){this.remainingHealth=this.fullHealth,this.sprites=r.getAllSubChildrenSprites(this.spriteNode)},o([h],t.prototype,"_fullHealth",void 0),o([h],t.prototype,"fullHealth",null),t=o([l],t)}(cc.Component);i.default=p,cc._RF.pop()},{"../core/Utils":"Utils","./DoesDamage":"DoesDamage","./Game":"Game"}],DoesDamage:[function(e,t,i){"use strict";cc._RF.push(t,"e2830hvd1lFCKulscGZHWKi","DoesDamage");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../core/Utils"),s=cc._decorator,r=s.ccclass,c=s.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.touchDamage=100,t.attackDamage=100,t.attackDirection=a.Direction.LEFT,t}return n(t,e),o([c],t.prototype,"touchDamage",void 0),o([c],t.prototype,"attackDamage",void 0),o([c({type:cc.Enum(a.Direction)})],t.prototype,"attackDirection",void 0),t=o([r],t)}(cc.Component);i.default=l,cc._RF.pop()},{"../core/Utils":"Utils"}],Door:[function(e,t,i){"use strict";cc._RF.push(t,"a95edMWophJkoHbw8V5fQrG","Door");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../core/Utils"),s=e("./Game"),r=e("../core/Singleton"),c=e("./controllers/PlayerController"),l=e("./Placeholder"),h=e("../core/audio/AudioScene"),u=cc._decorator,p=u.ccclass,d=u.property;(function(e){e[e.SWAMP=0]="SWAMP",e[e.MOUNTAIN=1]="MOUNTAIN",e[e.PYRAMID=2]="PYRAMID"})(i.DoorVariation||(i.DoorVariation={}));var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.swampFrameSprite=null,t.mountainFrameSprite=null,t.pyramidFrameSprite=null,t.placeholderNodeName="",t.sceneName="",t.entryNodeName="",t.facingDirection=a.Direction.LEFT,t.worldType=l.ActorWorldType.SWAMP,t.frameNode=null,t.doorNode=null,t.signNode=null,t.signNodeDesktop=null,t.signNodeMobile=null,t.transition=null,t.isActive=!1,t}var i;return n(t,e),i=t,t.prototype.onBeginContact=function(e,t,n){n.tag==s.ColliderTag.PLAYER_BODY&&(this.isActive=!0,a.isMobile()?this.signNodeMobile.active=!0:this.signNodeDesktop.active=!0,s.default.instance.playerNode.getComponent(c.default).inFrontOfDoor=this.getComponent(i))},t.prototype.onEndContact=function(e,t,i){i.tag==s.ColliderTag.PLAYER_BODY&&(this.isActive=!1,a.isMobile()?this.signNodeMobile.active=!1:this.signNodeDesktop.active=!1,s.default.instance.playerNode.getComponent(c.default).inFrontOfDoor=null)},t.prototype.open=function(e){void 0===e&&(e=!1);var t=this.doorNode.getComponent(cc.Animation),i=t.getAnimationState("OPEN_door");i.duration=e?.001:i.clip.duration,r.default.getInstance().audioManager.playSfx(h.SFXKey.door_open),t.play("OPEN_door")},t.prototype.close=function(e){void 0===e&&(e=!1);var t=this.doorNode.getComponent(cc.Animation),i=t.getAnimationState("CLOSE_door");i.duration=e?.001:i.clip.duration,r.default.getInstance().audioManager.playSfx(h.SFXKey.door_close),t.play("CLOSE_door")},t.prototype.onLoad=function(){var e=cc.find("LEVEL/TILEMAP/deco front");this.frameNode=this.node.getChildByName("frame"),this.doorNode=this.node.getChildByName("door"),this.signNode=this.node.getChildByName("sign"),this.signNodeDesktop=this.signNode.getChildByName("sign"),this.signNodeMobile=this.signNode.getChildByName("sign_mobile"),this.signNodeDesktop.active=!1,this.signNodeMobile.active=!1,this.signNodeDesktop.getChildByName("letter").getComponent(cc.Label).string=r.default.getInstance().attackKey.toUpperCase(),a.changeParent(this.signNode,e)},t.prototype.start=function(){switch(this.worldType){case l.ActorWorldType.SWAMP:this.frameNode.getComponent(cc.Sprite).spriteFrame=this.swampFrameSprite;break;case l.ActorWorldType.MOUNTAIN:this.frameNode.getComponent(cc.Sprite).spriteFrame=this.mountainFrameSprite;break;case l.ActorWorldType.PYRAMID:this.frameNode.getComponent(cc.Sprite).spriteFrame=this.pyramidFrameSprite}},o([d(cc.SpriteFrame)],t.prototype,"swampFrameSprite",void 0),o([d(cc.SpriteFrame)],t.prototype,"mountainFrameSprite",void 0),o([d(cc.SpriteFrame)],t.prototype,"pyramidFrameSprite",void 0),t=i=o([p],t)}(cc.Component);i.default=f,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Game":"Game","./Placeholder":"Placeholder","./controllers/PlayerController":"PlayerController"}],ExposedLocalizationImage:[function(e,t,i){"use strict";cc._RF.push(t,"fc233fj9hRP6pr3AkIbV76d","ExposedLocalizationImage");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./LocalizationImage"),s=cc._decorator.ccclass,r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"spriteComponent",{get:function(){return this.sprite},set:function(e){this.sprite=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this.sprite.spriteFrame},set:function(e){this.sprite.spriteFrame=e},enumerable:!0,configurable:!0}),t=o([s("ExposedLocalizationImage")],t)}(a.default);i.default=r,cc._RF.pop()},{"./LocalizationImage":"LocalizationImage"}],ExposedLocalizationText:[function(e,t,i){"use strict";cc._RF.push(t,"3dceeUVhe5IraqDkl//FxE7","ExposedLocalizationText");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./LocalizationText"),s=cc._decorator.ccclass,r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"textComponent",{get:function(){return this._text},set:function(e){this._text=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._text.string},set:function(e){this._text.string=e},enumerable:!0,configurable:!0}),t=o([s("ExposedLocalizationText")],t)}(a.default);i.default=r,cc._RF.pop()},{"./LocalizationText":"LocalizationText"}],FinalBoss:[function(e,t,i){"use strict";cc._RF.push(t,"09019xqChZPXKoGdhHA9ClQ","FinalBoss");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./Game"),s=e("./Config"),r=e("./PatrollingPassiveEnemy"),c=e("../core/Utils"),l=e("./DoesDamage"),h=e("./UpgradesManager"),u=e("../Testing/TesterLevelData"),p=e("./PausableComponent"),d=e("../core/audio/AudioScene"),f=e("../core/Singleton"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.punchAlertPrefab=null,t.laneHitPrefab=null,t.patrollingEnemyPrefab=null,t.flyingChaserEnemyPrefab=null,t.lifeIconHigh=null,t.lifeIconMedium=null,t.lifeIconLow=null,t.NODE_SCALE=1.8,t.bossNode=null,t.spine=null,t.punchColliders=[],t.headCollider=null,t.originalMaterial=null,t.health=0,t.punchChargeTime=0,t.singlePunchAttackTime=0,t.doublePunchAttackTime=0,t.punchCooldownTime=0,t.punchedLanes=0,t.punchedLaneOffsets=[],t.firstEnemiesSpawn=!1,t.secondEnemiesSpawn=!1,t.thirdEnemiesSpawn=!1,t.firstBossStun=!1,t.secondBossStun=!1,t.punching=!1,t.enraged=!1,t.wasEnraged=!1,t.stunned=!1,t.prevPunchPatternIndex=-1,t.playerDefeated=!1,t}var i;return n(t,e),i=t,Object.defineProperty(t.prototype,"instance",{get:function(){return i._instance},enumerable:!0,configurable:!0}),t.prototype.onBeginContact=function(e,t,i){var n=this;if(i.tag==a.ColliderTag.PLAYER_ATTACK_AREA){var o=i.getComponent(l.default);for(this.health-=o.attackDamage,this.stunned?this.spine.setAnimation(0,"stun_hitstate",!1):1==this.punchedLanes||8==this.punchedLanes?this.spine.setAnimation(0,"hit_side_hitstate",!1):2==this.punchedLanes||4==this.punchedLanes?this.spine.setAnimation(0,"hit_center_hitstate",!1):9==this.punchedLanes?(t.offset.x==this.punchedLaneOffsets[0]&&this.spine.setAnimation(0,"hit_side_double_hitstate_l",!1),t.offset.x==this.punchedLaneOffsets[3]&&this.spine.setAnimation(0,"hit_side_double_hitstate_r",!1)):6==this.punchedLanes?(t.offset.x==this.punchedLaneOffsets[1]&&this.spine.setAnimation(0,"hit_center_double_hitstate_l",!1),t.offset.x==this.punchedLaneOffsets[2]&&this.spine.setAnimation(0,"hit_center_double_hitstate_r",!1)):10==this.punchedLanes||5==this.punchedLanes?(t.offset.x==this.punchedLaneOffsets[0]&&this.spine.setAnimation(0,"hit_intercalado_hitstate_r",!1),t.offset.x==this.punchedLaneOffsets[1]&&this.spine.setAnimation(0,"hit_intercalado_hitstate_l",!1),t.offset.x==this.punchedLaneOffsets[2]&&this.spine.setAnimation(0,"hit_intercalado_hitstate_l",!1),t.offset.x==this.punchedLaneOffsets[3]&&this.spine.setAnimation(0,"hit_intercalado_hitstate_r",!1)):(console.error("what punch combination or state is this!"),console.error("  punchedLandes: "+this.punchedLanes+" stunned: "+this.stunned));!this.stunned&&this.checkSpawnPatrollingEnemies();)this.spawnPatrollingEnemies();this.health<=.666*this.maxHealth&&!this.firstBossStun&&(this.health=.666*this.maxHealth,this.firstBossStun=!0,this.beginStun()),this.health<=.333*this.maxHealth&&!this.secondBossStun&&(this.health=.333*this.maxHealth,this.secondBossStun=!0,this.beginStun()),this.health<=.5*this.maxHealth&&!this.enraged?(this.health=.5*this.maxHealth,this.updateLifeBar(),this.enterRageMode(),f.default.getInstance().audioManager.playSfxHitEnemy(),a.default.instance.shakeCamera(a.CameraShakeLevel.HIGH)):this.health<=0?(this.health=0,this.updateLifeBar(),this.stunned?this.endStun(function(){return n.bossDefeated()}):0!=this.punchedLanes?this.endPunch(function(){return n.bossDefeated()}):this.bossDefeated()):(f.default.getInstance().audioManager.playSfxHitEnemy(),this.updateLifeBar(),a.default.instance.shakeCamera(a.CameraShakeLevel.LOW))}},t.prototype.spawnFinalBoss=function(){var e=this;this.bossNode=this.node,this.spine.node.scale=this.NODE_SCALE,this.bossNode.position=cc.v2(this.bossNode.position.x,this.baseTerrainYCoord-800),this.bossNode.removeFromParent(),a.default.instance.actorsBackLayer.addChild(this.bossNode);for(var t=0;t<s.FinalBossConfig.punchLanesCount;++t){var i=this.addComponent(cc.PhysicsBoxCollider),n=cc.v2(this.getPunchLanePosition(t).x,3*a.default.TILE_SIZE.height);this.punchColliders.push(i),this.punchColliders[t].tag=a.ColliderTag.ENEMY_BODY,this.punchColliders[t].sensor=!0,this.punchColliders[t].size=cc.size(s.FinalBossConfig.punchLaneWidth*a.default.TILE_SIZE.width*.8,6*a.default.TILE_SIZE.height),this.punchColliders[t].offset=n,this.punchColliders[t].apply(),this.punchColliders[t].enabled=!1,this.punchedLaneOffsets.push(n.x)}this.headCollider=this.addComponent(cc.PhysicsBoxCollider),this.headCollider.tag=a.ColliderTag.ENEMY_BODY,this.headCollider.sensor=!0,this.headCollider.size=cc.size(s.FinalBossConfig.punchLaneWidth*a.default.TILE_SIZE.width*.8,6*a.default.TILE_SIZE.height),this.headCollider.offset=cc.v2(0,3*a.default.TILE_SIZE.height),this.headCollider.apply(),this.headCollider.enabled=!1,this.spine.setSkin("normal"),this.spine.setAnimation(0,"idle",!0),cc.tween(this.node).delay(3).call(function(){a.default.instance.shakeCamera(a.CameraShakeLevel.HIGH,10),f.default.getInstance().audioManager.playSfx(d.SFXKey.bosslevel_in2)}).to(10,{position:cc.v2(0,this.baseTerrainYCoord-10)},{easing:"quadOut"}).call(function(){a.default.instance.gameplayUI.showBossUI(),a.default.instance.gameplayUI.showPauseButton(),a.default.instance.getPlayer().doIntroAnimation(function(){f.default.getInstance().audioManager.playMusic(d.HowlsKey.music_boss,0,!0),a.default.instance.getPlayer().enableInput(),e.attack(s.FinalBossConfig.restTime)})}).start()},t.prototype.checkSpawnPatrollingEnemies=function(){return this.health<=.75*this.maxHealth&&!this.firstEnemiesSpawn?(this.firstEnemiesSpawn=!0,!0):this.health<=.5*this.maxHealth&&!this.secondEnemiesSpawn?(this.secondEnemiesSpawn=!0,!0):this.health<=.25*this.maxHealth&&!this.thirdEnemiesSpawn&&(this.thirdEnemiesSpawn=!0,!0)},t.prototype.spawnPatrollingEnemies=function(){f.default.getInstance().audioManager.playSfx(d.SFXKey.bosslevel_mummra5);for(var e=0,t=0;t<s.FinalBossConfig.enemySpawnsCount;++t){var i=cc.instantiate(this.patrollingEnemyPrefab),n=.5*-(s.FinalBossConfig.punchLanesCount*s.FinalBossConfig.punchLaneWidth-4),o=-n,l=Math.random()<.5?c.Direction.RIGHT:c.Direction.LEFT,h=l==c.Direction.RIGHT?n-e-2:o+e+2,u=cc.v2(h*a.default.TILE_SIZE.width,this.baseTerrainYCoord+this.patrollingEnemyPrefab.data.position.y);i.position=u;var p=i.getComponent(r.default);p.leftLimitTiles=h-n,p.rightLimitTiles=o-h,p.initialDirection=l,p.disableBoundsCheck(),a.default.instance.actorsMiddleLayer.addChild(i),e+=2}},t.prototype.attack=function(e){var t=this;if(!this.wasEnraged&&this.enraged&&(console.error("enraged!"),this.spine.setAnimation(0,"rage_in",!1),this.spine.addAnimation(0,"idle",!0),this.spine.addAnimation(1,"fire_back",!0),this.spine.setSkin("rage"),f.default.getInstance().audioManager.playSfx(d.SFXKey.bosslevel_mummra9),e+=1),this.enraged){var i=this.getPunchesPattern(),n=Math.random()<.5;console.info("  punches pattern: "+i+(n?" (reversed)":""));for(var o,a=function(a){var c=i.charAt(a),l=i.charAt(a+1);if(" "==c)e+=s.FinalBossConfig.hardPunchesSequenceDelay;else{var h=parseInt(c),u=parseInt(l);isNaN(u)?u=0:++a,h&&(n&&(h=s.FinalBossConfig.punchLanesCount+1-h),n&&u>0&&(u=s.FinalBossConfig.punchLanesCount+1-u),r.scheduleOnce(function(){return t.punchLane(h-1,u-1)},e)),e+=3}o=a},r=this,c=0;c<i.length;++c)a(c),c=o;this.scheduleOnce(function(){return t.attack(s.FinalBossConfig.restTime)},e+2)}else this.scheduleOnce(function(){return t.punchLane()},e);this.wasEnraged=this.enraged},t.prototype.punchLane=function(e,t){var i=this;if(void 0===e&&(e=-1),void 0===t&&(t=-1),this.playerDefeated)this.unscheduleAllCallbacks();else{if(t>=0&&e>t){var n=e;e=t,t=n}this.spine.setAnimation(0,"charge_in",!1),this.spine.addAnimation(0,"charge_loop",!0,0);var o=.6;o<0&&(o=0),this.scheduleOnce(function(){e<0&&(e=i.getClosestPunchLane());var n=cc.instantiate(i.punchAlertPrefab),r=i.getPunchLanePosition(e);if(n.position=r,n.getChildByName("path_mumra").getChildByName("line_yellow").width=s.FinalBossConfig.punchLaneWidth*a.default.TILE_SIZE.width,a.default.instance.actorsFrontLayer.addChild(n),t>=0){var l=cc.instantiate(i.punchAlertPrefab),h=i.getPunchLanePosition(t);l.position=h,l.getChildByName("path_mumra").getChildByName("line_yellow").width=s.FinalBossConfig.punchLaneWidth*a.default.TILE_SIZE.width,a.default.instance.actorsFrontLayer.addChild(l)}f.default.getInstance().audioManager.playSfxFinalBossAlertPunch(),o+=Math.max(0,i.punchChargeTime-1),i.scheduleOnce(function(){var n=0;0==e&&-1==t?(i.spine.node.scaleX=i.NODE_SCALE,i.spine.setAnimation(0,"hit_side",!1),n=i.singlePunchAttackTime,f.default.getInstance().audioManager.playSfxFinalBossPunch(),console.error("punched single lane "+e)):1==e&&-1==t?(i.spine.node.scaleX=i.NODE_SCALE,i.spine.setAnimation(0,"hit_center",!1),n=i.singlePunchAttackTime,f.default.getInstance().audioManager.playSfxFinalBossPunch(),console.error("punched single lane "+e)):2==e&&-1==t?(i.spine.node.scaleX=-i.NODE_SCALE,i.spine.setAnimation(0,"hit_center",!1),n=i.singlePunchAttackTime,f.default.getInstance().audioManager.playSfxFinalBossPunch(),console.error("punched single lane "+e)):3==e&&-1==t?(i.spine.node.scaleX=-i.NODE_SCALE,i.spine.setAnimation(0,"hit_side",!1),n=i.singlePunchAttackTime,f.default.getInstance().audioManager.playSfxFinalBossPunch(),console.error("punched single lane "+e)):1==e&&2==t?(i.spine.node.scaleX=i.NODE_SCALE,i.spine.setAnimation(0,"hit_center_double",!1),n=i.doublePunchAttackTime,f.default.getInstance().audioManager.playSfxFinalBossDoublePunch(),console.error("punched double lanes "+e+" and "+t)):0==e&&3==t?(i.spine.node.scaleX=i.NODE_SCALE,i.spine.setAnimation(0,"hit_side_double",!1),n=i.doublePunchAttackTime,f.default.getInstance().audioManager.playSfxFinalBossDoublePunch(),console.error("punched double lanes "+e+" and "+t)):0==e&&2==t?(i.spine.node.scaleX=-i.NODE_SCALE,i.spine.setAnimation(0,"hit_intercalado",!1),n=i.doublePunchAttackTime,f.default.getInstance().audioManager.playSfxFinalBossDoublePunch(),console.error("punched double lanes "+e+" and "+t)):1==e&&3==t?(i.spine.node.scaleX=i.NODE_SCALE,i.spine.setAnimation(0,"hit_intercalado",!1),n=i.doublePunchAttackTime,f.default.getInstance().audioManager.playSfxFinalBossDoublePunch(),console.error("punched double lanes "+e+" and "+t)):console.error("unkown punch combination, lanes: "+e+" & "+t),e>=0&&(i.punchedLanes|=1<<e),t>=0&&(i.punchedLanes|=1<<t);var o=cc.size(s.FinalBossConfig.punchLaneWidth*a.default.TILE_SIZE.width,20*a.default.TILE_SIZE.height),r=i.getPunchLanePosition(e).add(cc.v2(0,.5*o.height)),l=i.getPunchLanePosition(t).add(cc.v2(0,.5*o.height));i.scheduleOnce(function(){e>=0&&(a.default.instance.spawnBoxAttackArea(r,o,c.Direction.NONE,s.FinalBossConfig.punchDamage,.2,a.ColliderTag.ENEMY_ATTACK_AREA),i.punchColliders[e].enabled=!0),t>=0&&(a.default.instance.spawnBoxAttackArea(l,o,c.Direction.NONE,s.FinalBossConfig.punchDamage,.2,a.ColliderTag.ENEMY_ATTACK_AREA),i.punchColliders[t].enabled=!0),a.default.instance.shakeCamera(a.CameraShakeLevel.HIGH),i.scheduleOnce(function(){return i.endPunch()},n)},.4)},o)},Math.min(this.punchChargeTime-o,0))}},t.prototype.endPunch=function(e){var t=this;void 0===e&&(e=null),1==this.punchedLanes||8==this.punchedLanes?(this.spine.setAnimation(0,"hit_side_out",!1),f.default.getInstance().audioManager.playSfx(d.SFXKey.bosslevel_mummra6),console.error("end punch single lane")):2==this.punchedLanes||4==this.punchedLanes?(this.spine.setAnimation(0,"hit_center_out",!1),f.default.getInstance().audioManager.playSfx(d.SFXKey.bosslevel_mummra6),console.error("end punch single lane")):9==this.punchedLanes?(this.spine.setAnimation(0,"hit_side_out_double",!1),f.default.getInstance().audioManager.playSfx(d.SFXKey.bosslevel_mummra6),console.error("end punch double lanes")):6==this.punchedLanes?(this.spine.setAnimation(0,"hit_center_out_double",!1),f.default.getInstance().audioManager.playSfx(d.SFXKey.bosslevel_mummra6),console.error("end punch double lanes")):10==this.punchedLanes||5==this.punchedLanes?(this.spine.setAnimation(0,"hit_intercalado_out",!1),f.default.getInstance().audioManager.playSfx(d.SFXKey.bosslevel_mummra6),console.error("end punch double lanes")):console.error("end punch what lane is this!"),this.punchedLanes=0;for(var i=0;i<s.FinalBossConfig.punchLanesCount;++i)this.punchColliders[i].enabled=!1;this.spine.addAnimation(0,"idle",!0,0),e?this.spine.setCompleteListener(function(){t.spine.setCompleteListener(null),e()}):this.enraged||this.attack(this.punchCooldownTime)},t.prototype.beginStun=function(){var e=this;console.info("begin stun!"),this.stunned=!0,this.unscheduleAllCallbacks(),this.endPunch(function(){for(var t=0;t<s.FinalBossConfig.punchLanesCount;++t)e.punchColliders[t].enabled=!1;e.spine.setAnimation(0,"stun_in",!1),f.default.getInstance().audioManager.playSfx(d.SFXKey.bosslevel_mummra7),e.spine.setTrackCompleteListener(e.spine.getCurrent(0),function(){e.spine.setTrackCompleteListener(e.spine.getCurrent(0),null),e.headCollider.enabled=!0,f.default.getInstance().audioManager.initStunLoop(!0),e.scheduleOnce(function(){return e.endStun()},s.FinalBossConfig.stunTime)})})},t.prototype.endStun=function(e){var t=this;void 0===e&&(e=null),console.info("end stun!"),this.stunned=!1,this.headCollider.enabled=!1,f.default.getInstance().audioManager.endStunLoop(),f.default.getInstance().audioManager.playSfx(d.SFXKey.bosslevel_mummra8),this.spine.setAnimation(0,"stun_out",!1),this.spine.setTrackCompleteListener(this.spine.getCurrent(0),function(){for(t.spine.setTrackCompleteListener(t.spine.getCurrent(0),null),t.spine.setAnimation(0,"idle",!0);t.checkSpawnPatrollingEnemies();)t.spawnPatrollingEnemies();e?e():t.attack(s.FinalBossConfig.restTime)})},t.prototype.enterRageMode=function(){var e=this;this.enraged=!0,this.punchChargeTime=s.FinalBossConfig.hardPunchChargeTime,this.singlePunchAttackTime=s.FinalBossConfig.hardSinglePunchAttackTime,this.doublePunchAttackTime=s.FinalBossConfig.hardDoublePunchAttackTime,this.punchCooldownTime=s.FinalBossConfig.hardPunchCooldownTime,this.unscheduleAllCallbacks(),this.stunned?this.endStun(function(){return e.attack(s.FinalBossConfig.restTime)}):0!=this.punchedLanes?this.endPunch(function(){return e.attack(s.FinalBossConfig.restTime)}):this.attack(s.FinalBossConfig.restTime)},t.prototype.bossWin=function(){var e=this;console.info("final boss won!"),this.playerDefeated=!0,this.unscheduleAllCallbacks(),this.stunned?this.endStun(function(){return e.spine.setAnimation(0,"idle",!0)}):0!=this.punchedLanes?this.endPunch(function(){return e.spine.setAnimation(0,"idle",!0)}):this.spine.setAnimation(0,"idle",!0),f.default.getInstance().audioManager.playCurrentMusicFadeOut(500),this.scheduleOnce(function(){return f.default.getInstance().audioManager.playSfx(d.SFXKey.bosslevel_lose2)},.5)},t.prototype.bossDefeated=function(){var e=this;f.default.getInstance().audioManager.playCurrentMusicFadeOut(500),this.spine.setAnimation(0,"defeat",!1),a.default.instance.shakeCamera(a.CameraShakeLevel.MEDIUM),a.default.instance.getPlayer().setImmune(15),h.default.instance.lastLevelWasCompleted=!0,this.unscheduleAllCallbacks();for(var t=0;t<s.FinalBossConfig.punchLanesCount;++t)this.punchColliders[t].enabled=!1;this.headCollider.enabled=!1,u.default.instances.endTimerLevel(),this.scheduleOnce(function(){return f.default.getInstance().audioManager.playSfx(d.SFXKey.bosslevel_win2)},.5),this.scheduleOnce(function(){a.default.instance.spawnCollectables(e.node.position.add(cc.v2(0,500)),s.FinalBossConfig.cookiesSpawnCount),e.scheduleOnce(function(){a.default.instance.gameplayUI.hideAllUI(),a.default.instance.getPlayer().disableInput(),a.default.instance.getPlayer().doVictoryAnimation(),f.default.getInstance().audioManager.playSfx(d.SFXKey.character_winner),e.scheduleOnce(function(){return a.default.instance.levelComplete(1)},3)},6)},3)},t.prototype.getPunchLanePosition=function(e){var t=s.FinalBossConfig.punchLaneWidth*a.default.TILE_SIZE.width,i=-.5*s.FinalBossConfig.punchLanesCount*t+t*(e+.5);return cc.v2(i,this.baseTerrainYCoord)},t.prototype.getClosestPunchLane=function(){for(var e=Number.POSITIVE_INFINITY,t=-1,i=a.default.instance.playerNode.position.x,n=0;n<s.FinalBossConfig.punchLanesCount;++n){var o=this.getPunchLanePosition(n).x,r=Math.abs(i-o);r<e&&(e=r,t=n)}return t},t.prototype.getPunchesPattern=function(){var e=Math.floor(Math.random()*s.FinalBossConfig.hardPunchPatterns.length);return e==this.prevPunchPatternIndex&&++e,e>=s.FinalBossConfig.hardPunchPatterns.length&&(e=0),this.prevPunchPatternIndex=e,s.FinalBossConfig.hardPunchPatterns[e]},t.prototype.updateLifeBar=function(e){void 0===e&&(e=!1);var t=this.health/this.maxHealth*this.lifeWidth;e?this.lifeBarNode.width=t:cc.tween(this.lifeBarNode).to(.5,{width:t}).start(),this.health/this.maxHealth>.5?this.lifeIconNode.getComponent(cc.Sprite).spriteFrame=this.lifeIconHigh:this.health/this.maxHealth>.25?this.lifeIconNode.getComponent(cc.Sprite).spriteFrame=this.lifeIconMedium:this.lifeIconNode.getComponent(cc.Sprite).spriteFrame=this.lifeIconLow},t.prototype.setup=function(){this.baseTerrainYCoord=11*-a.default.TILE_SIZE.height,this.punchChargeTime=s.FinalBossConfig.easyPunchChargeTime,this.singlePunchAttackTime=s.FinalBossConfig.easyPunchAttackTime,this.doublePunchAttackTime=s.FinalBossConfig.easyPunchAttackTime,this.punchCooldownTime=s.FinalBossConfig.easyPunchCooldownTime,this.maxHealth=s.FinalBossConfig.health,this.health=this.maxHealth,this.spawnFinalBoss()},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.node.pauseAllActions(),this.spine.paused=!0},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.node.resumeAllActions(),this.spine.paused=!1},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),null==i._instance&&(i._instance=this),this.spine=this.getComponentInChildren(sp.Skeleton),this.originalMaterial=this.spine.getMaterial(0),cc.systemEvent.on("player-defeated",this.bossWin,this)},t.prototype.start=function(){this.lifeBarNode=cc.find("Canvas/UI/Game/boss_life_bar"),this.lifeIconNode=cc.find("Canvas/UI/Game/boss_life_icon"),this.lifeWidth=this.lifeBarNode.width,a.default.instance.gameplayUI.hidePauseButton()},t._instance=null,o([y(cc.Prefab)],t.prototype,"punchAlertPrefab",void 0),o([y(cc.Prefab)],t.prototype,"laneHitPrefab",void 0),o([y(cc.Prefab)],t.prototype,"patrollingEnemyPrefab",void 0),o([y(cc.Prefab)],t.prototype,"flyingChaserEnemyPrefab",void 0),o([y(cc.SpriteFrame)],t.prototype,"lifeIconHigh",void 0),o([y(cc.SpriteFrame)],t.prototype,"lifeIconMedium",void 0),o([y(cc.SpriteFrame)],t.prototype,"lifeIconLow",void 0),t=i=o([g],t)}(p.default);i.default=v,cc._RF.pop()},{"../Testing/TesterLevelData":"TesterLevelData","../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Config":"Config","./DoesDamage":"DoesDamage","./Game":"Game","./PatrollingPassiveEnemy":"PatrollingPassiveEnemy","./PausableComponent":"PausableComponent","./UpgradesManager":"UpgradesManager"}],FinalPopup:[function(e,t,i){"use strict";cc._RF.push(t,"c334b1Vz0hH6It9vQMJ4JYb","FinalPopup");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../core/Singleton"),s=e("../core/audio/AudioScene"),r=e("../game/UpgradesManager"),c=e("../core/Utils"),l=cc._decorator,h=l.ccclass,u=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var i;return n(t,e),i=t,t.prototype.onLoad=function(){this.incompleteContainer=cc.find("base/incomplete",this.node),this.completeContainer=cc.find("base/complete",this.node),this.button=cc.find("base/buttonPlay",this.node).getComponent(cc.Button),this.animation=this.node.getComponent(cc.Animation),this.initAllComplete(r.default.instance.getFoundCollectablesCount()===r.default.instance.getTotalCollectablesCount());for(var e=0,t=this.node.children.length;e<t;e++)this.node.children[e].active=!1},t.prototype.initAllComplete=function(e){if(e?(this.title=cc.find("title",this.completeContainer).getComponent(cc.Label),this.description=cc.find("desciption",this.completeContainer).getComponent(cc.Label),this.title.string=a.default.getInstance().getLocalizationString("title_congratulations_0"),this.description.string=a.default.getInstance().getLocalizationString("text_congratulations_0"),this.incompleteContainer.active=!1,this.completeContainer.active=!0):(this.title=cc.find("title",this.incompleteContainer).getComponent(cc.Label),this.description=cc.find("desciption",this.incompleteContainer).getComponent(cc.Label),this.title.string=a.default.getInstance().getLocalizationString("title_congratulations_1"),this.description.string=a.default.getInstance().getLocalizationString("text_congratulations_1"),this.incompleteContainer.active=!0,this.completeContainer.active=!1),c.fixBigFontLabelLocalization(this.title),c.fixBigFontLabelLocalization(this.description),"ar"===a.default.getInstance().localizationManager.locale){this.title.node.x=e?17:-7,this.description.fontSize=30,this.description.lineHeight=34,this.description.node.x=0,this.description.node.width=550,this.description.node.height=120,this.description.string="\u202e"+this.description.string;var t=this.description.string.indexOf(" ",Math.floor(this.description.string.length/2));this.description.string=this.description.string.substring(0,t)+"\n\u202e"+this.description.string.substring(t)}else"bg"===a.default.getInstance().localizationManager.locale&&(e||(this.description.node.width=495))},t.prototype.show=function(){this.disableButtons();for(var e=0,t=this.node.children.length;e<t;e++)this.node.children[e].active=!0;this.animation.play("IN_gamecomplete"),this.animation.once("finished",this.showStep2,this)},t.prototype.showStep2=function(){r.default.instance.getFoundCollectablesCount()===r.default.instance.getTotalCollectablesCount()&&this.completeContainer.getComponent(cc.Animation).play("LOOP_complete"),this.animation.play("LOOP_light"),this.enableButtons()},t.prototype.hide=function(){this.disableButtons(),a.default.getInstance().audioManager.playSfx(s.SFXKey.button_play),this.animation.play("OUT_gamecomplete"),this.animation.once("finished",this.hideStep2,this)},t.prototype.hideStep2=function(){for(var e=0,t=this.node.children.length;e<t;e++)this.node.children[e].active=!1;this.node.emit(i.KEY_SIGNAL_PRESS_CLOSE)},t.prototype.disableButtons=function(){this.button.interactable=!1},t.prototype.enableButtons=function(){this.button.interactable=!0},t.KEY_SIGNAL_PRESS_CLOSE="close",t=i=o([h],t)}(cc.Component));i.default=u,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","../game/UpgradesManager":"UpgradesManager"}],Finish:[function(e,t,i){"use strict";cc._RF.push(t,"0138eOBJAVLvJyrYK1M3Puc","Finish");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./controllers/TransitionController"),s=e("./Game"),r=e("../core/Utils"),c=e("./UpgradesManager"),l=e("../Testing/TesterLevelData"),h=e("./Placeholder"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ts=null,t.entranceBackSprite=null,t.entranceFrontSprite=null,t.exitBackSprite=null,t.exitFrontSprite=null,t.sceneName="",t.entryNodeName="",t.facingDirection=r.Direction.LEFT,t.classType=h.ActorClassType.LEVEL_TUNNEL,t.worldType=h.ActorWorldType.SWAMP,t.variantType=h.ActorVariantType.VARIANT_1,t}return n(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){var e=this.node.getChildByName("spriteBack"),t=this.node.getChildByName("spriteFront");this.classType==h.ActorClassType.LEVEL_TUNNEL?(this.variantType==h.ActorVariantType.VARIANT_1?(e.getComponent(cc.Sprite).spriteFrame=this.entranceBackSprite,t.getComponent(cc.Sprite).spriteFrame=this.entranceFrontSprite):(e.getComponent(cc.Sprite).spriteFrame=this.exitBackSprite,t.getComponent(cc.Sprite).spriteFrame=this.exitFrontSprite),this.facingDirection==r.Direction.LEFT?this.node.scaleX=-1:this.node.scaleX=1):this.classType==h.ActorClassType.LEVEL_EXIT&&(this.facingDirection==r.Direction.LEFT?this.node.scaleX=1:this.node.scaleX=-1),t.removeFromParent(!1),s.default.instance.actorsFrontLayer.addChild(t),t.position=this.node.position,t.scaleX=this.node.scaleX},t.prototype.onBeginContact=function(e,t,i){i.tag==s.ColliderTag.PLAYER_BODY&&(""==this.sceneName?(c.default.instance.lastLevelWasCompleted=!0,l.default.instances.endTimerLevel()):l.default.instances.endTimerSection(),s.default.instance.changeScene(this.sceneName,this.entryNodeName))},o([d(a.default)],t.prototype,"ts",void 0),o([d(cc.SpriteFrame)],t.prototype,"entranceBackSprite",void 0),o([d(cc.SpriteFrame)],t.prototype,"entranceFrontSprite",void 0),o([d(cc.SpriteFrame)],t.prototype,"exitBackSprite",void 0),o([d(cc.SpriteFrame)],t.prototype,"exitFrontSprite",void 0),t=o([p],t)}(cc.Component);i.default=f,cc._RF.pop()},{"../Testing/TesterLevelData":"TesterLevelData","../core/Utils":"Utils","./Game":"Game","./Placeholder":"Placeholder","./UpgradesManager":"UpgradesManager","./controllers/TransitionController":"TransitionController"}],Flames:[function(e,t,i){"use strict";cc._RF.push(t,"6d4fdxZkm5O9qX19iGLxC8x","Flames");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./Config"),r=e("./DoesDamage"),c=e("../core/Singleton"),l=e("./PausableComponent"),h=cc._decorator,u=h.ccclass;h.property;(function(e){e[e.INACTIVE=0]="INACTIVE",e[e.ACTIVE=1]="ACTIVE"})(a||(a={}));var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delayFactor=0,t.activeTimeLeft=0,t.inactiveTimeLeft=0,t.state=a.INACTIVE,t.prevState=-1,t}return n(t,e),t.prototype.onPause=function(){e.prototype.onPause.call(this),this.animation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.animation.resume()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.body=this.getComponent(cc.RigidBody),this.spriteNode=this.node.getChildByName("sprite"),this.animation=this.spriteNode.getComponent(cc.Animation),this.doesDamage=this.getComponent(r.default)},t.prototype.start=function(){this.activeTime=s.FlamesConfig.activeTime,this.inactiveTime=s.FlamesConfig.inactiveTime,this.doesDamage.touchDamage=s.FlamesConfig.touchDamage,this.body.active=!1,this.inactiveTimeLeft=this.inactiveTime+this.inactiveTime*this.delayFactor,this.prevState=a.INACTIVE,this.animation.play("LOOP_off_fire")},t.prototype.update=function(e){this.activeTimeLeft>0&&(this.activeTimeLeft-=e,this.activeTimeLeft<0&&(this.activeTimeLeft=0,this.inactiveTimeLeft=this.inactiveTime,this.body.active=!1,this.state=a.INACTIVE)),this.inactiveTimeLeft>0&&(this.inactiveTimeLeft-=e,this.inactiveTimeLeft<0&&(this.inactiveTimeLeft=0,this.activeTimeLeft=this.activeTime,this.state=a.ACTIVE)),this.state==a.ACTIVE&&this.prevState==a.INACTIVE?(this.animation.play("PLAY_on_fire"),this.animation.on("finished",this.onEndOn,this),this.playSfxFireIn()):this.state==a.ACTIVE&&this.playSfXFireLoop(),this.state==a.INACTIVE&&this.prevState==a.ACTIVE&&(this.animation.play("PLAY_off_fire"),this.animation.on("finished",this.onEndOff,this),this.playSfxFireOut()),this.prevState=this.state},t.prototype.onEndOn=function(){this.animation.off("finished",this.onEndOn,this),this.body.active=!0,this.animation.play("LOOP_on_fire")},t.prototype.onEndOff=function(){this.animation.off("finished",this.onEndOff,this),this.animation.play("LOOP_off_fire")},t.prototype.playSfxFireIn=function(){c.default.getInstance().audioManager.playFireIn(this)},t.prototype.playSfxFireOut=function(){c.default.getInstance().audioManager.playFireOut(this)},t.prototype.playSfXFireLoop=function(){c.default.getInstance().audioManager.playFireLoop(this)},t.prototype.getRectSfx=function(){var e=1.1*this.node.width,t=1.1*this.node.height,i=this.node.x-e/2,n=this.node.y-t/2;return cc.rect(i,n,e,t)},t=o([u],t)}(l.default);i.default=p,cc._RF.pop()},{"../core/Singleton":"Singleton","./Config":"Config","./DoesDamage":"DoesDamage","./PausableComponent":"PausableComponent"}],FlyingBomberEnemy:[function(e,t,i){"use strict";cc._RF.push(t,"a8085k9gW5Ofaxj3CO/MCje","FlyingBomberEnemy");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("../core/Utils"),r=e("./Config"),c=e("./Game"),l=e("./DoesDamage"),h=e("./Projectile"),u=e("./Placeholder"),p=e("../core/Singleton"),d=e("../core/audio/AudioScene"),f=e("./PausableComponent"),m=cc._decorator,g=m.ccclass,y=m.property;(function(e){e[e.MOVING=0]="MOVING",e[e.STUNNED=1]="STUNNED"})(a||(a={}));var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colorType=u.ActorColorType.GREEN,t.bodySprites=[],t.health=50,t.stunnedTime=1,t.projectileGravityScale=1,t.attackCooldownTime=1,t.leftLimitTiles=5,t.rightLimitTiles=5,t.initialDirection=s.Direction.LEFT,t.moveDirection=s.Direction.LEFT,t.moveVelocity=cc.v2(0,0),t.state=a.MOVING,t.prevState=-1,t.stunnedTimeLeft=0,t.knockbackDirection=s.Direction.NONE,t.verticalAccumulator=0,t.attackCooldownTimeLeft=0,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){if(t.tag==c.ColliderTag.ENEMY_BODY&&i.tag==c.ColliderTag.PLAYER_ATTACK_AREA){var n=i.getComponent(l.default);this.health-=n.attackDamage;for(var o=function(e){e.setMaterial(0,c.default.instance.spriteOverlayColorMaterial),e.scheduleOnce(function(){return e.setMaterial(0,c.default.instance.builtinSpriteMaterial)},r.CommonEnemiesConfig.damageWhiteFlashTime),a.stunnedTimeLeft=.5},a=this,s=0,h=this.bodySprites;s<h.length;s++){o(h[s])}this.health<=0?(this.node.destroy(),c.default.instance.spawnPuff(this.node.position.add(cc.v2(0,-25)),c.default.actorColorToEnemyPuffType(this.colorType)),c.default.instance.shakeCamera(c.CameraShakeLevel.LOW),c.default.instance.spawnCollectables(this.node.position,this.cookiesSpawnCount),p.default.getInstance().audioManager.playSfxKillEnemy()):(c.default.instance.shakeCamera(c.CameraShakeLevel.MEDIUM),p.default.getInstance().audioManager.playSfxHitEnemy())}},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.bodyAnimation.pause(),this.headAnimation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.bodyAnimation.resume(),this.headAnimation.resume()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.body=this.getComponent(cc.RigidBody),this.spriteNode=this.node.getChildByName("sprite"),this.bodyNode=this.colorType==u.ActorColorType.GREEN?this.spriteNode.getChildByName("bird_green_body"):cc.find("base/bird_pink_body",this.spriteNode),this.bodyAnimation=this.node.getComponent(cc.Animation),this.headAnimation=this.bodyNode.getComponent(cc.Animation),this.sprite=this.spriteNode.getComponent(cc.Sprite),this.bodySprites=s.getAllSubChildrenSprites(this.spriteNode)},t.prototype.start=function(){var e;this.colorType==u.ActorColorType.GREEN?(this.health=r.GreenFlyingBomberEnemyConfig.health,this.projectileGravityScale=r.GreenFlyingBomberEnemyConfig.projectileGravityScale,this.attackCooldownTime=r.GreenFlyingBomberEnemyConfig.attackCooldownTime,this.cookiesSpawnCount=r.GreenFlyingBomberEnemyConfig.cookiesSpawnCount,this.maxMoveVelocity=cc.v2(c.default.TILE_SIZE.width*r.GreenFlyingBomberEnemyConfig.maxMoveSpeed,0),this.moveAcceleration=this.maxMoveVelocity.x/r.GreenFlyingBomberEnemyConfig.moveAccelerationTime,this.leftLimitPoint=this.node.x-this.leftLimitTiles*c.default.TILE_SIZE.width,this.rightLimitPoint=this.node.x+this.rightLimitTiles*c.default.TILE_SIZE.width,this.horizontalDetectionRange=r.GreenFlyingBomberEnemyConfig.horizontalDetectionRange*c.default.TILE_SIZE.width,this.verticalDetectionRange=r.GreenFlyingBomberEnemyConfig.verticalDetectionRange*c.default.TILE_SIZE.height,this.intialVerticalPosition=this.node.position.y,this.projectileDamage=r.GreenFlyingBomberEnemyConfig.attackDamage,this.projectileType=h.ProjectileType.GREEN_BOMBER,(e=this.getComponent(l.default)).touchDamage=r.GreenFlyingBomberEnemyConfig.touchDamage,e.attackDamage=r.GreenFlyingBomberEnemyConfig.attackDamage):(this.health=r.PinkFlyingBomberEnemyConfig.health,this.projectileGravityScale=r.PinkFlyingBomberEnemyConfig.projectileGravityScale,this.attackCooldownTime=r.PinkFlyingBomberEnemyConfig.attackCooldownTime,this.cookiesSpawnCount=r.PinkFlyingBomberEnemyConfig.cookiesSpawnCount,this.maxMoveVelocity=cc.v2(c.default.TILE_SIZE.width*r.PinkFlyingBomberEnemyConfig.maxMoveSpeed,0),this.moveAcceleration=this.maxMoveVelocity.x/r.PinkFlyingBomberEnemyConfig.moveAccelerationTime,this.leftLimitPoint=this.node.x-this.leftLimitTiles*c.default.TILE_SIZE.width,this.rightLimitPoint=this.node.x+this.rightLimitTiles*c.default.TILE_SIZE.width,this.horizontalDetectionRange=r.PinkFlyingBomberEnemyConfig.horizontalDetectionRange*c.default.TILE_SIZE.width,this.verticalDetectionRange=r.PinkFlyingBomberEnemyConfig.verticalDetectionRange*c.default.TILE_SIZE.height,this.intialVerticalPosition=this.node.position.y,this.projectileDamage=r.PinkFlyingBomberEnemyConfig.attackDamage,this.projectileType=h.ProjectileType.PINK_BOMBER,(e=this.getComponent(l.default)).touchDamage=r.PinkFlyingBomberEnemyConfig.touchDamage,e.attackDamage=r.PinkFlyingBomberEnemyConfig.attackDamage);this.state=a.MOVING},t.prototype.update=function(e){if(this.attackCooldownTimeLeft>0&&(this.attackCooldownTimeLeft-=e,this.attackCooldownTimeLeft<=0&&(this.attackCooldownTimeLeft=0)),this.stunnedTimeLeft>0&&(this.stunnedTimeLeft-=e,this.stunnedTimeLeft<=0&&(this.stunnedTimeLeft=0)),c.default.instance.playerNode.position.x>=this.node.position.x-this.horizontalDetectionRange&&c.default.instance.playerNode.position.x<=this.node.position.x+this.horizontalDetectionRange&&c.default.instance.playerNode.position.y>=this.node.position.y-this.verticalDetectionRange&&c.default.instance.playerNode.position.y<=this.node.position.y&&0==this.attackCooldownTimeLeft){var t=cc.v2(this.node.position.x,this.node.position.y-50);c.default.instance.spawnProjectile(t,0,cc.misc.degreesToRadians(270),this.projectileGravityScale,this.projectileDamage,this.projectileType),this.playSfxShoot(),this.attackCooldownTimeLeft=this.attackCooldownTime}this.verticalAccumulator+=6*e;var i=10*Math.sin(this.verticalAccumulator),n=cc.v2(this.node.position.x,this.intialVerticalPosition+i);this.node.position.x>=this.rightLimitPoint&&(n.x=this.rightLimitPoint,this.moveDirection=s.Direction.LEFT),this.node.position.x<=this.leftLimitPoint&&(n.x=this.leftLimitPoint,this.moveDirection=s.Direction.RIGHT),this.node.position=n,this.stunnedTimeLeft>0?this.state=a.STUNNED:this.state=a.MOVING,this.state!=a.STUNNED&&this.moveDirection==s.Direction.LEFT&&(this.moveVelocity.x-=this.moveAcceleration*e),this.state!=a.STUNNED&&this.moveDirection==s.Direction.RIGHT&&(this.moveVelocity.x+=this.moveAcceleration*e),this.state==a.STUNNED&&(this.moveVelocity.x=0),this.state!=a.STUNNED&&this.moveVelocity.x>this.maxMoveVelocity.x&&(this.moveVelocity.x=this.maxMoveVelocity.x),this.state!=a.STUNNED&&this.moveVelocity.x<-this.maxMoveVelocity.x&&(this.moveVelocity.x=-this.maxMoveVelocity.x),this.body.linearVelocity=this.moveVelocity,this.moveVelocity.x>0&&(this.spriteNode.scaleX=-1),this.moveVelocity.x<0&&(this.spriteNode.scaleX=1),this.state!=this.prevState&&(this.state==a.MOVING&&(this.bodyAnimation.play("flying"),this.headAnimation.play("blink")),this.state==a.STUNNED&&(this.bodyAnimation.play("hit"),this.headAnimation.stop())),this.prevState=this.state},t.prototype.playSfxShoot=function(){var e=1.1*this.node.width,t=1.1*this.node.height,i=this.node.x-e/2,n=this.node.y-t/2,o=cc.rect(i,n,e,t);p.default.getInstance().audioManager.playSfxRegion(d.SFXKey.enemy_bird,o)},o([y({type:cc.Enum(u.ActorColorType)})],t.prototype,"colorType",void 0),t=o([g],t)}(f.default);i.default=v,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Config":"Config","./DoesDamage":"DoesDamage","./Game":"Game","./PausableComponent":"PausableComponent","./Placeholder":"Placeholder","./Projectile":"Projectile"}],FlyingChaserEnemy:[function(e,t,i){"use strict";cc._RF.push(t,"3c8778rLP9CQbdKc7wjFQDe","FlyingChaserEnemy");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("../core/Utils"),r=e("./Game"),c=e("./DoesDamage"),l=e("./Config"),h=e("./Placeholder"),u=e("../core/Singleton"),p=e("../core/audio/AudioScene"),d=e("./PausableComponent"),f=cc._decorator,m=f.ccclass,g=f.property;(function(e){e[e.IDLE=0]="IDLE",e[e.CHASING=1]="CHASING",e[e.STUNNED=2]="STUNNED"})(a||(a={}));var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colorType=h.ActorColorType.GREEN,t.bodySprites=[],t.initialDirection=s.Direction.LEFT,t.health=50,t.stunnedTime=1,t.playerOffset=cc.v2(50,80),t.facingDirection=s.Direction.LEFT,t.moveVelocity=cc.v2(0,0),t.state=a.IDLE,t.prevState=null,t.stunnedTimeLeft=0,t.knockbackDirection=s.Direction.NONE,t.verticalAccumulator=0,t.adjustPositionOffset=cc.v2(0,0),t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){var n=t.getAABB(),o=i.getAABB();if(t.tag==r.ColliderTag.ENEMY_BODY&&i.tag==r.ColliderTag.PLAYER_ATTACK_AREA){var a=i.getComponent(c.default);this.knockbackDirection=a.attackDirection,this.stunnedTimeLeft=this.stunnedTime,this.knockbackDirection==s.Direction.LEFT&&(this.moveVelocity.x=-this.knockbackVelocity),this.knockbackDirection==s.Direction.RIGHT&&(this.moveVelocity.x=this.knockbackVelocity),this.health-=a.attackDamage;for(var h=function(e){e.setMaterial(0,r.default.instance.spriteOverlayColorMaterial),e.scheduleOnce(function(){return e.setMaterial(0,r.default.instance.builtinSpriteMaterial)},l.CommonEnemiesConfig.damageWhiteFlashTime),p.stunnedTimeLeft=p.stunnedTime},p=this,d=0,f=this.bodySprites;d<f.length;d++){h(f[d])}this.health<=0?(this.node.destroy(),r.default.instance.spawnPuff(this.node.position.add(cc.v2(0,-25)),r.default.actorColorToEnemyPuffType(this.colorType)),r.default.instance.shakeCamera(r.CameraShakeLevel.MEDIUM),r.default.instance.spawnCollectables(this.node.position,this.cookiesSpawnCount),u.default.getInstance().audioManager.playSfxKillEnemy()):(u.default.getInstance().audioManager.playSfxHitEnemy(),r.default.instance.shakeCamera(r.CameraShakeLevel.LOW))}if(i.tag,r.ColliderTag.PLATFORM,i.tag==r.ColliderTag.TERRAIN&&l.GreenFlyingChaserEnemyConfig.enableTerrainCollisions){var m=e.getWorldManifold().normal;0==m.x?this.moveVelocity=cc.v2(this.moveVelocity.x,-this.moveVelocity.y):this.moveVelocity=cc.v2(-this.moveVelocity.x,this.moveVelocity.y);var g=o.xMax-n.xMin,y=n.xMax-o.xMin,v=o.yMax-n.yMin,C=n.yMax-o.yMin;0==m.y?1==m.x?this.adjustPositionOffset.x=-y:this.adjustPositionOffset.x=g:1==m.y?this.adjustPositionOffset.y=-C:this.adjustPositionOffset.y=v,this.body.linearVelocity=this.moveVelocity}},t.prototype.onPreSolve=function(e,t,i){},t.prototype.onEndContact=function(e,t,i){},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.characterAnimation.pause(),this.wingsAnimation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.characterAnimation.resume(),this.wingsAnimation.resume()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.body=this.getComponent(cc.RigidBody),this.spriteNode=this.node.getChildByName("sprite"),this.characterAnimation=this.spriteNode.getComponent(cc.Animation),this.wingsAnimation=cc.find("base/node_bee/node_wings",this.spriteNode).getComponent(cc.Animation),this.doesDamage=this.getComponent(c.default),this.bodySprites=s.getAllSubChildrenSprites(this.spriteNode)},t.prototype.start=function(){this.colorType==h.ActorColorType.GREEN?(this.health=l.GreenFlyingChaserEnemyConfig.health,this.stunnedTime=l.GreenFlyingChaserEnemyConfig.stunnedTime,this.cookiesSpawnCount=l.GreenFlyingChaserEnemyConfig.cookiesSpawnCount,this.initialPosition=cc.v2(this.node.position),this.detectionDistance=l.GreenFlyingChaserEnemyConfig.detectionRange*r.default.TILE_SIZE.width,this.detectionDistanceSqr=this.detectionDistance*this.detectionDistance,this.nearPositioningDistance=l.GreenFlyingChaserEnemyConfig.nearPositioningRange*r.default.TILE_SIZE.width,this.nearPositioningDistanceSqr=this.nearPositioningDistance*this.nearPositioningDistance,this.maxMoveSpeed=l.GreenFlyingChaserEnemyConfig.maxMoveSpeed*r.default.TILE_SIZE.width,this.maxMoveSpeedSqr=this.maxMoveSpeed*this.maxMoveSpeed,this.moveAcceleration=this.maxMoveSpeed/Math.max(l.GreenFlyingChaserEnemyConfig.moveAccelerationTime,1e-4),this.knockbackVelocity=r.default.TILE_SIZE.width*l.GreenFlyingChaserEnemyConfig.knockbackSpeed,this.knockbackFriction=this.knockbackVelocity/Math.max(l.GreenFlyingChaserEnemyConfig.knockbackFrictionTime,1e-4),this.doesDamage.touchDamage=l.GreenFlyingChaserEnemyConfig.touchDamage):(this.health=l.PinkFlyingChaserEnemyConfig.health,this.stunnedTime=l.PinkFlyingChaserEnemyConfig.stunnedTime,this.cookiesSpawnCount=l.PinkFlyingChaserEnemyConfig.cookiesSpawnCount,this.initialPosition=cc.v2(this.node.position),this.detectionDistance=l.PinkFlyingChaserEnemyConfig.detectionRange*r.default.TILE_SIZE.width,this.detectionDistanceSqr=this.detectionDistance*this.detectionDistance,this.nearPositioningDistance=l.PinkFlyingChaserEnemyConfig.nearPositioningRange*r.default.TILE_SIZE.width,this.nearPositioningDistanceSqr=this.nearPositioningDistance*this.nearPositioningDistance,this.maxMoveSpeed=l.PinkFlyingChaserEnemyConfig.maxMoveSpeed*r.default.TILE_SIZE.width,this.maxMoveSpeedSqr=this.maxMoveSpeed*this.maxMoveSpeed,this.moveAcceleration=this.maxMoveSpeed/Math.max(l.PinkFlyingChaserEnemyConfig.moveAccelerationTime,1e-4),this.knockbackVelocity=r.default.TILE_SIZE.width*l.PinkFlyingChaserEnemyConfig.knockbackSpeed,this.knockbackFriction=this.knockbackVelocity/Math.max(l.PinkFlyingChaserEnemyConfig.knockbackFrictionTime,1e-4),this.doesDamage.touchDamage=l.PinkFlyingChaserEnemyConfig.touchDamage)},t.prototype.update=function(e){this.state;if(this.stunnedTimeLeft>0&&(this.stunnedTimeLeft-=e,this.state=a.STUNNED,this.stunnedTimeLeft<=0&&(this.stunnedTimeLeft=0,this.state=a.IDLE)),0==this.adjustPositionOffset.x&&0==this.adjustPositionOffset.y||(this.node.position=this.node.position.add(this.adjustPositionOffset),this.adjustPositionOffset.x=0,this.adjustPositionOffset.y=0),this.state!=a.STUNNED){this.node.position.sub(this.initialPosition).magSqr();var t=r.default.instance.playerNode.position.add(cc.v2(0,this.playerOffset.y)),i=t.sub(this.initialPosition).magSqr(),n=cc.v2(t);this.node.position.sub(t).magSqr()>this.nearPositioningDistanceSqr&&(n.x<this.node.position.x?n.x+=this.nearPositioningDistance:n.x-=this.nearPositioningDistance);var o=void 0;i<=this.detectionDistanceSqr?(this.state=a.CHASING,o=n.sub(this.node.position).normalizeSelf()):(this.state=a.IDLE,o=this.initialPosition.sub(this.node.position).normalizeSelf());var c=o.mul(this.moveAcceleration*e);this.moveVelocity.addSelf(c),this.moveVelocity.magSqr()>this.maxMoveSpeedSqr&&this.moveVelocity.normalizeSelf().mulSelf(this.maxMoveSpeed)}this.state==a.STUNNED&&this.moveVelocity.x<0&&(this.moveVelocity.x+=this.knockbackFriction*e,this.moveVelocity.x>0&&(this.moveVelocity.x=0)),this.state==a.STUNNED&&this.moveVelocity.x>0&&(this.moveVelocity.x-=this.knockbackFriction*e,this.moveVelocity.x<0&&(this.moveVelocity.x=0)),this.body.linearVelocity=this.moveVelocity,this.state!=a.STUNNED&&(this.moveVelocity.x>0&&(this.facingDirection=s.Direction.RIGHT),this.moveVelocity.x<0&&(this.facingDirection=s.Direction.LEFT),this.facingDirection==s.Direction.LEFT?this.spriteNode.scaleX=1:this.spriteNode.scaleX=-1),this.state!=this.prevState&&(this.state==a.IDLE&&this.characterAnimation.play("flying",0),this.state==a.CHASING&&(this.characterAnimation.play("flying",0),u.default.getInstance().audioManager.playSfx(p.SFXKey.enemy_bee1)),this.state==a.STUNNED&&this.characterAnimation.play("hit",0)),this.prevState=this.state},o([g({type:cc.Enum(h.ActorColorType)})],t.prototype,"colorType",void 0),t=o([m],t)}(d.default);i.default=y,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Config":"Config","./DoesDamage":"DoesDamage","./Game":"Game","./PausableComponent":"PausableComponent","./Placeholder":"Placeholder"}],FocusHandler:[function(e,t,i){"use strict";cc._RF.push(t,"30c1bEaAq9OUJ98BFKfeG5Z","FocusHandler"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Singleton"),o=e("./RotateScreenManager"),a=e("../game/Game"),s=function(){function e(){var e=this;this.onBlur=[],this.onFocus=[],this.s=n.default.getInstance();var t=function(){e.s.audioManager.resume(),cc.game.resume(),e.invoke(e.onFocus)},i=function(){e.invoke(e.onBlur),e.s.audioManager.pause(),cc.game.pause(),a.default.instance&&a.default.instance.getPlayer().resetInput()};cc.game.on(cc.game.EVENT_HIDE,i,this),cc.game.on(cc.game.EVENT_SHOW,t,this),window.onfocus=t,window.onclick=t,window.onblur=i,this.s.rotateScreen.on(o.default.KEY_SIGNAL_CORRECT,t,this),this.s.rotateScreen.on(o.default.KEY_SIGNAL_INCORRECT,i,this)}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.initialize=function(){this.instance},e.subscribeOnBlur=function(e){this.instance.subscribe(this.instance.onBlur,e)},e.unsubscribeOnBlur=function(e){this.instance.unsubscribe(this.instance.onBlur,e)},e.subscribeOnFocus=function(e){this.instance.subscribe(this.instance.onFocus,e)},e.unsubscribeOnFocus=function(e){this.instance.unsubscribe(this.instance.onFocus,e)},e.prototype.subscribe=function(e,t){t&&-1===e.indexOf(t)&&e.push(t)},e.prototype.unsubscribe=function(e,t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)},e.prototype.invoke=function(e){for(var t=0,i=e;t<i.length;t++){(0,i[t])()}},e}();i.default=s,cc._RF.pop()},{"../game/Game":"Game","./RotateScreenManager":"RotateScreenManager","./Singleton":"Singleton"}],GameoverController:[function(e,t,i){"use strict";cc._RF.push(t,"a3f082hLvpFB4IFkjl8ghib","GameoverController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../game/UpgradesManager"),s=e("../game/controllers/TransitionController"),r=e("../core/CheatManager"),c=e("../core/Singleton"),l=e("../core/DataManager"),h=e("../core/audio/AudioScene"),u=cc._decorator,p=u.ccclass,d=u.property,f=u.menu,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transition=null,t.changingScene=!1,t.doTransitionOrLoading=!0,t}return n(t,e),t.prototype.changeScene=function(e){this.changingScene||(c.default.getInstance().audioManager.playSfx(h.SFXKey.button_generic),this.changingScene=!0,this.transition&&this.doTransitionOrLoading?this.showTransition(function(){cc.director.loadScene(e)}):cc.director.loadScene(e))},t.prototype.changeSceneAsEvent=function(e,t){var i=c.default.getInstance().dataManager.getSeeComicEnd();a.default.instance.lastPlayedLevelIsBoss&&3===a.default.instance.lastPlayedLevelNumber&&a.default.instance.lastLevelWasCompleted&&!i?this.changeScene("comic"):this.changeScene(t)},t.prototype.reloadLastLevel=function(){var e=a.default.instance.getLastPlayedLevelSceneName();e&&this.changeScene(e)},t.prototype.disableTransitionOrLoading=function(){this.doTransitionOrLoading=!1},t.prototype.showTransition=function(e){this.transition&&this.transition.showTransition(e.bind(this))},t.prototype.clearTransitionReference=function(){this.transition=null},t.prototype.showMenu=function(){this.node.active=!0},t.prototype.hideMenu=function(){this.node.active=!1},t.prototype.onLoad=function(){this.transition&&(this.transition.node.active=!0)},t.prototype.start=function(){c.default.getInstance().audioManager.stopMusic(),r.default.instances.initCheatMainMenu(),this.getElementUI(),this.updateUI(),this.transition&&(this.transition.hideLoader(),this.playAnimationIn())},t.prototype.playMusicMenu=function(){c.default.getInstance().audioManager.playMusic(h.HowlsKey.music_menu)},t.prototype.getElementUI=function(){var e;this.levelCompleteNode=cc.find("Canvas/level_complete"),this.bossCompleteNode=cc.find("Canvas/level_complete_boss"),this.levelFailedNode=cc.find("Canvas/level_failed"),this.buttonContinue=cc.find("Canvas/level_complete_boss/bottom_container/play_container/play").getComponent(cc.Button),this.levelFailedTitle=cc.find("Canvas/level_failed/title_container/title").getComponent(cc.Label),this.levelRetryTitle=cc.find("Canvas/level_failed/bottom_container/title").getComponent(cc.Label),this.levelCompletedTitle=cc.find("Canvas/level_complete/title_container/base/title").getComponent(cc.Label),this.levelCompletedBossTitle=cc.find("Canvas/level_complete_boss/title_container/title").getComponent(cc.Label),this.levelFailedTitle.string=c.default.getInstance().getLocalizationString("level_failed"),this.levelRetryTitle.string=c.default.getInstance().getLocalizationString("confirmation_retry"),this.levelCompletedTitle.string=c.default.getInstance().getLocalizationString("level_complete"),this.levelCompletedBossTitle.string=c.default.getInstance().getLocalizationString("level_complete"),"ar"!==c.default.getInstance().localizationManager.locale&&"tr"!==c.default.getInstance().localizationManager.locale&&"pl"!==c.default.getInstance().localizationManager.locale&&"no"!==c.default.getInstance().localizationManager.locale&&"bg"!==c.default.getInstance().localizationManager.locale||(this.levelFailedTitle.fontSize=55,this.levelFailedTitle.lineHeight=55,this.levelFailedTitle.node.height=80,this.levelFailedTitle.node.width=560),"fr"!==c.default.getInstance().localizationManager.locale&&"no"!==c.default.getInstance().localizationManager.locale||(this.levelCompletedTitle.lineHeight=this.levelCompletedTitle.fontSize+30,this.levelCompletedTitle.node.height=this.levelCompletedTitle.fontSize+30),this.levelFailedTitle.font=c.default.getInstance().getLocalizationFont(this.levelFailedTitle.font),this.levelRetryTitle.font=c.default.getInstance().getLocalizationFont(this.levelRetryTitle.font),this.levelCompletedTitle.font=c.default.getInstance().getLocalizationFont(this.levelCompletedTitle.font),this.levelCompletedBossTitle.font=c.default.getInstance().getLocalizationFont(this.levelCompletedBossTitle.font),this.buttonContinue.interactable=!1,this.levelCompleteNode.children[0].getComponent(cc.Widget).updateAlignment(),this.bossCompleteNode.children[0].getComponent(cc.Widget).updateAlignment(),this.levelFailedNode.children[0].getComponent(cc.Widget).updateAlignment(),this.snarfFoundNodes=[];for(var t=0;t<3;t++)e="title_container/base/snarf_empty"+(t+1)+"/snarf_full"+(t+1),this.snarfFoundNodes[t]=cc.find(e,this.levelCompleteNode)},t.prototype.updateUI=function(){if(this.levelCompleteNode&&this.levelFailedNode)if(a.default.instance.lastLevelWasCompleted)if(a.default.instance.shouldUnlockNextLevel()&&a.default.instance.unlockNextLevel(),this.levelFailedNode.active=!1,a.default.instance.lastPlayedLevelIsBoss)this.levelCompleteNode.active=!1,this.bossCompleteNode.active=!0;else{var e=void 0,t=a.default.instance.getLastPlayedLevelCollectables(),i=c.default.getInstance().dataManager.getLocalKey(l.LocalDataKey.snarfFounds);if(!t)return;t.foundFirst&&(e=this.snarfFoundNodes[0].getComponent(cc.Animation),i[0]||e.play("PLAY_snarf_full",e.getClips()[0].duration)),t.foundSecond&&(e=this.snarfFoundNodes[1].getComponent(cc.Animation),i[1]||e.play("PLAY_snarf_full",e.getClips()[0].duration)),t.foundThird&&(e=this.snarfFoundNodes[2].getComponent(cc.Animation),i[2]||e.play("PLAY_snarf_full",e.getClips()[0].duration)),this.levelCompleteNode.active=!0,this.bossCompleteNode.active=!1}else this.levelCompleteNode.active=!1,this.bossCompleteNode.active=!1,this.levelFailedNode.active=!0},t.prototype.playAnimationIn=function(){var e,t;a.default.instance.lastLevelWasCompleted?a.default.instance.lastPlayedLevelIsBoss?(t=c.default.getInstance().audioManager.playSfx(h.SFXKey.level_completed2),e=this.bossCompleteNode.getComponent(cc.Animation)):(t=c.default.getInstance().audioManager.playSfx(h.SFXKey.level_completed1),e=this.levelCompleteNode.getComponent(cc.Animation)):(t=c.default.getInstance().audioManager.playSfx(h.SFXKey.level_failed),e=this.levelFailedNode.getComponent(cc.Animation)),this.scheduleOnce(this.playMusicMenu.bind(this),c.default.getInstance().audioManager.getSfxDuration(t)),this.animation=e,e.play(e.getClips()[0].name),e.on("finished",this.playAnimationInStep2,this)},t.prototype.playAnimationInStep2=function(){if(this.animation.off("finished",this.playAnimationInStep2,this),a.default.instance.lastLevelWasCompleted&&!a.default.instance.lastPlayedLevelIsBoss){var e=void 0,t=a.default.instance.getLastPlayedLevelCollectables(),i=c.default.getInstance().dataManager.getLocalKey(l.LocalDataKey.snarfFounds);if(!t)return;this.currentAnimation=0,this.animationCompleted=[],t.foundFirst&&i[0]&&(e=this.snarfFoundNodes[0].getComponent(cc.Animation),this.animationCompleted.push(e)),t.foundSecond&&i[1]&&(e=this.snarfFoundNodes[1].getComponent(cc.Animation),this.animationCompleted.push(e)),t.foundThird&&i[2]&&(e=this.snarfFoundNodes[2].getComponent(cc.Animation),this.animationCompleted.push(e)),c.default.getInstance().dataManager.setLocalKey(l.LocalDataKey.snarfFounds,[!1,!1,!1]),this.playCompleted()}else this.buttonContinue.interactable=!0},t.prototype.playCompleted=function(){var e;this.currentAnimation<this.animationCompleted.length?(c.default.getInstance().audioManager.playSfx(h.SFXKey.snarf1+this.currentAnimation),e=this.animationCompleted[this.currentAnimation],this.currentAnimation++,e.play("PLAY_snarf_full",0),e.once(cc.Animation.EventType.FINISHED,this.playCompleted,this)):this.buttonContinue.interactable=!0},t.prototype.onDestroy=function(){r.default.instances.endCheat()},o([d(s.default)],t.prototype,"transition",void 0),t=o([p,f("Game Component/GameoverController")],t)}(cc.Component);i.default=m,cc._RF.pop()},{"../core/CheatManager":"CheatManager","../core/DataManager":"DataManager","../core/Singleton":"Singleton","../core/audio/AudioScene":"AudioScene","../game/UpgradesManager":"UpgradesManager","../game/controllers/TransitionController":"TransitionController"}],GameplayUIController:[function(e,t,i){"use strict";cc._RF.push(t,"adc4euwcrtAFpX4WB3XnKfQ","GameplayUIController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../game/controllers/StageController"),s=e("../game/controllers/TransitionController"),r=e("../core/Singleton"),c=e("../game/UpgradesManager"),l=e("./ConfirmationController"),h=e("./PauseController"),u=e("./TutorialController"),p=e("../core/audio/AudioScene"),d=e("../input/MobileInputController"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameUIPrefab=null,t.pauseUIPrefab=null,t.mobileInputPrefab=null,t.confirmationPrefab=null,t.transitionPrefab=null,t.tutorialPrefab=null,t.gameUINode=null,t.pauseNode=null,t.confirmationNode=null,t.mobileInputNode=null,t.transitionNode=null,t.tutorialNode=null,t.transition=null,t.confirmation=null,t.pause=null,t.tutorialController=null,t.uiPlayerLifeBarNode=null,t.uiBossLifeBarNode=null,t.uiCollectablesNode=null,t.uiCookiesCountLabel=null,t.uiAmmoCountLabel=null,t.lifeContainerNode=null,t.lifeBarNode=null,t.lifeIconNode=null,t.lifeExtraAnimation=null,t.snarfContainer=null,t.snarfFoundNode=[],t}return n(t,e),t.prototype.onLoad=function(){this.gameUINode=cc.instantiate(this.gameUIPrefab),this.pauseNode=cc.instantiate(this.pauseUIPrefab),this.mobileInputNode=cc.instantiate(this.mobileInputPrefab),this.confirmationNode=cc.instantiate(this.confirmationPrefab),this.tutorialNode=cc.instantiate(this.tutorialPrefab),this.transitionNode=cc.instantiate(this.transitionPrefab),this.node.addChild(this.gameUINode),this.node.addChild(this.mobileInputNode),this.node.addChild(this.pauseNode),this.node.addChild(this.confirmationNode),this.node.addChild(this.tutorialNode),this.node.addChild(this.transitionNode),this.getUIElements(),this.transition&&(this.transition.node.active=!0),this.addTouchListener()},t.prototype.getUIElements=function(){var e;this.buttonPause=this.gameUINode.getChildByName("pause").getComponent(cc.Button),this.transition=this.transitionNode.getComponent(s.default),this.pause=this.pauseNode.getComponent(h.default),this.confirmation=this.confirmationNode.getComponent(l.default),this.tutorialController=this.tutorialNode.getComponent(u.default),this.lifeExtraAnimation=cc.find("extra_life",this.gameUINode).getComponent(cc.Animation),this.uiPlayerLifeBarNode=cc.find("life_bar",this.gameUINode),this.uiCookiesCountLabel=cc.find("node_counters/cookies/count",this.gameUINode).getComponent(cc.Label),this.uiAmmoCountLabel=cc.find("node_counters/bomb/count",this.gameUINode).getComponent(cc.Label),this.lifeContainerNode=cc.find("boss_life_bar_container",this.gameUINode),this.lifeBarNode=cc.find("boss_life_bar",this.gameUINode),this.lifeIconNode=cc.find("boss_life_icon",this.gameUINode),this.snarfFoundNode=[],this.snarfContainer=cc.find("snarf_container",this.gameUINode);for(var t=0;t<3;t++)e="snarf_container/snarf_empty"+(t+1)+"/snarf_full"+(t+1),this.snarfFoundNode[t]=cc.find(e,this.gameUINode);this.lifeContainerNode.active=!1,this.lifeBarNode.active=!1,this.lifeIconNode.active=!1},t.prototype.setGame=function(e){this.game=e},t.prototype.getSnarfFoundNode=function(e){return this.snarfFoundNode[e]},t.prototype.addTouchListener=function(){var e;(e=new cc.Component.EventHandler).target=this.node,e.component="GameplayUIController",e.handler="pauseGame",this.buttonPause.clickEvents.push(e),this.pauseNode.on(h.default.KEY_SIGNAL_RESUME,this.pauseGame,this),this.pauseNode.on(h.default.KEY_SIGNAL_HOME,this.showConfirmation,this),this.pauseNode.on(h.default.KEY_SIGNAL_TUTORIAL,this.showTutorial,this),this.pauseNode.on(h.default.KEY_SIGNAL_OUT_COMPLETED,this.hidePauseMenuStep2,this),this.confirmationNode.on(l.default.KEY_SIGNAL_YES,this.onConfirmationYes,this),this.confirmationNode.on(l.default.KEY_SIGNAL_NO,this.onConfirmationNo,this)},t.prototype.showTutorial=function(){this.pause.disableButtons(),this.tutorialController.show(),this.tutorialController.node.on(u.default.KEY_SIGNAL_OUT_COMPLETED,this.onHideTutorial,this)},t.prototype.onHideTutorial=function(){this.pause.enableButtons(),this.tutorialController.node.off(u.default.KEY_SIGNAL_OUT_COMPLETED,this.onHideTutorial,this)},t.prototype.start=function(){this.transition&&this.transition.hideTransition(null),c.default.instance.howToLifeUnlocked&&(r.default.getInstance().dataManager.getSeeAnimationBar()?this.lifeExtraAnimation.play("IN_extra_life",.58):(r.default.getInstance().dataManager.seeAnimationBar(),this.lifeExtraAnimation.play("IN_extra_life",0).delay=.7))},t.prototype.updateUI=function(e){if(this.uiCookiesCountLabel.string=c.default.instance.cookiesCount.toString(),e)this.snarfContainer.active=!1;else{var t=c.default.instance.getLastPlayedLevelCollectables();if(!t)return;this.snarfFoundNode[0].active=t.foundFirst,this.snarfFoundNode[1].active=t.foundSecond,this.snarfFoundNode[2].active=t.foundThird}},t.prototype.showBossUI=function(){this.lifeContainerNode.active=!0,this.lifeBarNode.active=!0,this.lifeIconNode.active=!0,this.lifeContainerNode.opacity=0,this.lifeBarNode.opacity=0,this.lifeIconNode.opacity=0;cc.tween(this.lifeContainerNode).to(.5,{opacity:255}).start(),cc.tween(this.lifeBarNode).to(.5,{opacity:255}).start(),cc.tween(this.lifeIconNode).to(.5,{opacity:255}).start()},t.prototype.hideAllUI=function(){this.hidePauseButton(),cc.tween(this.node).to(.3,{opacity:0}).start()},t.prototype.pauseGame=function(){a.default.isGamePaused?(this.hidePauseMenu(),cc.systemEvent.emit("gameplay-resume")):(cc.systemEvent.emit("gameplay-pause"),this.showPauseMenu(),r.default.getInstance().audioManager.playSfx(p.SFXKey.button_pause))},t.prototype.showPauseButton=function(){this.buttonPause.node.active=!0},t.prototype.hidePauseButton=function(){this.buttonPause.node.active=!1},t.prototype.lockMobileButtons=function(){if(this.mobileInputNode&&cc.isValid(this.mobileInputNode)){var e=this.mobileInputNode.getComponent(d.default);e&&e.lockButtons()}},t.prototype.unlockMobileButtons=function(){if(this.mobileInputNode&&cc.isValid(this.mobileInputNode)){var e=this.mobileInputNode.getComponent(d.default);e&&e.unlockButtons()}},t.prototype.showPauseMenu=function(){this.pause.show(),this.gameUINode.active=!1,this.mobileInputNode&&(this.mobileInputNode.active=!1)},t.prototype.hidePauseMenu=function(){this.pause.hide()},t.prototype.hidePauseMenuStep2=function(){this.gameUINode.active=!0,this.mobileInputNode&&(this.mobileInputNode.active=!0)},t.prototype.showConfirmation=function(){this.pause.disableButtons(),this.confirmation.show()},t.prototype.onConfirmationYes=function(){r.default.getInstance().audioManager.changeVolumentMusic(!1),this.goToLevelSelect()},t.prototype.onConfirmationNo=function(){this.pause.enableButtons()},t.prototype.goToLevelSelect=function(){this.game.goToLevelSelect()},o([g(cc.Prefab)],t.prototype,"gameUIPrefab",void 0),o([g(cc.Prefab)],t.prototype,"pauseUIPrefab",void 0),o([g(cc.Prefab)],t.prototype,"mobileInputPrefab",void 0),o([g(cc.Prefab)],t.prototype,"confirmationPrefab",void 0),o([g(cc.Prefab)],t.prototype,"transitionPrefab",void 0),o([g(cc.Prefab)],t.prototype,"tutorialPrefab",void 0),t=o([m],t)}(cc.Component);i.default=y,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/audio/AudioScene":"AudioScene","../game/UpgradesManager":"UpgradesManager","../game/controllers/StageController":"StageController","../game/controllers/TransitionController":"TransitionController","../input/MobileInputController":"MobileInputController","./ConfirmationController":"ConfirmationController","./PauseController":"PauseController","./TutorialController":"TutorialController"}],Game:[function(e,t,i){"use strict";cc._RF.push(t,"db1c9DhfOhBsKY32lSbntto","Game");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s,r=e("./Placeholder"),c=e("./controllers/PlayerController"),l=e("./controllers/CameraController"),h=e("./DoesDamage"),u=e("../core/Utils"),p=e("./PatrollingPassiveEnemy"),d=e("./controllers/TransitionController"),f=e("./Projectile"),m=e("./FlyingBomberEnemy"),g=e("./AutoDestroySelf"),y=e("./StaticPassiveEnemy"),v=e("./Door"),C=e("../core/Singleton"),_=e("./FlyingChaserEnemy"),b=e("./Config"),S=e("./StaticMortarEnemy"),T=e("./PatrollingJumperEnemy"),E=e("./PatrollingAgressiveEnemy"),P=e("./Turret"),L=e("./Shaker"),A=e("./Crate"),I=e("./Collectable"),k=e("./UpgradesManager"),M=e("./AttackArea"),D=e("./Flames"),O=e("./BossShip"),R=e("./FinalBoss"),N=e("./StaticAgressiveEnemy"),w=e("./SpecialCollectable"),x=e("../Testing/TesterLevelData"),F=e("../menu/GameplayUIController"),B=e("../core/DataManager"),U=e("../core/ResizeScreenManager"),j=e("../core/audio/AudioScene"),G=e("./PausableComponent"),K=e("../../balance/AudioLevelConfig"),H=cc._decorator,Y=H.ccclass,V=H.property;(function(e){e[e.DEFAULT=0]="DEFAULT",e[e.PLAYER_BODY=100]="PLAYER_BODY",e[e.PLAYER_LEFT_GRAB=101]="PLAYER_LEFT_GRAB",e[e.PLAYER_RIGHT_GRAB=102]="PLAYER_RIGHT_GRAB",e[e.PLAYER_GROUND_BELOW=103]="PLAYER_GROUND_BELOW",e[e.PLAYER_ATTACK_AREA=104]="PLAYER_ATTACK_AREA",e[e.ENEMY_BODY=200]="ENEMY_BODY",e[e.ENEMY_DETECTION_AREA=201]="ENEMY_DETECTION_AREA",e[e.ENEMY_ATTACK_AREA=202]="ENEMY_ATTACK_AREA",e[e.DESTROYABLE=300]="DESTROYABLE",e[e.COLLECTABLE=301]="COLLECTABLE",e[e.BARRIER=302]="BARRIER",e[e.TERRAIN=900]="TERRAIN",e[e.PLATFORM=901]="PLATFORM",e[e.ICE_AREA=902]="ICE_AREA",e[e.MUD_AREA=903]="MUD_AREA",e[e.POISON_AREA=904]="POISON_AREA"})(i.ColliderTag||(i.ColliderTag={})),function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e[e.EXTREME=3]="EXTREME"}(a=i.CameraShakeLevel||(i.CameraShakeLevel={})),function(e){e[e.GREEN_ENEMY_PUFF=0]="GREEN_ENEMY_PUFF",e[e.PINK_ENEMY_PUFF=1]="PINK_ENEMY_PUFF",e[e.JUMP_DUST=2]="JUMP_DUST",e[e.LAND_DUST=3]="LAND_DUST",e[e.WATER_SPLASH=4]="WATER_SPLASH",e[e.POISON_SPLASH=5]="POISON_SPLASH",e[e.GREEN_PROJECTILE_PUFF=6]="GREEN_PROJECTILE_PUFF",e[e.PINK_PROJECTILE_PUFF=7]="PINK_PROJECTILE_PUFF",e[e.GREEN_BARRIER_PUFF=8]="GREEN_BARRIER_PUFF",e[e.PINK_BARRIER_PUFF=9]="PINK_BARRIER_PUFF"}(s=i.PuffType||(i.PuffType={}));var z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.placeholderPrefab=null,t.roundMarkerPrefab=null,t.playerPrefab=null,t.swampTunnelPrefab=null,t.mountainTunnelPrefab=null,t.pyramidTunnelPrefab=null,t.swampDoorPrefab=null,t.exitTunnelPrefab=null,t.smallCratePrefab=null,t.mediumCratePrefab=null,t.bigCratePrefab=null,t.greenBarrierPrefab=null,t.pinkBarrierPrefab=null,t.greenStaticPassiveEnemyPrefab=null,t.pinkStaticPassiveEnemyPrefab=null,t.greenStaticAgressiveEnemyPrefab=null,t.pinkStaticAgressiveEnemyPrefab=null,t.greenStaticMortarEnemyPrefab=null,t.pinkStaticMortarEnemyPrefab=null,t.greenPatrollingPassiveEnemyPrefab=null,t.pinkPatrollingPassiveEnemyPrefab=null,t.greenPatrollingJumperEnemyPrefab=null,t.pinkPatrollingJumperEnemyPrefab=null,t.greenPatrollingAgressiveEnemyPrefab=null,t.pinkPatrollingAgressiveEnemyPrefab=null,t.greenFlyingBomberEnemyPrefab=null,t.pinkFlyingBomberEnemyPrefab=null,t.greenFlyingChaserEnemyPrefab=null,t.pinkFlyingChaserEnemyPrefab=null,t.spikesPrefab=null,t.flamesPrefab=null,t.turretPrefab=null,t.greenTrapPlatformPrefab=null,t.pinkTrapPlatformPrefab=null,t.greenBomberProjectilePrefab=null,t.pinkBomberProjectilePrefab=null,t.greenMortarProjectilePrefab=null,t.pinkMortarProjectilePrefab=null,t.turretProjectilePrefab=null,t.playerProjectileVariant1Prefab=null,t.playerProjectileVariant2Prefab=null,t.playerProjectileVariant3Prefab=null,t.capsuleExplosionPrefab=null,t.cookiePrefab=null,t.cookieBatchPrefab=null,t.hearthPrefab=null,t.ammoBatchPrefab=null,t.specialCollectablePrefab=null,t.attackAreaPrefab=null,t.greenEnemyPuffPrefab=null,t.pinkEnemyPuffPrefab=null,t.greenProjectilePuffPrefab=null,t.pinkProjectilePuffPrefab=null,t.jumpDustPrefab=null,t.landDustPrefab=null,t.waterSplashPrefab=null,t.poisonSplashPrefab=null,t.greenBarrierPuffPrefab=null,t.pinkBarrierPuffPrefab=null,t.spriteOverlayColorMaterial=null,t.builtinSpriteMaterial=null,t.spineOverlayColorMaterial=null,t.builtinSpineMaterial=null,t.swampBackgroundSprite=null,t.mountainBackgroundSprite=null,t.pyramidBackgroundSprite=null,t.fullscreenQuadPrefab=null,t.uiPrefab=null,t.originalCalculateDeltaTime=null,t.timeScaleFactor=1,t.prevTimeScaleFactor=t.timeScaleFactor,t.actorsBackLayer=null,t.actorsMiddleLayer=null,t.actorsFrontLayer=null,t.actorsSuperFrontLayer=null,t.levelDoors=[],t.entryNodeName="",t.playerSpawnNode=null,t.playerNode=null,t.transition=null,t.gravity=0,t.sceneName="",t.persistencyStates=new Object,t.worldMapSize=cc.Size.ZERO,t.isBossStage=!1,t.levelNumber=0,t.bossLevelMaxHeight=7,t.initSection=!1,t}var i;return n(t,e),i=t,Object.defineProperty(t,"instance",{get:function(){return i._instance},enumerable:!0,configurable:!0}),t.doubleError=function(e){console.error(e)},t.actorColorToEnemyPuffType=function(e){return e==r.ActorColorType.GREEN?s.GREEN_ENEMY_PUFF:s.PINK_ENEMY_PUFF},t.prototype.createLayers=function(){var e=cc.find(i.TILEMAP_NODE_PATH);if(e)if(e.getChildByName(i.TERRAIN_NODE_NAME)){var t=e.getChildByName(i.WATER_NODE_NAME);if(t){var n=cc.find(i.TUTORIAL_PATCH_NODE_PATH);if(n){n.active=!u.isMobile();for(var o=0,a=n.children;o<a.length;o++){"attackKey"==(c=a[o]).name&&(c.getComponent(cc.Label).string=C.default.getInstance().attackKey.toUpperCase()),"specialKey"==c.name&&(c.getComponent(cc.Label).string=C.default.getInstance().specialKey.toUpperCase())}}this.actorsBackLayer=new cc.Node("actors back layer"),this.actorsMiddleLayer=new cc.Node("actors middle layer"),this.actorsFrontLayer=new cc.Node("actors front layer"),this.actorsSuperFrontLayer=new cc.Node("actors super front layer"),e.insertChild(this.actorsBackLayer,t.getSiblingIndex()),e.insertChild(this.actorsMiddleLayer,t.getSiblingIndex()),e.insertChild(this.actorsFrontLayer,t.getSiblingIndex()),e.addChild(this.actorsSuperFrontLayer),console.info("level nodes: ");for(var s=0,r=e.children;s<r.length;s++){var c=r[s];console.info("  "+c.name)}}else console.error("water node not found!")}else console.error("terrain node not found!");else console.error("level node not found!")},t.prototype.addPlaceholder=function(e,t,n){var o=cc.find(i.PLACEHOLDERS_NODE_PATH);if(o)switch(e){case r.PlaceholderType.SPIKES:var a=cc.instantiate(this.placeholderPrefab);a.getComponent(r.default).type=e,a.name="static spikes generated from tilemap",a.position=t,a.angle=r.default.directionToAngle(n),o.addChild(a)}else console.error("placeholders node not found!")},t.prototype.spawnActors=function(){var e=cc.find(i.PLACEHOLDERS_NODE_PATH);if(e){e.active=!1;var t=k.default.instance.getLastPlayedLevelCollectables(),n=0;this.levelDoors=[];for(var o=0,a=e.children;o<a.length;o++){var s=a[o],c=s.getComponent(r.default);if(c)switch(x.default.instances.addSpawnCookie(c.classType,c.sizeType,c.colorType),c.classType){case r.ActorClassType.PLAYER:if(this.playerNode&&this.entryNodeName){console.info("found previous player node... ignoring player placeholder!");break}console.info("using player placeholder as spawn node!"),this.playerSpawnNode=s;break;case r.ActorClassType.LEVEL_TUNNEL:var l=null;c.worldType==r.ActorWorldType.SWAMP?l=cc.instantiate(this.swampTunnelPrefab):c.worldType==r.ActorWorldType.MOUNTAIN?l=cc.instantiate(this.mountainTunnelPrefab):c.worldType==r.ActorWorldType.PYRAMID&&(l=cc.instantiate(this.pyramidTunnelPrefab)),this.setupPlaceholderInstance(c,l),console.info("level tunnel placeholder: "+c.sceneToLoad+" "+c.entryName),(d=l.getComponent("Finish")).sceneName=c.sceneToLoad,d.entryNodeName=c.entryName,d.facingDirection=c.initialDirection,d.classType=r.ActorClassType.LEVEL_TUNNEL,d.worldType=c.worldType,d.variantType=c.variantType,this.actorsBackLayer.addChild(l);break;case r.ActorClassType.LEVEL_DOOR:var h=cc.instantiate(this.swampDoorPrefab);this.setupPlaceholderInstance(c,h);var u=h.getComponent(v.default);u.placeholderNodeName=c.node.name,u.sceneName=c.sceneToLoad,u.entryNodeName=c.entryName,u.facingDirection=c.initialDirection,u.worldType=c.worldType,this.actorsBackLayer.addChild(h),this.levelDoors.push(u);break;case r.ActorClassType.LEVEL_EXIT:var d;l=cc.instantiate(this.exitTunnelPrefab);this.setupPlaceholderInstance(c,l),(d=l.getComponent("Finish")).sceneName="",d.entryNodeName="",d.facingDirection=c.initialDirection,d.classType=r.ActorClassType.LEVEL_EXIT,this.actorsBackLayer.addChild(l);break;case r.ActorClassType.CRATE:++n;var f=this.sceneName+"/id"+n;if(void 0===this.persistencyStates[f]&&(this.persistencyStates[f]=!1),1==this.persistencyStates[f])break;var g=null;c.sizeType==r.ActorSizeType.SMALL?g=cc.instantiate(this.smallCratePrefab):c.sizeType==r.ActorSizeType.MEDIUM?g=cc.instantiate(this.mediumCratePrefab):c.sizeType==r.ActorSizeType.BIG&&(g=cc.instantiate(this.bigCratePrefab)),this.setupPlaceholderInstance(c,g);var C=g.getComponent(A.default);C.persistentKey=f,this.actorsBackLayer.addChild(g),C.facingDirection=c.initialDirection;break;case r.ActorClassType.BARRIER:var L=null;c.colorType==r.ActorColorType.GREEN?L=cc.instantiate(this.greenBarrierPrefab):c.colorType==r.ActorColorType.PINK&&(L=cc.instantiate(this.pinkBarrierPrefab)),this.setupPlaceholderInstance(c,L),this.actorsBackLayer.addChild(L);break;case r.ActorClassType.SPIKES:var I=cc.instantiate(this.spikesPrefab);this.setupPlaceholderInstance(c,I),this.actorsMiddleLayer.addChild(I);break;case r.ActorClassType.FLAMES:var M=cc.instantiate(this.flamesPrefab);this.setupPlaceholderInstance(c,M),M.getComponent(D.default).delayFactor=c.syncDelayFactor,this.actorsMiddleLayer.addChild(M);break;case r.ActorClassType.TRAP_PLATFORM:var O=null;c.colorType==r.ActorColorType.GREEN?O=cc.instantiate(this.greenTrapPlatformPrefab):c.colorType==r.ActorColorType.PINK&&(O=cc.instantiate(this.pinkTrapPlatformPrefab)),this.setupPlaceholderInstance(c,O),this.actorsBackLayer.addChild(O);break;case r.ActorClassType.TURRET:var R=cc.instantiate(this.turretPrefab);this.setupPlaceholderInstance(c,R),R.getComponent(P.default).facingDirection=c.initialDirection,this.actorsFrontLayer.addChild(R);break;case r.ActorClassType.STATIC_PASSIVE_ENEMY:var F=null;c.colorType==r.ActorColorType.GREEN?F=cc.instantiate(this.greenStaticPassiveEnemyPrefab):c.colorType==r.ActorColorType.PINK&&(F=cc.instantiate(this.pinkStaticPassiveEnemyPrefab)),F.getComponent(y.default).facingDirection=c.initialDirection,this.setupPlaceholderInstance(c,F),this.actorsMiddleLayer.addChild(F);break;case r.ActorClassType.STATIC_AGRESSIVE_ENEMY:F=null;c.colorType==r.ActorColorType.GREEN?F=cc.instantiate(this.greenStaticAgressiveEnemyPrefab):c.colorType==r.ActorColorType.PINK&&(F=cc.instantiate(this.pinkStaticAgressiveEnemyPrefab)),this.setupPlaceholderInstance(c,F),this.actorsMiddleLayer.addChild(F),F.getComponent(N.default).facingDirection=c.initialDirection;break;case r.ActorClassType.STATIC_MORTAR_ENEMY:F=null;c.colorType==r.ActorColorType.GREEN?F=cc.instantiate(this.greenStaticMortarEnemyPrefab):c.colorType==r.ActorColorType.PINK&&(F=cc.instantiate(this.pinkStaticMortarEnemyPrefab)),this.setupPlaceholderInstance(c,F),F.getComponent(S.default).facingDirection=c.initialDirection,this.actorsMiddleLayer.addChild(F);break;case r.ActorClassType.PATROLLING_PASSIVE_ENEMY:F=null;c.colorType==r.ActorColorType.GREEN?F=cc.instantiate(this.greenPatrollingPassiveEnemyPrefab):c.colorType==r.ActorColorType.PINK&&(F=cc.instantiate(this.pinkPatrollingPassiveEnemyPrefab)),this.setupPlaceholderInstance(c,F),(B=F.getComponent(p.default)).leftLimitTiles=c.leftLimitTiles,B.rightLimitTiles=c.rightLimitTiles,B.initialDirection=c.initialDirection,this.actorsMiddleLayer.addChild(F);break;case r.ActorClassType.PATROLLING_JUMPER_ENEMY:F=null;c.colorType==r.ActorColorType.GREEN?F=cc.instantiate(this.greenPatrollingJumperEnemyPrefab):c.colorType==r.ActorColorType.PINK&&(F=cc.instantiate(this.pinkPatrollingJumperEnemyPrefab)),this.setupPlaceholderInstance(c,F),(B=F.getComponent(T.default)).initialDirection=c.initialDirection,this.actorsMiddleLayer.addChild(F);break;case r.ActorClassType.PATROLLING_AGRESSIVE_ENEMY:var B;F=null;c.colorType==r.ActorColorType.GREEN?F=cc.instantiate(this.greenPatrollingAgressiveEnemyPrefab):c.colorType==r.ActorColorType.PINK&&(F=cc.instantiate(this.pinkPatrollingAgressiveEnemyPrefab)),this.setupPlaceholderInstance(c,F),(B=F.getComponent(E.default)).leftLimitTiles=c.leftLimitTiles,B.rightLimitTiles=c.rightLimitTiles,B.initialDirection=c.initialDirection,this.actorsMiddleLayer.addChild(F);break;case r.ActorClassType.FLYING_BOMBER_ENEMY:F=null;c.colorType==r.ActorColorType.GREEN?F=cc.instantiate(this.greenFlyingBomberEnemyPrefab):c.colorType==r.ActorColorType.PINK&&(F=cc.instantiate(this.pinkFlyingBomberEnemyPrefab)),this.setupPlaceholderInstance(c,F);var U=F.getComponent(m.default);U.leftLimitTiles=c.leftLimitTiles,U.rightLimitTiles=c.rightLimitTiles,U.initialDirection=c.initialDirection,this.actorsMiddleLayer.addChild(F);break;case r.ActorClassType.FLYING_CHASER_ENEMY:F=null;c.colorType==r.ActorColorType.GREEN?F=cc.instantiate(this.greenFlyingChaserEnemyPrefab):c.colorType==r.ActorColorType.PINK&&(F=cc.instantiate(this.pinkFlyingChaserEnemyPrefab)),this.setupPlaceholderInstance(c,F);F.getComponent(_.default);b.GreenFlyingChaserEnemyConfig.enableTerrainCollisions?this.actorsMiddleLayer.addChild(F):this.actorsSuperFrontLayer.addChild(F);break;case r.ActorClassType.SPECIAL_COLLECTABLE:var j=!1;if(t&&t.foundFirst&&c.orderType==r.ActorOrderType.FIRST&&(j=!0),t&&t.foundSecond&&c.orderType==r.ActorOrderType.SECOND&&(j=!0),t&&t.foundThird&&c.orderType==r.ActorOrderType.THIRD&&(j=!0),j)break;var G=cc.instantiate(this.specialCollectablePrefab);this.setupPlaceholderInstance(c,G),G.getComponent(w.default).order=c.orderType,this.actorsBackLayer.addChild(G)}}}else console.error("placeholders node not found!")},t.prototype.spawnPlayer=function(){var e=this;console.info("playerNode: "+this.playerNode),this.playerNode||(this.playerNode=cc.instantiate(this.playerPrefab)),console.info("playerSpawnNode: "+this.playerSpawnNode),this.entryNodeName||console.info("entryNodeName is null!"),null!=this.entryNodeName&&""!=this.entryNodeName&&(console.info("entryNodeName: "+this.entryNodeName),console.info("searching for "+i.PLACEHOLDERS_NODE_PATH+"/"+this.entryNodeName),this.playerSpawnNode=cc.find(i.PLACEHOLDERS_NODE_PATH+"/"+this.entryNodeName),this.playerSpawnNode||console.error("playerSpawnNode not found!")),console.info((this.playerSpawnNode,this.playerSpawnNode.name?this.playerSpawnNode.name:"---"));var t=this.playerSpawnNode.getComponent(r.default),n=cc.v2(0,0);if(t.classType==r.ActorClassType.PLAYER);else if(t.classType==r.ActorClassType.LEVEL_TUNNEL)n=t.initialDirection==u.Direction.LEFT?cc.v2(-50,0):cc.v2(50,0);else if(t.classType==r.ActorClassType.LEVEL_DOOR){var o=this.levelDoors.filter(function(t){return t.placeholderNodeName==e.entryNodeName});o.length>0&&o[0].close(),this.getPlayer().enableInput()}else console.error("Invalid placeholder type for the player!");if(this.setupPlaceholderInstance(t,this.playerNode),this.playerNode.position=this.playerNode.position.add(n),this.actorsMiddleLayer.addChild(this.playerNode),this.playerNode.getComponent(c.default).spawn(),this.playerNode.getComponent(c.default).isActive=!0,this.playerNode.getComponent(c.default).initialFacingDirection=t.initialDirection,t.classType!=r.ActorClassType.PLAYER||this.isBossStage)if(t.classType==r.ActorClassType.PLAYER&&this.isBossStage)this.getPlayer().disableInput();else if(t.classType==r.ActorClassType.LEVEL_TUNNEL){this.getPlayer().disableInput();var a=6*i.TILE_SIZE.width;t.initialDirection==u.Direction.LEFT&&(a=-a),this.getPlayer().autoMoveBy(a,function(){e.getPlayer().doIntroAnimation(function(){e.getPlayer().enableInput()})})}else t.classType,r.ActorClassType.LEVEL_DOOR;else this.getPlayer().disableInput(),this.scheduleOnce(function(){return e.getPlayer().doIntroAnimation(function(){e.getPlayer().enableInput()})},1)},t.prototype.setGravity=function(e){cc.director.getPhysicsManager().gravity=cc.v2(0,e),this.gravity=e},t.prototype.getGravity=function(){return this.gravity},t.prototype.getPlayer=function(){return this.playerNode?this.playerNode.getComponent(c.default):null},t.prototype.setupCamera=function(){var e=cc.find("Canvas/Main Camera");if(e){var t=e.getComponent(l.default);if(this.isBossStage){this.playerNode.x=0,t.setPosition(cc.v2(0,-12*i.TILE_SIZE.height)),t.setFollow(!1,!1),t.setZoom(1,!0),t.setTargetNode(this.playerNode,!0),t.setWorld(cc.find(i.TILEMAP_NODE_PATH),!0);var n=Math.max(0,(this.worldMapSize.width/2-19)*i.TILE_SIZE.width);t.setBoundsPadding(cc.v2(n+10,10));var o=t.calculateZoomToFitWidth(37*i.TILE_SIZE.width),a=t.calculateZoomToFitHeight(25*i.TILE_SIZE.height);o<a&&t.setFollow(!0,!1),console.info("calculated zoom: "+a),cc.tween(t).to(3,{zoom:a},{progress:null,easing:"quadOut"}).start()}else{t.setFollow(!0,!0),t.setZoom(.8,!0);var s=.5*cc.Canvas.instance.node.height*b.CameraConfig.verticalOffsetFactor;t.setTargetOffset(cc.v2(0,s)),t.setTargetNode(this.playerNode,!0),t.setWorld(cc.find(i.TILEMAP_NODE_PATH),!0)}}else console.error("no main camera node found!")},t.prototype.spawnBoxAttackArea=function(e,t,n,o,a,s,r){void 0===r&&(r=null);var c=cc.instantiate(i.instance.attackAreaPrefab);c.position=e,c.width=t.width,c.height=t.height;var l=c.getComponent(M.default);r&&(l.followNode=r,l.positionOffset=e);var u=c.getComponent(h.default);u.attackDamage=o,u.attackDirection=n;var p=c.getComponent(cc.PhysicsBoxCollider);p.enabled=!0,p.tag=s,p.size=t,p.apply(),c.getComponent(g.default).timeRemaining=a,this.actorsFrontLayer.addChild(c)},t.prototype.spawnCircleAttackArea=function(e,t,n,o,a,s){var r=cc.instantiate(i.instance.attackAreaPrefab);r.position=e,r.width=t,r.height=t;var c=r.getComponent(h.default);c.attackDamage=o,c.attackDirection=n;var l=r.getComponent(cc.PhysicsCircleCollider);l.enabled=!0,l.tag=s,l.radius=t,l.apply(),r.getComponent(g.default).timeRemaining=a,this.actorsFrontLayer.addChild(r)},t.prototype.spawnProjectile=function(e,t,i,n,o,a){var s=null;switch(a){case f.ProjectileType.GREEN_BOMBER:s=cc.instantiate(this.greenBomberProjectilePrefab);break;case f.ProjectileType.PINK_BOMBER:s=cc.instantiate(this.pinkBomberProjectilePrefab);break;case f.ProjectileType.GREEN_MORTAR:s=cc.instantiate(this.greenMortarProjectilePrefab);break;case f.ProjectileType.PINK_MORTAR:s=cc.instantiate(this.pinkMortarProjectilePrefab);break;case f.ProjectileType.TURRET:s=cc.instantiate(this.turretProjectilePrefab);break;case f.ProjectileType.CAPSULE:var r=Math.floor(3*Math.random());0==r?s=cc.instantiate(this.playerProjectileVariant1Prefab):1==r?s=cc.instantiate(this.playerProjectileVariant2Prefab):2==r&&(s=cc.instantiate(this.playerProjectileVariant3Prefab))}var c=s.getComponent(f.default);s.position=e,c.throwSpeed=t,c.throwAngle=i,c.gravityScale=n,this.actorsBackLayer.addChild(s)},t.prototype.spawnExplosion=function(e,t){var i=cc.instantiate(this.capsuleExplosionPrefab);i.position=e,i.getComponent(h.default).attackDamage=t,i.getComponent(h.default).attackDirection=u.Direction.NONE,this.actorsFrontLayer.addChild(i)},t.prototype.spawnCollectable=function(e,t,i,n,o){var a=null;switch(o){case I.CollectableType.COOKIE:a=cc.instantiate(this.cookiePrefab);break;case I.CollectableType.COOKIE_BATCH:a=cc.instantiate(this.cookieBatchPrefab);break;case I.CollectableType.AMMO_BATCH:a=cc.instantiate(this.ammoBatchPrefab);break;case I.CollectableType.HEART:a=cc.instantiate(this.hearthPrefab)}var s=a.getComponent(I.default);a.position=e,s.throwSpeed=t,s.throwAngle=i,s.gravityScale=n,this.actorsBackLayer.addChild(a)},t.prototype.spawnCollectables=function(e,t){for(var n=0;t>b.CollectablesConfig.maxSingleCookiesToSpawn&&t>=b.CollectablesConfig.cookieBatchIncreaseAmount;)++n,t-=b.CollectablesConfig.cookieBatchIncreaseAmount;for(var o=0;o<t;++o){var a=700+300*Math.random(),s=cc.misc.degreesToRadians(50*Math.random()+65);i.instance.spawnCollectable(e,a,s,1,I.CollectableType.COOKIE)}for(o=0;o<n;++o){a=700+300*Math.random(),s=cc.misc.degreesToRadians(50*Math.random()+65);i.instance.spawnCollectable(e,a,s,1,I.CollectableType.COOKIE_BATCH)}if(x.default.instances.spawnObjects(I.CollectableType.COOKIE,t),x.default.instances.spawnObjects(I.CollectableType.COOKIE_BATCH,n),this.playerNode.getComponent(c.default).getHealth()<this.getPlayer().getMaxHealth()*b.CollectablesConfig.heartSpawnMinPlayerHealthFactor&&Math.random()<=b.CollectablesConfig.heartSpawnProbability){a=700+300*Math.random(),s=cc.misc.degreesToRadians(50*Math.random()+65);i.instance.spawnCollectable(e,a,s,1,I.CollectableType.HEART),x.default.instances.spawnObjects(I.CollectableType.HEART,1)}},t.prototype.spawnPuff=function(e,t){var i;switch(t){case s.GREEN_ENEMY_PUFF:i=cc.instantiate(this.greenEnemyPuffPrefab);break;case s.PINK_ENEMY_PUFF:i=cc.instantiate(this.pinkEnemyPuffPrefab);break;case s.JUMP_DUST:i=cc.instantiate(this.jumpDustPrefab);break;case s.LAND_DUST:i=cc.instantiate(this.landDustPrefab);break;case s.WATER_SPLASH:i=cc.instantiate(this.waterSplashPrefab),C.default.getInstance().audioManager.playSfxWater();break;case s.POISON_SPLASH:i=cc.instantiate(this.poisonSplashPrefab),C.default.getInstance().audioManager.playSfxWater();break;case s.GREEN_PROJECTILE_PUFF:i=cc.instantiate(this.greenProjectilePuffPrefab);break;case s.PINK_PROJECTILE_PUFF:i=cc.instantiate(this.pinkProjectilePuffPrefab);break;case s.GREEN_BARRIER_PUFF:i=cc.instantiate(this.greenBarrierPuffPrefab);break;case s.PINK_BARRIER_PUFF:i=cc.instantiate(this.pinkBarrierPuffPrefab)}i?(i.position=e,this.actorsMiddleLayer.addChild(i)):console.error("what puff type is this! "+t)},t.prototype.resetDeltaTime=function(){var e=.66*cc.game.getFrameRate();cc.director._deltaTime>1/e&&(cc.director._deltaTime=1/e)},t.prototype.setTimeScale=function(e,t){var i=this;void 0===t&&(t=0),this.timeScaleFactor=e,1==e?cc.director.calculateDeltaTime=this.originalCalculateDeltaTime:(cc.director._deltaTime*=e,cc.director.calculateDeltaTime=function(t){t||(t=performance.now());var i=(t-this._lastUpdate)/1e3;cc.PhysicsManager.FIXED_TIME_STEP&&i>cc.PhysicsManager.MAX_ACCUMULATOR&&(i=cc.PhysicsManager.MAX_ACCUMULATOR),this._deltaTime=.15*i*e+.85*this._deltaTime,this._deltaTime<0?this.calculateDeltaTime():this._lastUpdate=t},t>0&&this.scheduleOnce(function(){return i.setTimeScale(1)},t*e))},t.prototype.shakeCamera=function(e,t){void 0===t&&(t=null);var i=cc.find("Canvas/Main Camera"),n=new L.default;switch(e){case a.LOW:n.magnitude=b.CameraConfig.lowScreenShakeMagnitude,n.duration=b.CameraConfig.lowScreenShakeDuration,n.bumpsCount=b.CameraConfig.lowScreenShakeBumpsCount;break;case a.MEDIUM:n.magnitude=b.CameraConfig.mediumScreenShakeMagnitude,n.duration=b.CameraConfig.mediumScreenShakeDuration,n.bumpsCount=b.CameraConfig.mediumScreenShakeBumpsCount;break;case a.HIGH:case a.EXTREME:n.magnitude=b.CameraConfig.highScreenShakeMagnitude,n.duration=b.CameraConfig.highScreenShakeDuration,n.bumpsCount=b.CameraConfig.highScreenShakeBumpsCount}if(null!=t){var o=n.duration,s=n.bumpsCount,r=t/o;n.duration=t,n.bumpsCount=Math.round(s*r)}n.manualShake(),i.getComponent(l.default).setShaker(n)},t.prototype.updateUI=function(){this.gameplayUI.updateUI(this.isBossStage)},t.prototype.setupGame=function(){console.info("Game setup called!"),this.setGravity(i.instance.gravity),this.createLayers(),this.spawnActors(),this.spawnPlayer(),this.setupCamera(),this.autoFixBackground();var e=cc.find(i.BOSS_NODE_PATH);if(e){this.isBossStage=!0;var t=e.getComponent(O.default);t&&t.setup();var n=e.getComponent(R.default);n&&n.setup()}this.updateUI()},t.prototype.setupPlaceholderInstance=function(e,t){t.position=cc.v2(e.node.position),t.angle=e.node.angle},t.prototype.levelComplete=function(e){var t=this;void 0===e&&(e=null),this.persistencyStates=new Object;e||(e=.5),this.getPlayer().disableInput(),this.fadeToBlack(e,function(){t.transition.showLoader(),C.default.getInstance().audioManager.clearAllSfx(),t.endAmbienceSfx(),cc.director.loadScene("gameover",function(){console.info("removing game persistent node!"),i._instance=null,cc.game.removePersistRootNode(t.node)})})},t.prototype.changeScene=function(e,t){var n=this;e&&""!=e&&"level_select"!=e?(this.getPlayer().disableInput(),this.transition.showTransition(function(){var o=i.instance.playerNode;o.removeFromParent(),C.default.getInstance().audioManager.clearAllSfx(),n.endAmbienceSfx(),cc.director.loadScene(e,function(){console.info("loadScene playerNode: "+o+"  entryNodeName: "+t),i.instance.playerNode=o,i.instance.entryNodeName=t,i.instance.start()})})):this.levelComplete()},t.prototype.goToLevelSelect=function(){var e=this;this.persistencyStates=new Object,this.transition.showTransition(function(){C.default.getInstance().audioManager.clearAllSfx(),e.endAmbienceSfx(),cc.director.loadScene("level_select",function(){console.info("removing game persistent node!"),i._instance=null,cc.game.removePersistRootNode(e.node)})})},t.prototype.autoFixBackground=function(){var e=cc.find("Canvas");if(e){var t=cc.find("Canvas/Main Camera");if(t)if(cc.find(i.TILEMAP_NODE_PATH)){var n=t.getChildByName("background");n||(n=new cc.Node("background")).addComponent(cc.Sprite);var o=n.getComponent(cc.Sprite);!this.isBossStage&&this.levelNumber>=1&&this.levelNumber<=5||this.isBossStage&&1==this.levelNumber?o.spriteFrame=this.swampBackgroundSprite:!this.isBossStage&&this.levelNumber>=6&&this.levelNumber<=10||this.isBossStage&&2==this.levelNumber?o.spriteFrame=this.mountainBackgroundSprite:!this.isBossStage&&this.levelNumber>=11&&this.levelNumber<=15||this.isBossStage&&3==this.levelNumber?o.spriteFrame=this.pyramidBackgroundSprite:o.spriteFrame=this.swampBackgroundSprite,o.type=cc.Sprite.Type.TILED,n.scale=e.height/o.spriteFrame.getOriginalSize().height/t.getComponent(cc.Camera).zoomRatio,n.width=o.spriteFrame.getOriginalSize().width*(e.width/e.height),n.height=o.spriteFrame.getOriginalSize().height,e.setSiblingIndex(0),t.addChild(n),console.info("fixed canvas width: "+e.width+" height: "+e.height),console.info("fixed background width: "+n.width+" height: "+n.height)}}},t.prototype.scaleBackground=function(){var e=l.default.main.node.getChildByName("background");if(e){var t=e.getComponent(cc.Sprite);e.scale=cc.Canvas.instance.node.height/t.spriteFrame.getOriginalSize().height/l.default.main.zoom,e.width=t.spriteFrame.getOriginalSize().width*(cc.Canvas.instance.node.width/cc.Canvas.instance.node.height),e.height=t.spriteFrame.getOriginalSize().height}},t.prototype.fadeToBlack=function(e,t){void 0===t&&(t=null);var i=cc.instantiate(this.fullscreenQuadPrefab);i.color=cc.color(0,0,0),i.opacity=0,cc.Canvas.instance.node.addChild(i,null,"fullscreen quad"),cc.tween(i).to(e,{opacity:255},{easing:"linear"}).call(function(){t&&t()}).start()},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.prevTimeScaleFactor=this.timeScaleFactor,this.setTimeScale(1)},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.setTimeScale(this.prevTimeScaleFactor)},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),console.info("Game on load called!"),i._instance?(console.info("game instance already created!"),this.node.destroy()):(console.info("no previous game instance... adding persistent node!"),i._instance=this,cc.game.addPersistRootNode(this.node),this.placeholderPrefab||i.doubleError("Placholder prefab not defined!"),this.playerPrefab||i.doubleError("Player prefab not defined!"),this.swampTunnelPrefab||i.doubleError("LevelExit prefab not defined!"),this.attackAreaPrefab||i.doubleError("AttackArea prefab not defined!"),this.smallCratePrefab||i.doubleError("SmallCrate prefab not defined!"),this.mediumCratePrefab||i.doubleError("MediumCrate prefab not defined!"),this.bigCratePrefab||i.doubleError("BigCrate prefab not defined!"),this.greenBarrierPrefab||i.doubleError("Barrier prefab not defined!"),this.greenStaticAgressiveEnemyPrefab||i.doubleError("StaticEnemy prefab not defined!"),this.greenStaticPassiveEnemyPrefab||i.doubleError("StaticPassiveEnemy prefab not defined!"),this.greenPatrollingPassiveEnemyPrefab||i.doubleError("PatrollingEnemy prefab not defined!"),this.spikesPrefab||i.doubleError("StaticSpikes prefab not defined!"),this.flamesPrefab||i.doubleError("Flames prefab not defined!"),this.greenFlyingBomberEnemyPrefab||i.doubleError("FlyingEnemy prefab not defines!"),this.swampDoorPrefab||i.doubleError("Door prefab not defined!"),this.uiPrefab||i.doubleError("UI prefab not defined!"),this.spriteOverlayColorMaterial||i.doubleError("SpriteOverlayColor material not defined!"),this.builtinSpriteMaterial||i.doubleError("BuiltinSprite material not defined!"),this.spineOverlayColorMaterial||i.doubleError("SpineOverlayColor material not defined!"),this.builtinSpineMaterial||i.doubleError("BuiltinSpine material not defined!"),this.swampBackgroundSprite||i.doubleError("Background sprite not defined!"))},t.prototype.start=function(){var e=this;console.info("Game start called!"),x.default.instances.initTimerSection(i._firstStart),this.resetDeltaTime(),i._firstStart&&("section_01_01"===cc.director.getScene().name&&(this.initSection=!0),C.default.getInstance().dataManager.setLocalKey(B.LocalDataKey.snarfFounds,[!1,!1,!1]),i._firstStart=!1),C.default.getInstance().audioManager.initLevelMusic(cc.director.getScene().name),C.default.getInstance().resizeScreenManager.on(U.default.KEY_SIGNAL_RESIZE,this.scaleBackground,this),cc.director.once(cc.Director.EVENT_BEFORE_DRAW,function(){return e.setupGame()}),cc.director.calculateDeltaTime=function(e){e||(e=performance.now());var t=(e-this._lastUpdate)/1e3;cc.PhysicsManager.FIXED_TIME_STEP&&t>cc.PhysicsManager.MAX_ACCUMULATOR&&(t=cc.PhysicsManager.MAX_ACCUMULATOR),this._deltaTime=.15*t+.85*this._deltaTime,this._deltaTime<0?this.calculateDeltaTime():this._lastUpdate=e},this.originalCalculateDeltaTime=cc.director.calculateDeltaTime;var t=cc.instantiate(this.uiPrefab);this.gameplayUI=t.getComponent(F.default),this.gameplayUI.setGame(this),cc.Canvas.instance.node.addChild(t);var n=t.getChildByName("transition_bg");n||console.error("transition node not found!"),this.transition=n.getComponent(d.default),this.transition.hideTransition(this.playIntroSfx.bind(this)),console.info("All base nodes:");for(var o=0,a=cc.director.getScene().children;o<a.length;o++){var s=a[o];console.info(s.name)}this.sceneName=cc.director.getScene().name,console.info("Started scene "+this.sceneName+"!");var r=this.sceneName.split("_");if("section"==r[0]||"test-section"==r[0]){var c="test-section"==r[0],l=parseInt(r[1]);l&&(this.levelNumber=l,this.isBossStage=!1,k.default.instance.lastPlayedLevelNumber=l,k.default.instance.lastPlayedLevelIsBoss=!1,k.default.instance.lastPlayedLevelIsTest=c,k.default.instance.lastPlayedLevelHadFoundAllCollectables=k.default.instance.getLastPlayedLevelCollectables().foundAll()),console.info("Regular level "+l+(c?"(TEST)":""))}else if("boss"==r[0]||"test-boss"==r[0]){c="test-boss"==r[0];var h=parseInt(r[1]);h&&(this.levelNumber=h,this.isBossStage=!0,k.default.instance.lastPlayedLevelNumber=h,k.default.instance.lastPlayedLevelIsBoss=!0,k.default.instance.lastPlayedLevelIsTest=c,k.default.instance.lastPlayedLevelHadFoundAllCollectables=!1),console.info("Boss level "+h+(c?"(TEST)":""))}else k.default.instance.lastPlayedLevelNumber=0,k.default.instance.lastPlayedLevelIsBoss=!1,k.default.instance.lastPlayedLevelIsTest=!1,console.info("Unknown level stage!");k.default.instance.lastLevelWasCompleted=!1},t.prototype.playIntroSfx=function(){"section_01_01"===cc.director.getScene().name?C.default.getInstance().audioManager.playSfx(j.SFXKey.level_in0):this.isBossStage?C.default.getInstance().audioManager.playSfx(j.SFXKey.level_in8):C.default.getInstance().audioManager.playSfxLevelIntro(),this.initAmbienceSfx()},t.prototype.initAmbienceSfx=function(){-1===K.default.levelTabuAmbience.indexOf(cc.director.getScene().name)&&this.scheduleOnce(this.playSfxAmbience,K.default.timePlayAmbience)},t.prototype.resetPlaySfxAmbience=function(){this.scheduleOnce(this.playSfxAmbience,K.default.timePlayAmbience)},t.prototype.playSfxAmbience=function(){var e=C.default.getInstance().audioManager.playSfxAmbience(this.initSection);this.initSection=!1,C.default.getInstance().audioManager.doOnceSfxFinish(e,this.resetPlaySfxAmbience.bind(this))},t.prototype.endAmbienceSfx=function(){-1===K.default.levelTabuAmbience.indexOf(cc.director.getScene().name)&&this.unschedule(this.playSfxAmbience)},t.prototype.onDisable=function(){C.default.getInstance().resizeScreenManager.off(U.default.KEY_SIGNAL_RESIZE,this.scaleBackground,this)},t._instance=null,t._firstStart=!0,t.TILE_SIZE=cc.size(50,50),t.CONTROLLERS_NODE_PATH="[controllers]",t.LEVEL_NODE_PATH="LEVEL",t.TILEMAP_NODE_PATH="LEVEL/TILEMAP",t.PLACEHOLDERS_NODE_PATH="LEVEL/PLACEHOLDERS",t.TUTORIAL_PATCH_NODE_PATH="LEVEL/TUTORIAL_PATCH",t.TERRAIN_NODE_NAME="terrain",t.WATER_NODE_NAME="water",t.PLATFORMS_NODE_NAME="platform terrain",t.BOSS_NODE_PATH="[boss]",o([V(cc.Prefab)],t.prototype,"placeholderPrefab",void 0),o([V(cc.Prefab)],t.prototype,"roundMarkerPrefab",void 0),o([V(cc.Prefab)],t.prototype,"playerPrefab",void 0),o([V(cc.Prefab)],t.prototype,"swampTunnelPrefab",void 0),o([V(cc.Prefab)],t.prototype,"mountainTunnelPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pyramidTunnelPrefab",void 0),o([V(cc.Prefab)],t.prototype,"swampDoorPrefab",void 0),o([V(cc.Prefab)],t.prototype,"exitTunnelPrefab",void 0),o([V(cc.Prefab)],t.prototype,"smallCratePrefab",void 0),o([V(cc.Prefab)],t.prototype,"mediumCratePrefab",void 0),o([V(cc.Prefab)],t.prototype,"bigCratePrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenBarrierPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkBarrierPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenStaticPassiveEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkStaticPassiveEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenStaticAgressiveEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkStaticAgressiveEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenStaticMortarEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkStaticMortarEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenPatrollingPassiveEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkPatrollingPassiveEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenPatrollingJumperEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkPatrollingJumperEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenPatrollingAgressiveEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkPatrollingAgressiveEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenFlyingBomberEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkFlyingBomberEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenFlyingChaserEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkFlyingChaserEnemyPrefab",void 0),o([V(cc.Prefab)],t.prototype,"spikesPrefab",void 0),o([V(cc.Prefab)],t.prototype,"flamesPrefab",void 0),o([V(cc.Prefab)],t.prototype,"turretPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenTrapPlatformPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkTrapPlatformPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenBomberProjectilePrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkBomberProjectilePrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenMortarProjectilePrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkMortarProjectilePrefab",void 0),o([V(cc.Prefab)],t.prototype,"turretProjectilePrefab",void 0),o([V(cc.Prefab)],t.prototype,"playerProjectileVariant1Prefab",void 0),o([V(cc.Prefab)],t.prototype,"playerProjectileVariant2Prefab",void 0),o([V(cc.Prefab)],t.prototype,"playerProjectileVariant3Prefab",void 0),o([V(cc.Prefab)],t.prototype,"capsuleExplosionPrefab",void 0),o([V(cc.Prefab)],t.prototype,"cookiePrefab",void 0),o([V(cc.Prefab)],t.prototype,"cookieBatchPrefab",void 0),o([V(cc.Prefab)],t.prototype,"hearthPrefab",void 0),o([V(cc.Prefab)],t.prototype,"ammoBatchPrefab",void 0),o([V(cc.Prefab)],t.prototype,"specialCollectablePrefab",void 0),o([V(cc.Prefab)],t.prototype,"attackAreaPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenEnemyPuffPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkEnemyPuffPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenProjectilePuffPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkProjectilePuffPrefab",void 0),o([V(cc.Prefab)],t.prototype,"jumpDustPrefab",void 0),o([V(cc.Prefab)],t.prototype,"landDustPrefab",void 0),o([V(cc.Prefab)],t.prototype,"waterSplashPrefab",void 0),o([V(cc.Prefab)],t.prototype,"poisonSplashPrefab",void 0),o([V(cc.Prefab)],t.prototype,"greenBarrierPuffPrefab",void 0),o([V(cc.Prefab)],t.prototype,"pinkBarrierPuffPrefab",void 0),o([V(cc.Material)],t.prototype,"spriteOverlayColorMaterial",void 0),o([V(cc.Material)],t.prototype,"builtinSpriteMaterial",void 0),o([V(cc.Material)],t.prototype,"spineOverlayColorMaterial",void 0),o([V(cc.Material)],t.prototype,"builtinSpineMaterial",void 0),o([V({type:cc.SpriteFrame})],t.prototype,"swampBackgroundSprite",void 0),o([V({type:cc.SpriteFrame})],t.prototype,"mountainBackgroundSprite",void 0),o([V({type:cc.SpriteFrame})],t.prototype,"pyramidBackgroundSprite",void 0),o([V(cc.Prefab)],t.prototype,"fullscreenQuadPrefab",void 0),o([V(cc.Prefab)],t.prototype,"uiPrefab",void 0),t=i=o([Y],t)}(G.default);i.default=z,cc._RF.pop()},{"../../balance/AudioLevelConfig":"AudioLevelConfig","../Testing/TesterLevelData":"TesterLevelData","../core/DataManager":"DataManager","../core/ResizeScreenManager":"ResizeScreenManager","../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","../menu/GameplayUIController":"GameplayUIController","./AttackArea":"AttackArea","./AutoDestroySelf":"AutoDestroySelf","./BossShip":"BossShip","./Collectable":"Collectable","./Config":"Config","./Crate":"Crate","./DoesDamage":"DoesDamage","./Door":"Door","./FinalBoss":"FinalBoss","./Flames":"Flames","./FlyingBomberEnemy":"FlyingBomberEnemy","./FlyingChaserEnemy":"FlyingChaserEnemy","./PatrollingAgressiveEnemy":"PatrollingAgressiveEnemy","./PatrollingJumperEnemy":"PatrollingJumperEnemy","./PatrollingPassiveEnemy":"PatrollingPassiveEnemy","./PausableComponent":"PausableComponent","./Placeholder":"Placeholder","./Projectile":"Projectile","./Shaker":"Shaker","./SpecialCollectable":"SpecialCollectable","./StaticAgressiveEnemy":"StaticAgressiveEnemy","./StaticMortarEnemy":"StaticMortarEnemy","./StaticPassiveEnemy":"StaticPassiveEnemy","./Turret":"Turret","./UpgradesManager":"UpgradesManager","./controllers/CameraController":"CameraController","./controllers/PlayerController":"PlayerController","./controllers/TransitionController":"TransitionController"}],KeyBoardController:[function(e,t,i){"use strict";cc._RF.push(t,"88eccgYcYBFcZQlDaQVToBM","KeyBoardController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=cc._decorator,r=s.ccclass,c=s.property,l=s.menu,h=function(){function e(){this.button=null,this.up=null,this.down=null,this.left=null,this.right=null}return o([c(cc.Button)],e.prototype,"button",void 0),o([c(cc.Button)],e.prototype,"up",void 0),o([c(cc.Button)],e.prototype,"down",void 0),o([c(cc.Button)],e.prototype,"left",void 0),o([c(cc.Button)],e.prototype,"right",void 0),e=o([r("KeyboardButton")],e)}();(function(e){e[e.up=0]="up",e[e.down=1]="down",e[e.left=2]="left",e[e.right=3]="right"})(a||(a={}));var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonESC=null,t.buttons=[],t.buttonDefault=0,t.currentSelect=-1,t.eventDummy={stopPropagation:function(){}},t}var i;return n(t,e),i=t,t.prototype.onLoad=function(){var e;this.allButtons=[],this.normalSpriteFrame=[],this.hoverSpriteFrame=[];for(var t=0,i=this.buttons.length;t<i;t++)e=this.buttons[t].button,this.allButtons.push(e),this.normalSpriteFrame.push(e.normalSprite),this.hoverSpriteFrame.push(e.hoverSprite)},t.prototype.initInput=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onInputDown,this)},t.prototype.endInput=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onInputDown,this)},t.prototype.onInputDown=function(e){switch(e.keyCode){case cc.macro.KEY.c:case cc.macro.KEY.enter:this.selectButton();break;case cc.macro.KEY.up:this.move(a.up);break;case cc.macro.KEY.down:this.move(a.down);break;case cc.macro.KEY.left:this.move(a.left);break;case cc.macro.KEY.right:this.move(a.right);break;case cc.macro.KEY.escape:this.selectEsc()}},t.prototype.setButtonSelectIndex=function(e){var t,n=this.currentSelect;this.allButtons[e].interactable&&(this.currentSelect=e,-1!==n&&((t=this.allButtons[n]).normalSprite=this.normalSpriteFrame[n]),(t=this.allButtons[e]).normalSprite=this.hoverSpriteFrame[e],this.node.emit(i.SIGNAL_ON_SELECT,t))},t.prototype.setButtonSelectButton=function(e){var t,n=this.allButtons.indexOf(e),o=this.currentSelect;this.allButtons[n].interactable&&(this.currentSelect=n,-1!==o&&((t=this.allButtons[o]).normalSprite=this.normalSpriteFrame[o]),(t=this.allButtons[n]).normalSprite=this.hoverSpriteFrame[n],this.node.emit(i.SIGNAL_ON_SELECT,t))},t.prototype.setButtonDefaultButton=function(e){var t=this.allButtons.indexOf(e);-1!==t&&(this.buttonDefault=t)},t.prototype.move=function(e){if(0!==this.allButtons.length)if(-1===this.currentSelect)this.setButtonSelectIndex(this.buttonDefault);else{var t=void 0;switch(e){case a.up:t=this.buttons[this.currentSelect].up;break;case a.down:t=this.buttons[this.currentSelect].down;break;case a.left:t=this.buttons[this.currentSelect].left;break;case a.right:t=this.buttons[this.currentSelect].right}t&&this.setButtonSelectIndex(this.allButtons.indexOf(t))}},t.prototype.selectButton=function(){0!==this.allButtons.length&&(-1===this.currentSelect?(this.allButtons[this.buttonDefault]._onTouchBegan(this.eventDummy),this.allButtons[this.buttonDefault]._onTouchEnded(this.eventDummy)):(this.allButtons[this.currentSelect]._onTouchBegan(this.eventDummy),this.allButtons[this.currentSelect]._onTouchEnded(this.eventDummy)))},t.prototype.selectEsc=function(){this.buttonESC&&(this.buttonESC._onTouchBegan(this.eventDummy),this.buttonESC._onTouchEnded(this.eventDummy))},t.prototype.updateButtonFrames=function(e){var t=this.allButtons.indexOf(e);-1!==t&&(this.normalSpriteFrame[t]=e.normalSprite,this.hoverSpriteFrame[t]=e.hoverSprite,t===this.currentSelect&&(e.normalSprite=this.hoverSpriteFrame[t]))},t.prototype.unselectCurrentButton=function(){-1!==this.currentSelect&&(this.allButtons[this.currentSelect].normalSprite=this.normalSpriteFrame[this.currentSelect],this.currentSelect=-1)},t.prototype.moveToDefaultButton=function(){this.setButtonSelectIndex(this.buttonDefault)},t.prototype.getCurrentButton=function(){return-1===this.currentSelect?null:this.allButtons[this.currentSelect]},t.SIGNAL_ON_SELECT="selectButton",o([c(cc.Button)],t.prototype,"buttonESC",void 0),o([c([h])],t.prototype,"buttons",void 0),t=i=o([r,l("Game Component/Input/KeyboardController")],t)}(cc.Component);i.default=u,cc._RF.pop()},{}],LevelInfoController:[function(e,t,i){"use strict";cc._RF.push(t,"ee298mFZ7hIebX8O0BIJQWK","LevelInfoController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../game/UpgradesManager"),s=e("../core/Singleton"),r=e("../core/audio/AudioScene"),c=e("../core/Utils"),l=cc._decorator,h=l.ccclass,u=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.frameWorld=[],t.frameBoss=[],t}var i;return n(t,e),i=t,t.prototype.onLoad=function(){var e;this.titleLevel=cc.find("level_info_container/base/title",this.node).getComponent(cc.Label),this.snarfsContainer=cc.find("level_info_container/base/snarfs",this.node),this.previewLevel=cc.find("level_info_container/base/image",this.node).getComponent(cc.Sprite),this.snarfIcons=[];for(var t=0;t<3;t++)e="level_info_container/base/snarfs/snarf_empty"+(t+1)+"/snarf_full"+(t+1),this.snarfIcons[t]=cc.find(e,this.node)},t.prototype.show=function(e,t){var i;void 0===t&&(t=!1),t?(i=s.default.getInstance().getLocalizationString("title_boss"),this.snarfsContainer.active=!1,this.previewLevel.spriteFrame=this.frameBoss[e]):(i=s.default.getInstance().getLocalizationString("title_level",[String(e+1)]),this.snarfsContainer.active=!0,this.previewLevel.spriteFrame=this.frameWorld[Math.floor(e/5)],this.snarfIcons[0].active=a.default.instance.getLevelCollectables(e+1).foundFirst,this.snarfIcons[1].active=a.default.instance.getLevelCollectables(e+1).foundSecond,this.snarfIcons[2].active=a.default.instance.getLevelCollectables(e+1).foundThird),this.titleLevel.string=i,c.fixBigFontLabelLocalization(this.titleLevel)},t.prototype.pressYes=function(){s.default.getInstance().audioManager.playSfx(r.SFXKey.button_play),this.node.emit(i.KEY_SIGNAL_PRESS_YES)},t.prototype.pressNo=function(){s.default.getInstance().audioManager.playSfx(r.SFXKey.button_back),this.node.active=!1,this.node.emit(i.KEY_SIGNAL_PRESS_NO)},t.KEY_SIGNAL_PRESS_YES="yes",t.KEY_SIGNAL_PRESS_NO="no",o([u([cc.SpriteFrame])],t.prototype,"frameWorld",void 0),o([u([cc.SpriteFrame])],t.prototype,"frameBoss",void 0),t=i=o([h],t)}(cc.Component);i.default=p,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","../game/UpgradesManager":"UpgradesManager"}],LevelSelectController:[function(e,t,i){"use strict";cc._RF.push(t,"c3e28fpH8tDZJM6Gs5SAWuP","LevelSelectController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../game/UpgradesManager"),s=e("../game/controllers/TransitionController"),r=e("../core/CheatManager"),c=e("../core/Utils"),l=e("./LevelInfoController"),h=e("../core/Singleton"),u=e("./TutorialController"),p=e("../core/audio/AudioScene"),d=e("./FinalPopup"),f=e("../core/DataManager"),m=cc._decorator,g=m.ccclass,y=m.property,v=m.menu,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transition=null,t.tutorialPrefab=null,t.finalPopup=null,t.levelInfoController=null,t.changingScene=!1,t.doTransitionOrLoading=!0,t}return n(t,e),t.prototype.onLoad=function(){if(this.levelInfoController=cc.find("Canvas/level_info").getComponent(l.default),this.levelInfoController.node.active=!1,this.tutorialNode=cc.instantiate(this.tutorialPrefab),this.tutorialController=this.tutorialNode.getComponent(u.default),cc.find("Canvas").addChild(this.tutorialNode),this.transition&&(this.transition.node.active=!0),r.default.cheatEnabled&&cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),!c.isMobile()){var e=h.default.getInstance().getLocalizationString("input_mainAttack");e&&1==e.length&&(h.default.getInstance().attackKey=e.toLowerCase());var t=h.default.getInstance().getLocalizationString("input_secondaryAttack");t&&1==t.length&&(h.default.getInstance().specialKey=t.toLowerCase())}},t.prototype.start=function(){h.default.getInstance().audioManager.playMusic(p.HowlsKey.music_menu),r.default.instances.initCheatMainMenu(),this.levelInfoController.node.on(l.default.KEY_SIGNAL_PRESS_YES,this.goToLevel,this),this.levelInfoController.node.on(l.default.KEY_SIGNAL_PRESS_NO,this.closeLevelInfoController,this),this.seeUnlockAnimation=h.default.getInstance().dataManager.getSeeAnimationLevelUnlock(),this.seeUnlockAnimation||h.default.getInstance().dataManager.seeAnimationLevelUnlock(),this.getUIElements(),this.updateUI(),this.transition&&this.transition.hideTransition(this.checkUpgrades.bind(this))},t.prototype.checkUpgrades=function(){if(a.default.instance.canUnlockSomething()){var e=void 0;(e=this.upgradesContainerAnimation.getComponent(cc.Animation)).play("abilities_alert").wrapMode,e.on(cc.Animation.EventType.PLAY,this.playSoundAlert,this),e.on(cc.Animation.EventType.LASTFRAME,this.playSoundAlert,this)}},t.prototype.playSoundAlert=function(){h.default.getInstance().audioManager.playSfx(p.SFXKey.upgrade_alert)},t.prototype.getUIElements=function(){this.buttonHowToPlay=cc.find("Canvas/container_center/abilities_container/abilities").getComponent(cc.Button),this.buttonUpgrades=cc.find("Canvas/container_center/how_to_play_container/how_to_play").getComponent(cc.Button),this.coinsCountLabel=cc.find("Canvas/container_center/coin_container/coin").getComponent(cc.Label),this.snarfLabel=cc.find("Canvas/container_center/snarf_container/snarfs").getComponent(cc.Label),this.snarfAnimation=cc.find("Canvas/container_center/snarf_container").getComponent(cc.Animation),this.stageContainer=cc.find("Canvas/container_center/stage_container"),this.bossOriginalNode=cc.find("stage_boss",this.stageContainer),this.levelOriginalNode=cc.find("stage_normal",this.stageContainer),this.upgradesContainerAnimation=cc.find("Canvas/container_center/abilities_container").getComponent(cc.Animation),this.title=cc.find("Canvas/container_center/title").getComponent(cc.Label),this.title.string=h.default.getInstance().getLocalizationString("title_level_select"),this.overlayStore=cc.find("Canvas/container_center/overlay"),this.overlayStore.active=!1;var e,t,i,n=h.default.getInstance().getLocalizationFont(this.title.font);this.title.font!=n&&(this.title.font=n,this.title.fontSize=this.title.fontSize+16,this.title.node.position=this.title.node.position.add(cc.v2(0,10))),"en"===h.default.getInstance().localizationManager.locale&&(this.title.node.y=282),this.levelContainers=[],this.levelButtons=[],this.bossContainers=[],this.bossButtons=[];for(var o=0;o<a.default.REGULAR_LEVELS_COUNT;o++)e=cc.find("level"+(o+1),this.stageContainer),t=cc.instantiate(this.levelOriginalNode),e.removeAllChildren(),e.addChild(t),i=t.getChildByName("base").getComponent(cc.Button),this.levelContainers[o]=t,this.levelButtons[o]=i;for(o=0;o<a.default.BOSS_LEVELS_COUNT;o++)e=cc.find("boss"+(o+1),this.stageContainer),t=cc.instantiate(this.bossOriginalNode),e.removeAllChildren(),e.addChild(t),i=t.getChildByName("base").getComponent(cc.Button),this.bossContainers[o]=t,this.bossButtons[o]=i},t.prototype.addTouchListenerLevel=function(e,t,i,n){var o;this.dataLevel.push({index:e,isBoss:n,scenename:t}),(o=new cc.Component.EventHandler).target=this.node,o.component="LevelSelectController",o.handler="selectLevel",o.customEventData=String(this.dataLevel.length-1),i.clickEvents.push(o)},t.prototype.updateUI=function(){this.coinsCountLabel.string=a.default.instance.cookiesCount.toString(),this.snarfLabel.string=a.default.instance.getFoundCollectablesCount().toString()+"/"+a.default.instance.getTotalCollectablesCount().toString(),a.default.instance.getFoundCollectablesCount()==a.default.instance.getTotalCollectablesCount()&&(this.snarfLabel.node.color=cc.Color.YELLOW,this.snarfAnimation.play("snarf_completed")),this.buttonLevelEnabled=[],this.dataLevel=[],this.buttonUnlock=-1,this.setButtonsLevels(),this.setButtonsBoss(),this.checkAnimationCompleted()},t.prototype.showTutorial=function(){h.default.getInstance().audioManager.playSfx(p.SFXKey.button_generic),this.disabledAllInput(),this.tutorialController.show(),this.tutorialController.node.on(u.default.KEY_SIGNAL_OUT_COMPLETED,this.onHideTutorial,this)},t.prototype.onHideTutorial=function(){this.enabledAllInput(),this.tutorialController.node.off(u.default.KEY_SIGNAL_OUT_COMPLETED,this.onHideTutorial,this)},t.prototype.setButtonsLevels=function(){var e,t;this.buttonCompletedPerfect=!1;for(var i=0;i<a.default.REGULAR_LEVELS_COUNT;i++){t=a.default.instance.getLastPlayedLevelCollectables(),i==a.default.instance.lastPlayedLevelNumber&&!a.default.instance.lastPlayedLevelIsBoss&&!a.default.instance.lastPlayedLevelHadFoundAllCollectables&&t&&t.foundAll(),e="section_"+c.intToString(i+1,2)+"_01",this.levelButtons[i].interactable=!0,this.addTouchListenerLevel(i,e,this.levelButtons[i],!1),this.levelContainers[i].active=!0,this.levelContainers[i].getChildByName("number").getComponent(cc.Label).string=String(i+1);var n=this.levelContainers[i].getComponent(cc.Animation);switch(a.default.instance.getRegularLevelState(i+1)){case a.LevelState.LOCKED:n.play("stage_normal_lock"),this.levelButtons[i].interactable=!1;break;case a.LevelState.UNLOCKED_PASSED:n.play("stage_normal_active");break;case a.LevelState.UNLOCKED_COMPLETED:n.play("stage_normal_completed");break;case a.LevelState.UNLOCKED_LATEST:this.seeUnlockAnimation?n.play("stage_normal_actual"):(this.buttonUnlock=i,this.buttonUnlockIsBoss=!1)}this.levelButtons[i].interactable&&this.buttonLevelEnabled.push(this.levelButtons[i])}},t.prototype.setButtonsBoss=function(){for(var e,t=0;t<a.default.BOSS_LEVELS_COUNT;t++){e="boss_"+c.intToString(t+1,2),this.addTouchListenerLevel(t,e,this.bossButtons[t],!0),this.bossContainers[t].active=!0,this.bossButtons[t].interactable=!0;var i=this.bossContainers[t].getComponent(cc.Animation);switch(a.default.instance.getBossLevelState(t+1)){case a.LevelState.LOCKED:i.play("stage_boss_lock"),this.bossButtons[t].interactable=!1;break;case a.LevelState.UNLOCKED_PASSED:case a.LevelState.UNLOCKED_COMPLETED:i.play("stage_boss_completed");break;case a.LevelState.UNLOCKED_LATEST:this.seeUnlockAnimation?i.play("stage_boss_actual"):(this.buttonUnlock=t,this.buttonUnlockIsBoss=!0)}this.bossButtons[t].interactable&&this.buttonLevelEnabled.push(this.bossButtons[t])}},t.prototype.checkAnimationCompleted=function(){var e=this;if(this.seeUnlockAnimation)this.checkStoreOverlay();else{var t;this.disabledAllInput();if(-1!==this.buttonUnlock&&(this.buttonUnlockIsBoss?this.bossContainers[this.buttonUnlock].getComponent(cc.Animation).play("stage_boss_lock"):this.levelContainers[this.buttonUnlock].getComponent(cc.Animation).play("stage_normal_lock")),this.buttonUnlockIsBoss)-1===this.buttonUnlock?(this.buttonCompletedIsBoss=!0,this.buttonCompleted=2):(this.buttonCompletedIsBoss=!1,this.buttonCompleted=5*(this.buttonUnlock+1)-1);else{if(0===this.buttonUnlock)return void this.checkAnimationUnlock();this.buttonUnlock%5==0?(this.buttonCompletedIsBoss=!0,this.buttonCompleted=this.buttonUnlock/5-1):-1===this.buttonUnlock?(this.buttonCompletedIsBoss=!0,this.buttonCompleted=2):(this.buttonCompletedIsBoss=!1,this.buttonCompleted=this.buttonUnlock-1)}this.buttonCompletedIsBoss?((t=this.bossContainers[this.buttonCompleted].getComponent(cc.Animation)).play("stage_boss_actual"),this.scheduleOnce(function(){h.default.getInstance().audioManager.playSfx(p.SFXKey.level_passed),t.play("stage_boss_completed_play"),t.end=e.endCompletedAnimation.bind(e),t.on("finished",function(){t.targetOff(e),t.play("stage_boss_completed")},e)},1)):((t=this.levelContainers[this.buttonCompleted].getComponent(cc.Animation)).play("stage_normal_actual"),this.scheduleOnce(function(){h.default.getInstance().audioManager.playSfx(p.SFXKey.level_passed),a.default.instance.getRegularLevelState(e.buttonCompleted+1)===a.LevelState.UNLOCKED_COMPLETED?t.play("stage_normal_completed_play"):t.play("stage_normal_active_play"),t.end=e.endCompletedAnimation.bind(e),t.on("finished",function(){t.targetOff(e),a.default.instance.getRegularLevelState(e.buttonCompleted+1)===a.LevelState.UNLOCKED_COMPLETED?t.play("stage_normal_completed"):t.play("stage_normal_active")},e)},1))}},t.prototype.endCompletedAnimation=function(){this.checkAnimationUnlock()},t.prototype.checkAnimationUnlock=function(){var e=this;if(!this.seeUnlockAnimation){var t;if(this.seeUnlockAnimation=!0,-1===this.buttonUnlock)return this.checkStoreOverlay(),void this.enabledAllInput();this.buttonUnlockIsBoss?((t=this.bossContainers[this.buttonUnlock].getComponent(cc.Animation)).getAnimationState("stage_boss_unlock").delay=1,t.play("stage_boss_unlock"),h.default.getInstance().audioManager.playSfx(p.SFXKey.level_unlocked),t.on("finished",function(){t.targetOff(e),t.play("stage_boss_actual"),e.checkStoreOverlay(),e.enabledAllInput()},this)):((t=this.levelContainers[this.buttonUnlock].getComponent(cc.Animation)).getAnimationState("stage_normal_actual_play").delay=1,t.play("stage_normal_actual_play"),h.default.getInstance().audioManager.playSfx(p.SFXKey.level_unlocked),t.on("finished",function(){t.targetOff(e),t.play("stage_normal_actual"),e.checkStoreOverlay(),e.enabledAllInput()},this))}},t.prototype.checkStoreOverlay=function(){a.default.instance.canUnlockSomething()&&!h.default.getInstance().dataManager.getSeeTutorialStore()&&(this.overlayStore.active=!0,h.default.getInstance().dataManager.seeTutorialStore()),this.checkFinalPopup()},t.prototype.checkFinalPopup=function(){var e=a.default.instance.getBossLevelState(a.default.BOSS_LEVELS_COUNT)===a.LevelState.UNLOCKED_COMPLETED,t=a.default.instance.getFoundCollectablesCount()===a.default.instance.getTotalCollectablesCount(),i=h.default.getInstance().dataManager.getCongratulation(),n=!1;e&&(i!==f.CongratulationType.completedSnarf&&t?(h.default.getInstance().dataManager.setCongratulation(f.CongratulationType.completedSnarf),n=!0):i===f.CongratulationType.completed||t||(h.default.getInstance().dataManager.setCongratulation(f.CongratulationType.completed),n=!0)),n&&(this.overlayStore.active=!0,this.overlayStore.zIndex=this.overlayStore.parent.zIndex+1,this.finalPopup.node.zIndex=this.overlayStore.parent.zIndex+1,this.finalPopup.show(),this.finalPopup.node.on(d.default.KEY_SIGNAL_PRESS_CLOSE,this.hideFinalPopup,this))},t.prototype.hideFinalPopup=function(){this.overlayStore.active=!1},t.prototype.showFinalPopup=function(e){void 0===e&&(e=null),this.overlayStore.active=!0,this.overlayStore.zIndex=this.overlayStore.parent.zIndex+1,this.finalPopup.node.zIndex=this.overlayStore.parent.zIndex+1,null!==e&&this.finalPopup.initAllComplete(e),this.finalPopup.show(),this.finalPopup.node.on(d.default.KEY_SIGNAL_PRESS_CLOSE,this.hideFinalPopup,this)},t.prototype.changeScene=function(e){var t;this.changingScene||((t=this.upgradesContainerAnimation.getComponent(cc.Animation)).stop("abilities_alert"),t.off(cc.Animation.EventType.PLAY,this.playSoundAlert,this),t.off(cc.Animation.EventType.LASTFRAME,this.playSoundAlert,this),this.changingScene=!0,this.transition&&this.doTransitionOrLoading?this.showTransition(function(){cc.director.loadScene(e)}):cc.director.loadScene(e))},t.prototype.changeSceneAsEvent=function(e,t){"upgrade"===t&&h.default.getInstance().audioManager.playSfx(p.SFXKey.button_generic),this.changeScene(t)},t.prototype.selectLevel=function(e,t){this.levelSelect=Number(t),this.levelInfoController.node.active=!0,this.disabledAllInput(),h.default.getInstance().audioManager.playSfx(p.SFXKey.button_generic),this.levelInfoController.show(this.dataLevel[this.levelSelect].index,this.dataLevel[this.levelSelect].isBoss)},t.prototype.goToLevel=function(){this.changeScene(this.dataLevel[this.levelSelect].scenename)},t.prototype.closeLevelInfoController=function(){this.enabledAllInput()},t.prototype.disableTransitionOrLoading=function(){this.doTransitionOrLoading=!1},t.prototype.showTransition=function(e){this.transition&&this.transition.showTransition(e.bind(this))},t.prototype.clearTransitionReference=function(){this.transition=null},t.prototype.showMenu=function(){this.node.active=!0},t.prototype.hideMenu=function(){this.node.active=!1},t.prototype.onKeyDown=function(e){switch(e.keyCode){case cc.macro.KEY[0]:console.info("CHEAT: unlock next level"),a.default.instance.unlockNextLevel(),this.seeUnlockAnimation=!1,h.default.getInstance().dataManager.seeAnimationLevelUnlock(),this.updateUI();break;case cc.macro.KEY[2]:console.info("CHEAT: show final popup (Complete)"),this.showFinalPopup(!0);break;case cc.macro.KEY[3]:console.info("CHEAT: show final popup (Incomplete)"),this.showFinalPopup(!1);break;case cc.macro.KEY[4]:console.info("CHEAT: show gameover"),a.default.instance.lastLevelWasCompleted=!1,a.default.instance.lastPlayedLevelIsBoss=!1,a.default.instance.lastPlayedLevelNumber=0,cc.director.loadScene("gameover");break;case cc.macro.KEY[5]:console.info("CHEAT: show completed"),h.default.getInstance().dataManager.setLocalKey(f.LocalDataKey.snarfFounds,0),a.default.instance.lastLevelWasCompleted=!0,a.default.instance.lastPlayedLevelIsBoss=!1,a.default.instance.lastPlayedLevelNumber=1,a.default.instance.collectables[0]=new a.LevelCollectables,cc.director.loadScene("gameover");break;case cc.macro.KEY[9]:console.info("CHEAT: unlock next level (Perfect)"),a.default.instance.unlockNextLevel();var t=a.default.instance.getLevelCollectables(a.default.instance.unlockedRegularLevels-1);t.foundFirst=!0,t.foundSecond=!0,t.foundThird=!0,a.default.instance.saveCollectables(),this.seeUnlockAnimation=!1,h.default.getInstance().dataManager.seeAnimationLevelUnlock(),this.updateUI();break;case cc.macro.KEY[8]:console.info("CHEAT: lock all level"),a.default.instance.lockAllLevel(),this.seeUnlockAnimation=!1,h.default.getInstance().dataManager.seeAnimationLevelUnlock(),this.updateUI()}},t.prototype.enabledAllInput=function(){for(var e=0,t=this.buttonLevelEnabled.length;e<t;e++)this.buttonLevelEnabled[e].interactable=!0;this.buttonHowToPlay.interactable=!0,this.buttonUpgrades.interactable=!0},t.prototype.disabledAllInput=function(){for(var e=0,t=this.buttonLevelEnabled.length;e<t;e++)this.buttonLevelEnabled[e].interactable=!1;this.buttonHowToPlay.interactable=!1,this.buttonUpgrades.interactable=!1},t.prototype.onDestroy=function(){r.default.instances.endCheat()},o([y(s.default)],t.prototype,"transition",void 0),o([y(cc.Prefab)],t.prototype,"tutorialPrefab",void 0),o([y(d.default)],t.prototype,"finalPopup",void 0),t=o([g,v("Game Component/LevelSelectController")],t)}(cc.Component);i.default=C,cc._RF.pop()},{"../core/CheatManager":"CheatManager","../core/DataManager":"DataManager","../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","../game/UpgradesManager":"UpgradesManager","../game/controllers/TransitionController":"TransitionController","./FinalPopup":"FinalPopup","./LevelInfoController":"LevelInfoController","./TutorialController":"TutorialController"}],LoaderCSS:[function(e,t,i){"use strict";cc._RF.push(t,"59e06Kx0OpO3b1e4FOc/2v/","LoaderCSS"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this.gameDiv=document.getElementById("Cocos2dGameContainer"),this.addCSS(),this.addDiv(),this.hide()}return e.prototype.addCSS=function(){var e=document.createElement("style");e.innerHTML='\n        .lds-spinner {\n            color: official;\n            display: inline-block;\n            position: relative;\n            width: 64px;\n            height: 64px;\n          }\n          .lds-spinner div {\n            transform-origin: 32px 32px;\n            animation: lds-spinner 1.2s linear infinite;\n          }\n          .lds-spinner div:after {\n            content: " ";\n            display: block;\n            position: absolute;\n            top: 3px;\n            left: 29px;\n            width: 5px;\n            height: 14px;\n            border-radius: 20%;\n            background: #fff;\n          }\n          .lds-spinner div:nth-child(1) {\n            transform: rotate(0deg);\n            animation-delay: -1.1s;\n          }\n          .lds-spinner div:nth-child(2) {\n            transform: rotate(30deg);\n            animation-delay: -1s;\n          }\n          .lds-spinner div:nth-child(3) {\n            transform: rotate(60deg);\n            animation-delay: -0.9s;\n          }\n          .lds-spinner div:nth-child(4) {\n            transform: rotate(90deg);\n            animation-delay: -0.8s;\n          }\n          .lds-spinner div:nth-child(5) {\n            transform: rotate(120deg);\n            animation-delay: -0.7s;\n          }\n          .lds-spinner div:nth-child(6) {\n            transform: rotate(150deg);\n            animation-delay: -0.6s;\n          }\n          .lds-spinner div:nth-child(7) {\n            transform: rotate(180deg);\n            animation-delay: -0.5s;\n          }\n          .lds-spinner div:nth-child(8) {\n            transform: rotate(210deg);\n            animation-delay: -0.4s;\n          }\n          .lds-spinner div:nth-child(9) {\n            transform: rotate(240deg);\n            animation-delay: -0.3s;\n          }\n          .lds-spinner div:nth-child(10) {\n            transform: rotate(270deg);\n            animation-delay: -0.2s;\n          }\n          .lds-spinner div:nth-child(11) {\n            transform: rotate(300deg);\n            animation-delay: -0.1s;\n          }\n          .lds-spinner div:nth-child(12) {\n            transform: rotate(330deg);\n            animation-delay: 0s;\n          }\n          @keyframes lds-spinner {\n            0% {\n              opacity: 1;\n            }\n            100% {\n              opacity: 0;\n            }\n          }          \n        ',document.head.appendChild(e)},e.prototype.addDiv=function(){this.divLoading=document.createElement("Div"),this.divLoading.style.position="absolute",this.divLoading.style.right="10px",this.divLoading.style.bottom="10px",this.divLoading.innerHTML='<div class="lds-spinner"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>',this.gameDiv.appendChild(this.divLoading)},e.prototype.show=function(){this.divLoading.style.display="block"},e.prototype.hide=function(){this.divLoading.style.display="none"},e}();i.default=n,cc._RF.pop()},{}],LocalizationAsset:[function(e,t,i){"use strict";cc._RF.push(t,"361de6/ilxO+YHMGFI8Uo/M","LocalizationAsset");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function r(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new i(function(t){t(e.value)}).then(s,r)}c((n=n.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var i,n,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(e){return function(t){return c([e,t])}}function c(a){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"key",{get:function(){return this._key},set:function(e){var t=this;this._key=e,this.getValue().then(function(e){e&&(t.target=e)})},enumerable:!0,configurable:!0}),t.prototype.getValue=function(){return o(this,void 0,Promise,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.localizationManager.getAsset(this.key,null)];case 1:return[2,e.sent()]}})})},t}(e("./LocalizationItem").default);i.default=s,cc._RF.pop()},{"./LocalizationItem":"LocalizationItem"}],LocalizationConfig:[function(e,t,i){"use strict";cc._RF.push(t,"263c6gci4lKEKWkupYVvsI7","LocalizationConfig");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../core/Singleton"),s=cc._decorator,r=s.ccclass,c=s.property,l=function(){function e(){this.font=null,this.locales=[]}return o([c({type:cc.Font})],e.prototype,"font",void 0),o([c({type:[cc.String]})],e.prototype,"locales",void 0),e=o([r("FontLocale")],e)}();i.FontLocale=l;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.language="en",t.localesFonts=[],t}return n(t,e),t.prototype.onLoad=function(){this.instance=a.default.getInstance(),this.instance.initLocalizationManager(this.language,this.localesFonts)},o([c(cc.String)],t.prototype,"language",void 0),o([c({type:[l]})],t.prototype,"localesFonts",void 0),t=o([r],t)}(cc.Component);i.default=h,cc._RF.pop()},{"../core/Singleton":"Singleton"}],LocalizationImageComponent:[function(e,t,i){"use strict";cc._RF.push(t,"988aapTOLNJn4C6+wgn6Y0e","LocalizationImageComponent");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./ExposedLocalizationImage"),s=e("./LocalizationManager"),r=cc._decorator,c=r.ccclass,l=r.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.localizationImage=new a.default,t}return n(t,e),Object.defineProperty(t.prototype,"spriteComponent",{get:function(){return this.localizationImage.spriteComponent},set:function(e){this.localizationImage.spriteComponent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.localizationImage.key},set:function(e){this.localizationImage.key=e},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.spriteComponent||(this.spriteComponent=this.node.getComponent(cc.Sprite)),this.localizationImage.key=this.key},t.prototype.onEnable=function(){var e=s.default.instance;e&&e.subscribeItem(this.localizationImage)},t.prototype.onDisable=function(){var e=s.default.instance;e&&e.unsubscribeItem(this.localizationImage)},o([l({type:a.default,visible:!1})],t.prototype,"localizationImage",void 0),o([l({type:cc.Sprite})],t.prototype,"spriteComponent",null),o([l({type:cc.String})],t.prototype,"key",null),t=o([c],t)}(cc.Component);i.default=h,cc._RF.pop()},{"./ExposedLocalizationImage":"ExposedLocalizationImage","./LocalizationManager":"LocalizationManager"}],LocalizationImage:[function(e,t,i){"use strict";cc._RF.push(t,"cd60exLguVCCpDwGEPUsdTQ","LocalizationImage");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./LocalizationAsset"),s=cc._decorator.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sprite=null,t}return n(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return this.sprite.spriteFrame},set:function(e){this.sprite.spriteFrame=e},enumerable:!0,configurable:!0}),o([s({type:cc.Sprite})],t.prototype,"sprite",void 0),t}(a.default);i.default=r,cc._RF.pop()},{"./LocalizationAsset":"LocalizationAsset"}],LocalizationItem:[function(e,t,i){"use strict";cc._RF.push(t,"ad12fma2TdPT6WBxyMnrqgW","LocalizationItem");var n=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var o=e("./LocalizationManager"),a=cc._decorator.property,s=function(){function e(){this._key=""}return Object.defineProperty(e.prototype,"key",{get:function(){return this._key},set:function(e){this._key=e;var t=this.getValue();t&&this.checkEqualType(t)&&(this.target=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localizationManager",{get:function(){return o.default.instance},enumerable:!0,configurable:!0}),e.prototype.checkEqualType=function(e){return Object.getPrototypeOf(e)===Object.getPrototypeOf(this.target)},n([a(cc.String)],e.prototype,"_key",void 0),e}();i.default=s,cc._RF.pop()},{"./LocalizationManager":"LocalizationManager"}],LocalizationManager:[function(e,t,i){"use strict";cc._RF.push(t,"7cc36ohCCFBUrjnrHVUDcLD","LocalizationManager");var n=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator.ccclass,a={type:cc.SpriteFrame,extension:"png",transform:function(e){return e?(e instanceof HTMLImageElement?(t=new cc.Texture2D).initWithElement(e):t=e,new cc.SpriteFrame(t)):null;var t}},s=function(){function e(e,i){void 0===e&&(e="en"),void 0===i&&(i=[]);var n,o=this;if(this.defaultLocale="en",this.localesFonts=[],this.localizationItems=[],this.localeData=null,this.localeImage=null,this.localeAssetCache={},this.defaultLocale=e,this.localesFonts=i,t.lm)return t.lm;window.localizationCode?this._locale=window.localizationCode:this._locale=this.defaultLocale,t.lm=this,(n=cc.loader.load.bind(cc.loader))("localization/localization.json",function(e,t){e?console.error(e):(t instanceof cc.JsonAsset?o.localeData=t.json:o.localeData=t,o.changeLocale())}),n("localization/localizationImage.json",function(e,t){e?console.error(e):(t instanceof cc.JsonAsset?o.localeImage=t.json:o.localeImage=t,o.changeLocale())})}var t;return t=e,Object.defineProperty(e.prototype,"locale",{get:function(){return this._locale},set:function(e){this._locale=e,this.changeLocale()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeFont",{get:function(){return this.getFont(this._locale)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultFont",{get:function(){return this.getFont(this.defaultLocale)},enumerable:!0,configurable:!0}),e.prototype.isFontSupported=function(e){return this.fontSupportedCheck(e,this._locale)},Object.defineProperty(e,"instance",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeStr",{get:function(){return this.locale},enumerable:!0,configurable:!0}),e.prototype.subscribeItem=function(e){this.localizationItems.indexOf(e)<0&&this.localizationItems.push(e)},e.prototype.unsubscribeItem=function(e){var t=this.localizationItems.indexOf(e);t>=0&&this.localizationItems.splice(t,1)},e.prototype.getString=function(e,t){var i,n=this.localeData[e];if(!n)return null;for(var o=(i=n[this.localeStr]).indexOf("{")+1,a=i.indexOf("}"),s=0,r=i.substring(o,a);""!==r&&s<t.length;)i=i.split("{"+r+"}").join(t[s]),s++,o=i.indexOf("{")+1,a=i.indexOf("}"),r=i.substring(o,a);return i},e.prototype.getAssetInstance=function(e){return this.localeAssetCache[e]?this.localeAssetCache[e]:null},e.prototype.getAsset=function(e,t,i,n){var o=this;return void 0===t&&(t=null),new Promise(function(t,a){o.localeAssetCache[e]?t(o.localeAssetCache[e]):cc.loader.load("localization/images/"+o._locale+"/"+e+"."+i,function(i,a){if(i)console.error(i);else if(n){var s=n(a);o.localeAssetCache[e]=s,t(s)}else o.localeAssetCache[e]=a,t(a)})})},e.prototype.changeLocale=function(){null!==this.localeImage&&null!==this.localeData&&(this.localeAssetCache={},this.preloadAssets(),this.updateAllItems())},e.prototype.preloadAssets=function(){if(this.localeImage)for(var e=0;e<this.localeImage.keys.length;e++)this.getAsset(this.localeImage.keys[e],a.type,a.extension,a.transform)},e.prototype.updateAllItems=function(){var e=this;this.localizationItems.forEach(function(t){if(t.target instanceof cc.Asset){var i=e.getAsset(t.key,Object.getPrototypeOf(t.target).constructor);i&&i.then(function(e){t.target=e})}else{var n=e.getString(t.key);n&&(t.target=n)}})},e.prototype.getFont=function(e){for(var t=0;t<this.localesFonts.length;++t){var i=this.localesFonts[t];if(-1!==i.locales.indexOf(e))return i.font}return null},e.prototype.fontSupportedCheck=function(e,t){if(!e)return!1;for(var i=0,n=this.localesFonts;i<n.length;i++){var o=n[i];if(e.name==o.font.name&&o.locales.indexOf(t)>=0)return!0}return!1},e.lm=null,e=t=n([o],e)}();i.default=s,cc._RF.pop()},{}],LocalizationTextComponent:[function(e,t,i){"use strict";cc._RF.push(t,"e732eSNHttLZoaiu8FJ1BL+","LocalizationTextComponent");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./LocalizationManager"),s=e("./ExposedLocalizationText"),r=cc._decorator,c=r.ccclass,l=r.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._overrideFont=!0,t.localizationText=new s.default,t}return n(t,e),Object.defineProperty(t.prototype,"textComponent",{get:function(){return this.localizationText.textComponent},set:function(e){this.localizationText.textComponent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.localizationText.text},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.localizationText.key},set:function(e){this.localizationText.key=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overrideFont",{get:function(){return this._overrideFont},set:function(e){this._overrideFont!==e&&(this._overrideFont=e),this.swapFont(e)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.textComponent||(this.textComponent=this.node.getComponent(cc.Label)),this.localizationText.key=this.key,this.swapFont(this._overrideFont)},t.prototype.onEnable=function(){var e=a.default.instance;e&&e.subscribeItem(this.localizationText)},t.prototype.onDisable=function(){var e=a.default.instance;e&&e.unsubscribeItem(this.localizationText)},t.prototype.swapFont=function(e){var t,i=a.default.instance;i&&((t=e?i.localeFont:i.defaultFont)&&(this.textComponent.font=t))},o([l({visible:!0})],t.prototype,"_overrideFont",void 0),o([l({type:s.default,visible:!1})],t.prototype,"localizationText",void 0),o([l({type:cc.Label})],t.prototype,"textComponent",null),o([l({type:cc.String})],t.prototype,"key",null),t=o([c],t)}(cc.Component);i.default=h,cc._RF.pop()},{"./ExposedLocalizationText":"ExposedLocalizationText","./LocalizationManager":"LocalizationManager"}],LocalizationText:[function(e,t,i){"use strict";cc._RF.push(t,"cebad/FmktHsZygJou+bkVt","LocalizationText");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./LocalizationItem"),s=cc._decorator.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._text=null,t}return n(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return this._text.string},set:function(e){this._text.string=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.target},enumerable:!0,configurable:!0}),t.prototype.checkEqualType=function(e){return typeof e==typeof this.target},t.prototype.getValue=function(){return this.localizationManager.getString(this.key)},o([s({type:cc.Label})],t.prototype,"_text",void 0),t}(a.default);i.default=r,cc._RF.pop()},{"./LocalizationItem":"LocalizationItem"}],MainMenuController:[function(e,t,i){"use strict";cc._RF.push(t,"dd5fdoozXBMMKa/L35DMBQ4","MainMenuController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../game/controllers/TransitionController"),s=e("../core/CheatManager"),r=e("../core/Singleton"),c=e("../core/audio/AudioScene"),l=cc._decorator,h=l.ccclass,u=l.property,p=l.menu,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transition=null,t.changingScene=!1,t.doTransitionOrLoading=!0,t}return n(t,e),t.prototype.changeScene=function(e){this.changingScene||(this.changingScene=!0,this.transition&&this.doTransitionOrLoading?this.showTransition(function(){cc.director.loadScene(e)}):cc.director.loadScene(e))},t.prototype.changeSceneAsEvent=function(e,t){var i=r.default.getInstance().dataManager.getSeeComicIntro();r.default.getInstance().audioManager.playSfx(c.SFXKey.button_play),i?this.changeScene(t):this.changeScene("comic")},t.prototype.disableTransitionOrLoading=function(){this.doTransitionOrLoading=!1},t.prototype.showTransition=function(e){this.transition&&this.transition.showTransition(e.bind(this))},t.prototype.clearTransitionReference=function(){this.transition=null},t.prototype.showMenu=function(){this.node.active=!0},t.prototype.hideMenu=function(){this.node.active=!1},t.prototype.onLoad=function(){this.transition&&(this.transition.node.active=!0)},t.prototype.start=function(){r.default.getInstance().audioManager.playMusic(c.HowlsKey.music_menu),s.default.instances.initCheatMainMenu(),this.transition&&this.transition.hideTransition(null)},t.prototype.onDestroy=function(){s.default.instances.endCheat()},o([u(a.default)],t.prototype,"transition",void 0),t=o([h,p("Game Component/MainMenuController")],t)}(cc.Component);i.default=d,cc._RF.pop()},{"../core/CheatManager":"CheatManager","../core/Singleton":"Singleton","../core/audio/AudioScene":"AudioScene","../game/controllers/TransitionController":"TransitionController"}],Missiles:[function(e,t,i){"use strict";cc._RF.push(t,"0f072mq0tpLfIbAhQB81Jla","Missiles");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./Game"),s=e("../core/Utils"),r=e("../core/Singleton"),c=e("../core/audio/AudioScene"),l=e("./PausableComponent"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.missileExplosionPrefab=null,t.laneExplosionPrefab=null,t.animation=null,t.bossShip=null,t.lane=0,t.damage=0,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){i.tag==a.ColliderTag.PLAYER_BODY&&(r.default.getInstance().audioManager.playSfx(c.SFXKey.bosslevel_mutants2),this.spawnMissileExplosion(this.node.position.add(cc.v2(0,50))),this.node.destroy()),i.tag==a.ColliderTag.TERRAIN&&(r.default.getInstance().audioManager.playSfx(c.SFXKey.bosslevel_mutants2),this.spawnLaneExplosion(),this.node.destroy())},t.prototype.spawnMissileExplosion=function(e){var t=cc.instantiate(this.missileExplosionPrefab);t.position=e,a.default.instance.actorsFrontLayer.addChild(t),a.default.instance.spawnBoxAttackArea(e,cc.size(300,300),s.Direction.NONE,this.damage,.2,a.ColliderTag.ENEMY_ATTACK_AREA)},t.prototype.spawnLaneExplosion=function(){var e=cc.instantiate(this.laneExplosionPrefab),t=this.bossShip.getMissileLanePosition(this.lane);e.position=t,a.default.instance.actorsFrontLayer.addChild(e),a.default.instance.spawnBoxAttackArea(t,cc.size(this.bossShip.getMissileLaneWidthPixels(),40*a.default.TILE_SIZE.height),s.Direction.NONE,this.damage,.2,a.ColliderTag.ENEMY_ATTACK_AREA)},t.prototype.init=function(e,t,i){this.bossShip=e,this.lane=t,this.damage=i;var n=this.bossShip.getMissileLanePosition(t);n.y=12*a.default.TILE_SIZE.height,this.node.position=n,this.node.getComponent(cc.RigidBody).linearVelocity=cc.v2(0,-20*a.default.TILE_SIZE.height)},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.animation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.animation.resume()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.animation=this.node.getChildByName("missiles").getComponent(cc.Animation)},t.prototype.start=function(){},o([p(cc.Prefab)],t.prototype,"missileExplosionPrefab",void 0),o([p(cc.Prefab)],t.prototype,"laneExplosionPrefab",void 0),t=o([u],t)}(l.default);i.default=d,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Game":"Game","./PausableComponent":"PausableComponent"}],MobileInputController:[function(e,t,i){"use strict";cc._RF.push(t,"e0e93nSOrFMApfIsSkc/a1J","MobileInputController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../core/Utils"),s=e("../game/UpgradesManager"),r=e("./ZonedTouchInputButtons"),c=e("./TouchInputButton"),l=cc._decorator.ccclass,h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.moveButton=cc.find("move_nodes/dPad_move",this.node),this.jumpButton=cc.find("action_nodes/dPad_jump",this.node),this.attackButton=cc.find("action_nodes/dPad_attack",this.node),this.specialButton=cc.find("action_nodes/dpad_special",this.node),this.moveZone=cc.find("move_nodes",this.node).getComponent(r.default),this.jumpZone=this.jumpButton.getChildByName("input_zone").getComponent(c.default),this.attackZone=this.attackButton.getChildByName("input_zone").getComponent(c.default),this.specialZone=this.specialButton.getChildByName("input_zone").getComponent(c.default)},t.prototype.start=function(){a.isMobile()?(this.specialButton.active=!1,(s.default.instance.cheetaraUnlocked||s.default.instance.wilykatWilykitUnlocked||s.default.instance.tygraUnlocked)&&(this.specialButton.active=!0)):this.node.destroy()},t.prototype.lockButtons=function(){this.isLocked=!0,this.moveButton.opacity=127,this.jumpButton.opacity=127,this.attackButton.opacity=127,this.specialButton.opacity=127,this.moveZone.enabled=!1,this.jumpZone.enabled=!1,this.attackZone.enabled=!1,this.specialZone.enabled=!1,this.jumpButton.getComponent(cc.Button).enabled=!1,this.attackButton.getComponent(cc.Button).enabled=!1,this.specialButton.getComponent(cc.Button).enabled=!1},t.prototype.unlockButtons=function(){this.isLocked=!1,this.moveButton.opacity=255,this.jumpButton.opacity=255,this.attackButton.opacity=255,this.specialButton.opacity=255,this.moveZone.enabled=!0,this.jumpZone.enabled=!0,this.attackZone.enabled=!0,this.specialZone.enabled=!0,this.jumpButton.getComponent(cc.Button).enabled=!0,this.attackButton.getComponent(cc.Button).enabled=!0,this.specialButton.getComponent(cc.Button).enabled=!0},t.prototype.simulateKeyDown=function(e,t){this.isLocked||a.simulateKeyDown(t)},t.prototype.simulateKeyUp=function(e,t){this.isLocked||a.simulateKeyUp(t)},t=o([l],t)}(cc.Component);i.default=h,cc._RF.pop()},{"../core/Utils":"Utils","../game/UpgradesManager":"UpgradesManager","./TouchInputButton":"TouchInputButton","./ZonedTouchInputButtons":"ZonedTouchInputButtons"}],PatrollingAgressiveEnemy:[function(e,t,i){"use strict";cc._RF.push(t,"1faacEApT9JzLhDYJrJT6XR","PatrollingAgressiveEnemy");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./DoesDamage"),r=e("./Placeholder"),c=e("../core/Utils"),l=e("./Game"),h=e("./Config"),u=e("../core/Singleton"),p=e("../core/audio/AudioScene"),d=e("./PausableComponent"),f=cc._decorator,m=f.ccclass,g=f.property;(function(e){e[e.PATROLLING=0]="PATROLLING",e[e.CHASING=1]="CHASING",e[e.BUILDING_ATTACK=2]="BUILDING_ATTACK",e[e.ATTACKING=3]="ATTACKING",e[e.STUNNED=4]="STUNNED"})(a||(a={}));var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colorType=r.ActorColorType.GREEN,t.bodySprites=[],t.initialDirection=c.Direction.LEFT,t.leftLimitTiles=5,t.rightLimitTiles=5,t.health=30,t.cookiesSpawnCount=5,t.prevState=null,t.state=a.PATROLLING,t.moveDirection=c.Direction.LEFT,t.moveVelocity=cc.Vec2.ZERO,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){if(t.tag==l.ColliderTag.ENEMY_BODY&&i.tag==l.ColliderTag.PLAYER_ATTACK_AREA){var n=i.getComponent(s.default);this.health-=n.attackDamage;for(var o=function(e){e.setMaterial(0,l.default.instance.spriteOverlayColorMaterial),e.scheduleOnce(function(){return e.setMaterial(0,l.default.instance.builtinSpriteMaterial)},h.CommonEnemiesConfig.damageWhiteFlashTime)},r=0,c=this.bodySprites;r<c.length;r++){o(c[r])}this.health<=0?(this.node.destroy(),l.default.instance.spawnPuff(this.node.position.add(cc.v2(0,-25)),l.default.actorColorToEnemyPuffType(this.colorType)),l.default.instance.shakeCamera(l.CameraShakeLevel.MEDIUM),l.default.instance.spawnCollectables(this.node.position,this.cookiesSpawnCount),u.default.getInstance().audioManager.playSfxKillEnemy()):(u.default.getInstance().audioManager.playSfxHitEnemy(),l.default.instance.shakeCamera(l.CameraShakeLevel.LOW)),this.state==a.PATROLLING&&(this.state=a.CHASING,u.default.getInstance().audioManager.playSingleSfx(p.SFXKey.enemy_crab1))}},t.prototype.isMoving=function(){return this.state==a.PATROLLING||this.state==a.CHASING},t.prototype.isAttacking=function(){return this.state==a.BUILDING_ATTACK||this.state==a.ATTACKING},t.prototype.attack=function(){var e=this;this.state=a.BUILDING_ATTACK,this.scheduleOnce(function(){u.default.getInstance().audioManager.playSfx(p.SFXKey.enemy_crab2),e.state=a.ATTACKING;var t=e.node.position.add(cc.v2(e.moveDirection==c.Direction.LEFT?-100:100,0));e.scheduleOnce(function(){l.default.instance.spawnBoxAttackArea(t,cc.size(100,100),e.moveDirection,e.attackDamage,.2,l.ColliderTag.ENEMY_ATTACK_AREA)},.3),e.scheduleOnce(function(){u.default.getInstance().audioManager.playSingleSfx(p.SFXKey.enemy_crab1),e.state=a.CHASING},e.attackDamageTime+.3)},this.attackBuildTime-.3)},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.bodyAnimation.pause(),this.headAnimation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.bodyAnimation.resume(),this.headAnimation.resume()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.rigidBody=this.getComponent(cc.RigidBody),this.spriteNode=this.node.getChildByName("sprite"),this.doesDamage=this.getComponent(s.default),this.bodyAnimation=this.spriteNode.getComponent(cc.Animation),this.headAnimation=this.colorType==r.ActorColorType.GREEN?cc.find("base/node_body",this.spriteNode).getComponent(cc.Animation):cc.find("base/node_body/crab_pink_body",this.spriteNode).getComponent(cc.Animation),this.bodySprites=c.getAllSubChildrenSprites(this.spriteNode)},t.prototype.start=function(){this.colorType==r.ActorColorType.GREEN?(this.leftChasingLimit=this.node.x-this.leftLimitTiles*l.default.TILE_SIZE.width,this.rightChasingLimit=this.node.x+this.rightLimitTiles*l.default.TILE_SIZE.width,this.leftPatrollingLimit=this.leftChasingLimit+h.GreenPatrollingAgressiveEnemyConfig.persuitMoveExtensionDistance*l.default.TILE_SIZE.width,this.rightPatrollingLimit=this.rightChasingLimit-h.GreenPatrollingAgressiveEnemyConfig.persuitMoveExtensionDistance*l.default.TILE_SIZE.width,this.maxWalkSpeed=l.default.TILE_SIZE.width*h.GreenPatrollingAgressiveEnemyConfig.maxWalkSpeed,this.maxRunSpeed=l.default.TILE_SIZE.width*h.GreenPatrollingAgressiveEnemyConfig.maxRunSpeed,this.moveAcceleration=this.maxWalkSpeed/h.GreenPatrollingAgressiveEnemyConfig.moveAccelerationTime,this.detectionDistance=l.default.TILE_SIZE.width*h.GreenPatrollingAgressiveEnemyConfig.detectionDistance,this.detectionDistanceSqr=this.detectionDistance*this.detectionDistance,this.persuitDistance=l.default.TILE_SIZE.width*h.GreenPatrollingAgressiveEnemyConfig.persuitDistance,this.persuitDistanceSqr=this.persuitDistance*this.persuitDistance,this.nearDistance=l.default.TILE_SIZE.width*h.GreenPatrollingAgressiveEnemyConfig.nearDistance,this.nearDistanceSqr=this.nearDistance*this.nearDistance,this.attackDamage=h.GreenPatrollingAgressiveEnemyConfig.attackDamage,this.attackBuildTime=h.GreenPatrollingAgressiveEnemyConfig.attackBuildTime,this.attackDamageTime=h.GreenPatrollingAgressiveEnemyConfig.attackDamageTime,this.health=h.GreenPatrollingAgressiveEnemyConfig.health,this.cookiesSpawnCount=h.GreenPatrollingAgressiveEnemyConfig.cookiesSpawnCount,this.doesDamage.touchDamage=h.GreenPatrollingAgressiveEnemyConfig.touchDamage):(this.leftChasingLimit=this.node.x-this.leftLimitTiles*l.default.TILE_SIZE.width,this.rightChasingLimit=this.node.x+this.rightLimitTiles*l.default.TILE_SIZE.width,this.leftPatrollingLimit=this.leftChasingLimit+h.PinkPatrollingAgressiveEnemyConfig.persuitMoveExtensionDistance*l.default.TILE_SIZE.width,this.rightPatrollingLimit=this.rightChasingLimit-h.PinkPatrollingAgressiveEnemyConfig.persuitMoveExtensionDistance*l.default.TILE_SIZE.width,this.maxWalkSpeed=l.default.TILE_SIZE.width*h.PinkPatrollingAgressiveEnemyConfig.maxWalkSpeed,this.maxRunSpeed=l.default.TILE_SIZE.width*h.PinkPatrollingAgressiveEnemyConfig.maxRunSpeed,this.moveAcceleration=this.maxWalkSpeed/h.PinkPatrollingAgressiveEnemyConfig.moveAccelerationTime,this.detectionDistance=l.default.TILE_SIZE.width*h.PinkPatrollingAgressiveEnemyConfig.detectionDistance,this.detectionDistanceSqr=this.detectionDistance*this.detectionDistance,this.persuitDistance=l.default.TILE_SIZE.width*h.PinkPatrollingAgressiveEnemyConfig.persuitDistance,this.persuitDistanceSqr=this.persuitDistance*this.persuitDistance,this.nearDistance=l.default.TILE_SIZE.width*h.PinkPatrollingAgressiveEnemyConfig.nearDistance,this.nearDistanceSqr=this.nearDistance*this.nearDistance,this.attackDamage=h.PinkPatrollingAgressiveEnemyConfig.attackDamage,this.attackBuildTime=h.PinkPatrollingAgressiveEnemyConfig.attackBuildTime,this.attackDamageTime=h.PinkPatrollingAgressiveEnemyConfig.attackDamageTime,this.health=h.PinkPatrollingAgressiveEnemyConfig.health,this.cookiesSpawnCount=h.PinkPatrollingAgressiveEnemyConfig.cookiesSpawnCount,this.doesDamage.touchDamage=h.PinkPatrollingAgressiveEnemyConfig.touchDamage),this.leftPatrollingLimit>this.rightPatrollingLimit&&(this.leftPatrollingLimit=this.leftChasingLimit,this.rightPatrollingLimit=this.rightChasingLimit);var e=this.spriteNode.getComponent(cc.Animation).getAnimationState("attack");e.clip.wrapMode=cc.WrapMode.Normal,this.attackDamageTime=e.clip.duration,this.state=a.PATROLLING,this.moveDirection=this.initialDirection==c.Direction.LEFT?c.Direction.LEFT:c.Direction.RIGHT},t.prototype.update=function(e){this.state,this.isMoving(),this.isAttacking();var t=l.default.instance.playerNode.position.x-this.node.position.x,i=l.default.instance.playerNode.position.y-this.node.position.y+40,n=8*l.default.TILE_SIZE.height,o=.5*l.default.TILE_SIZE.height;if(this.state==a.CHASING&&(Math.abs(t)>this.persuitDistance?this.state=a.PATROLLING:Math.abs(i)>n?this.state=a.PATROLLING:Math.abs(i)>=o&&l.default.instance.getPlayer().isGrounded?this.state=a.PATROLLING:this.moveDirection==c.Direction.LEFT&&t<=0&&t>=-this.nearDistance?this.attack():this.moveDirection==c.Direction.RIGHT&&t>=0&&t<=this.nearDistance&&this.attack()),this.state==a.PATROLLING){var s=!1;this.moveDirection==c.Direction.LEFT&&t<=0&&t>=-this.detectionDistance&&Math.abs(i)<o&&(s=!0),this.moveDirection==c.Direction.RIGHT&&t>=0&&t<=this.detectionDistance&&Math.abs(i)<o&&(s=!0),s&&(this.state=a.CHASING,u.default.getInstance().audioManager.playSingleSfx(p.SFXKey.enemy_crab1))}var r=this.node.position;if(this.state==a.PATROLLING&&this.node.position.x>=this.rightPatrollingLimit&&(this.moveDirection=c.Direction.LEFT),this.state==a.PATROLLING&&this.node.position.x<=this.leftPatrollingLimit&&(this.moveDirection=c.Direction.RIGHT),this.state==a.CHASING&&this.node.position.x>=this.rightChasingLimit&&(r.x=this.rightChasingLimit,this.moveDirection=c.Direction.LEFT,this.state=a.PATROLLING),this.state==a.CHASING&&this.node.position.x<=this.leftChasingLimit&&(r.x=this.leftChasingLimit,this.moveDirection=c.Direction.RIGHT,this.state=a.PATROLLING),this.node.position=r,this.state==a.CHASING){this.moveDirection;this.moveDirection=t<0?c.Direction.LEFT:c.Direction.RIGHT}this.isAttacking()&&(this.moveVelocity.x=0),this.isMoving()&&this.moveDirection==c.Direction.LEFT&&(this.moveVelocity.x-=this.moveAcceleration*e),this.isMoving()&&this.moveDirection==c.Direction.RIGHT&&(this.moveVelocity.x+=this.moveAcceleration*e),this.state==a.PATROLLING&&this.moveVelocity.x>this.maxWalkSpeed&&(this.moveVelocity.x=this.maxWalkSpeed),this.state==a.PATROLLING&&this.moveVelocity.x<-this.maxWalkSpeed&&(this.moveVelocity.x=-this.maxWalkSpeed),this.state==a.CHASING&&this.moveVelocity.x>this.maxRunSpeed&&(this.moveVelocity.x=this.maxRunSpeed),this.state==a.CHASING&&this.moveVelocity.x<-this.maxRunSpeed&&(this.moveVelocity.x=-this.maxRunSpeed),this.rigidBody.linearVelocity=this.moveVelocity,this.moveDirection==c.Direction.LEFT?this.spriteNode.scaleX=1:this.spriteNode.scaleX=-1,this.state!=this.prevState&&(this.state==a.PATROLLING&&this.bodyAnimation.play("walk"),this.state==a.CHASING&&this.bodyAnimation.play("walk"),this.state==a.BUILDING_ATTACK&&this.bodyAnimation.play("IN_attack"),this.state==a.ATTACKING&&this.bodyAnimation.play("attack")),this.prevState=this.state},o([g({type:cc.Enum(r.ActorColorType)})],t.prototype,"colorType",void 0),t=o([m],t)}(d.default);i.default=y,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Config":"Config","./DoesDamage":"DoesDamage","./Game":"Game","./PausableComponent":"PausableComponent","./Placeholder":"Placeholder"}],PatrollingJumperEnemy:[function(e,t,i){"use strict";cc._RF.push(t,"b7616b4+YlM4KQDfYC0AXWd","PatrollingJumperEnemy");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./DoesDamage"),r=e("../core/Utils"),c=e("./Placeholder"),l=e("./Config"),h=e("./Game"),u=e("../core/Singleton"),p=e("../core/audio/AudioScene"),d=e("./PausableComponent"),f=cc._decorator,m=f.ccclass,g=f.property;(function(e){e[e.IDLE=0]="IDLE",e[e.JUMPING=1]="JUMPING",e[e.STUNNED=2]="STUNNED"})(a||(a={}));var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colorType=c.ActorColorType.GREEN,t.bodySprites=[],t.initialDirection=r.Direction.LEFT,t.health=30,t.cookiesSpawnCount=5,t.state=a.IDLE,t.prevState=-1,t.moveVelocity=cc.Vec2.ZERO,t.groundDelayTimeLeft=0,t.facingDirection=r.Direction.LEFT,t.stunnedTimeLeft=0,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){if(t.tag==h.ColliderTag.ENEMY_BODY&&i.tag==h.ColliderTag.PLAYER_ATTACK_AREA){var n=i.getComponent(s.default);this.health-=n.attackDamage;for(var o=function(e){e.setMaterial(0,h.default.instance.spriteOverlayColorMaterial),e.scheduleOnce(function(){return e.setMaterial(0,h.default.instance.builtinSpriteMaterial)},l.CommonEnemiesConfig.damageWhiteFlashTime),r.state!=a.STUNNED&&(r.stunnedTimeLeft=.38)},r=this,c=0,p=this.bodySprites;c<p.length;c++){o(p[c])}this.health<=0?(u.default.getInstance().audioManager.stopSfx(this.lastIDSfx),this.node.destroy(),h.default.instance.spawnPuff(this.node.position.add(cc.v2(0,-25)),h.default.actorColorToEnemyPuffType(this.colorType)),h.default.instance.shakeCamera(h.CameraShakeLevel.MEDIUM),h.default.instance.spawnCollectables(this.node.position,this.cookiesSpawnCount),u.default.getInstance().audioManager.playSfxKillEnemy()):(u.default.getInstance().audioManager.playSfxHitEnemy(),h.default.instance.shakeCamera(h.CameraShakeLevel.LOW))}},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.bodyAnimation.pause(),this.headAnimation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.bodyAnimation.pause(),this.headAnimation.pause()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.rigidBody=this.getComponent(cc.RigidBody),this.spriteNode=this.node.getChildByName("sprite"),this.headNode=this.colorType==c.ActorColorType.GREEN?cc.find("base/node_body/frog_green_body/frog_green_head",this.spriteNode):cc.find("base/node_body/frog_pink_body/frog_pink_head",this.spriteNode),this.doesDamage=this.getComponent(s.default),this.bodyAnimation=this.spriteNode.getComponent(cc.Animation),this.headAnimation=this.headNode.getComponent(cc.Animation),this.bodySprites=r.getAllSubChildrenSprites(cc.find("sprite",this.node))},t.prototype.start=function(){if(this.colorType==c.ActorColorType.GREEN){this.gravity=h.default.instance.getGravity()*l.GreenPatrollingJumperEnemyConfig.gravityFactor;var e=h.default.TILE_SIZE.height*l.GreenPatrollingJumperEnemyConfig.jumpHeight,t=h.default.TILE_SIZE.width*l.GreenPatrollingJumperEnemyConfig.jumpDistance,i=Math.sqrt(-2*e/this.gravity);this.leftPosition=cc.v2(this.node.position.x-.5*t,this.node.position.y),this.rightPosition=cc.v2(this.node.position.x+.5*t,this.node.position.y),this.jumpSpeed=2*e/i,this.moveSpeed=t/(2*i),this.groundDelayTime=l.GreenPatrollingJumperEnemyConfig.groundDelayTime,this.health=l.GreenPatrollingJumperEnemyConfig.health,this.cookiesSpawnCount=l.GreenPatrollingJumperEnemyConfig.cookiesSpawnCount,this.doesDamage.touchDamage=l.GreenPatrollingJumperEnemyConfig.touchDamage}else{this.gravity=h.default.instance.getGravity()*l.PinkPatrollingJumperEnemyConfig.gravityFactor;e=h.default.TILE_SIZE.height*l.PinkPatrollingJumperEnemyConfig.jumpHeight,t=h.default.TILE_SIZE.width*l.PinkPatrollingJumperEnemyConfig.jumpDistance,i=Math.sqrt(-2*e/this.gravity);this.leftPosition=cc.v2(this.node.position.x-.5*t,this.node.position.y),this.rightPosition=cc.v2(this.node.position.x+.5*t,this.node.position.y),this.jumpSpeed=2*e/i,this.moveSpeed=t/(2*i),this.groundDelayTime=l.PinkPatrollingJumperEnemyConfig.groundDelayTime,this.health=l.PinkPatrollingJumperEnemyConfig.health,this.cookiesSpawnCount=l.PinkPatrollingJumperEnemyConfig.cookiesSpawnCount,this.doesDamage.touchDamage=l.PinkPatrollingJumperEnemyConfig.touchDamage}this.groundDelayTimeLeft=this.groundDelayTime,this.facingDirection=this.initialDirection,this.facingDirection==r.Direction.LEFT?this.node.position=this.leftPosition:this.node.position=this.rightPosition},t.prototype.update=function(e){var t=this.state,i=this.facingDirection;if(this.groundDelayTimeLeft>0){var n=this.groundDelayTimeLeft>.5*this.groundDelayTime;this.groundDelayTimeLeft-=e,n=n&&this.groundDelayTimeLeft<=.5*this.groundDelayTime,this.state=a.IDLE,n&&(this.facingDirection==r.Direction.LEFT?this.facingDirection=r.Direction.RIGHT:this.facingDirection=r.Direction.LEFT),this.groundDelayTimeLeft<=0&&(this.groundDelayTimeLeft=0,this.state=a.JUMPING)}t==a.IDLE&&this.state==a.JUMPING&&(this.moveVelocity.y=this.jumpSpeed),this.state==a.JUMPING&&this.node.position.y<this.leftPosition.y&&(this.facingDirection==r.Direction.LEFT?this.node.position=this.leftPosition:this.node.position=this.rightPosition,this.state=a.IDLE,this.groundDelayTimeLeft=this.groundDelayTime,this.moveVelocity=cc.Vec2.ZERO),this.state==a.JUMPING&&(this.facingDirection==r.Direction.LEFT?this.moveVelocity.x=-this.moveSpeed:this.moveVelocity.x=this.moveSpeed,this.moveVelocity.y+=this.gravity*e),this.rigidBody.linearVelocity=this.moveVelocity,this.facingDirection==r.Direction.LEFT&&i==r.Direction.RIGHT&&(this.spriteNode.scaleX=1,this.bodyAnimation.play("IN_jump"),this.playSfxJump()),this.facingDirection==r.Direction.RIGHT&&i==r.Direction.LEFT&&(this.spriteNode.scaleX=-1,this.bodyAnimation.play("IN_jump"),this.playSfxJump()),this.state==a.JUMPING&&t==a.IDLE&&(this.bodyAnimation.play("LOOP_jump"),this.headAnimation.play("blink")),this.state==a.IDLE&&t==a.JUMPING&&this.bodyAnimation.play("OUT_jump"),this.prevState=this.state},t.prototype.playSfxJump=function(){var e=1.1*this.node.width,t=1.1*this.node.height,i=this.node.x-e/2,n=this.node.y-t/2,o=cc.rect(i,n,e,t);this.lastIDSfx=u.default.getInstance().audioManager.playSfxRegion(p.SFXKey.enemy_frog,o)},o([g({type:cc.Enum(c.ActorColorType)})],t.prototype,"colorType",void 0),t=o([m],t)}(d.default);i.default=y,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Config":"Config","./DoesDamage":"DoesDamage","./Game":"Game","./PausableComponent":"PausableComponent","./Placeholder":"Placeholder"}],PatrollingPassiveEnemy:[function(e,t,i){"use strict";cc._RF.push(t,"cfcfbpGsCBJfqL4ClfzAiJt","PatrollingPassiveEnemy");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./Game"),r=e("../core/Utils"),c=e("./DoesDamage"),l=e("./Config"),h=e("./Placeholder"),u=e("../core/Singleton"),p=e("./PausableComponent"),d=cc._decorator,f=d.ccclass,m=d.property;(function(e){e[e.IDLE=0]="IDLE",e[e.WALKING=1]="WALKING",e[e.STUNNED=2]="STUNNED"})(a||(a={}));var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colorType=h.ActorColorType.GREEN,t.bodySprites=[],t.health=50,t.stunnedTime=1,t.leftLimitTiles=5,t.rightLimitTiles=5,t.initialDirection=r.Direction.LEFT,t.moveDirection=r.Direction.LEFT,t.moveVelocity=cc.v2(0,0),t.prevState=-1,t.state=a.IDLE,t.stunnedTimeLeft=0,t.knockbackDirection=r.Direction.NONE,t.enableBoundsCheck=!0,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){if(i.tag==s.ColliderTag.PLAYER_ATTACK_AREA){var n=i.getComponent(c.default);this.knockbackDirection=n.attackDirection,this.stunnedTimeLeft=this.stunnedTime,this.knockbackDirection==r.Direction.LEFT&&(this.moveVelocity.x=-this.knockbackVelocity),this.knockbackDirection==r.Direction.RIGHT&&(this.moveVelocity.x=this.knockbackVelocity),this.health-=n.attackDamage;for(var o=function(e){e.setMaterial(0,s.default.instance.spriteOverlayColorMaterial),e.scheduleOnce(function(){return e.setMaterial(0,s.default.instance.builtinSpriteMaterial)},l.CommonEnemiesConfig.damageWhiteFlashTime)},a=0,h=this.bodySprites;a<h.length;a++){o(h[a])}this.health<=0?(this.node.destroy(),s.default.instance.spawnPuff(this.node.position.add(cc.v2(0,-25)),s.default.actorColorToEnemyPuffType(this.colorType)),s.default.instance.shakeCamera(s.CameraShakeLevel.MEDIUM),s.default.instance.spawnCollectables(this.node.position,this.cookiesSpawnCount),u.default.getInstance().audioManager.playSfxKillEnemy()):(s.default.instance.shakeCamera(s.CameraShakeLevel.LOW),u.default.getInstance().audioManager.playSfxHitEnemy())}},t.prototype.onEndContact=function(e,t,i){i.tag,s.ColliderTag.PLAYER_ATTACK_AREA},t.prototype.getColorType=function(){return this.colorType},t.prototype.disableBoundsCheck=function(){this.enableBoundsCheck=!1},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.bodyAnimation.pause(),this.headAnimation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.bodyAnimation.resume(),this.headAnimation.resume()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.body=this.getComponent(cc.RigidBody),this.spriteNode=this.node.getChildByName("sprite"),this.headNode=cc.find(this.colorType==h.ActorColorType.GREEN?"worm_green_head":"base/worm_pink_head",this.spriteNode),this.sprite=this.spriteNode.getComponent(cc.Sprite),this.bodyAnimation=this.node.getComponent(cc.Animation),this.headAnimation=this.headNode.getComponent(cc.Animation),this.bodySprites=r.getAllSubChildrenSprites(this.spriteNode)},t.prototype.start=function(){this.colorType==h.ActorColorType.GREEN?(this.health=l.GreenPatrollingPassiveEnemyConfig.health,this.stunnedTime=l.GreenPatrollingPassiveEnemyConfig.stunnedTime,this.cookiesSpawnCount=l.GreenPatrollingPassiveEnemyConfig.cookiesSpawnCount,this.maxMoveVelocity=cc.v2(s.default.TILE_SIZE.width*l.GreenPatrollingPassiveEnemyConfig.maxMoveSpeed,0),this.moveAcceleration=this.maxMoveVelocity.x/l.GreenPatrollingPassiveEnemyConfig.moveAccelerationTime,this.leftLimitPoint=this.node.x-this.leftLimitTiles*s.default.TILE_SIZE.width,this.rightLimitPoint=this.node.x+this.rightLimitTiles*s.default.TILE_SIZE.width,this.knockbackVelocity=s.default.TILE_SIZE.width*l.GreenPatrollingPassiveEnemyConfig.knockbackSpeed,this.knockbackFriction=this.knockbackVelocity/Math.max(l.GreenPatrollingPassiveEnemyConfig.knockbackFrictionTime,1e-4),this.getComponent(c.default).touchDamage=l.GreenPatrollingPassiveEnemyConfig.touchDamage):(this.health=l.PinkPatrollingPassiveEnemyConfig.health,this.stunnedTime=l.PinkPatrollingPassiveEnemyConfig.stunnedTime,this.cookiesSpawnCount=l.PinkPatrollingPassiveEnemyConfig.cookiesSpawnCount,this.maxMoveVelocity=cc.v2(s.default.TILE_SIZE.width*l.PinkPatrollingPassiveEnemyConfig.maxMoveSpeed,0),this.moveAcceleration=this.maxMoveVelocity.x/l.PinkPatrollingPassiveEnemyConfig.moveAccelerationTime,this.leftLimitPoint=this.node.x-this.leftLimitTiles*s.default.TILE_SIZE.width,this.rightLimitPoint=this.node.x+this.rightLimitTiles*s.default.TILE_SIZE.width,this.knockbackVelocity=s.default.TILE_SIZE.width*l.PinkPatrollingPassiveEnemyConfig.knockbackSpeed,this.knockbackFriction=this.knockbackVelocity/Math.max(l.PinkPatrollingPassiveEnemyConfig.knockbackFrictionTime,1e-4),this.getComponent(c.default).touchDamage=l.PinkPatrollingPassiveEnemyConfig.touchDamage);this.initialDirection==r.Direction.LEFT?this.moveDirection=r.Direction.LEFT:this.moveDirection=r.Direction.RIGHT,this.state=a.WALKING},t.prototype.update=function(e){this.stunnedTimeLeft>0&&(this.stunnedTimeLeft-=e,this.state=a.STUNNED,this.stunnedTimeLeft<=0&&(this.stunnedTimeLeft=0,this.state=a.WALKING));var t=this.node.position;!this.enableBoundsCheck&&this.node.position.x>=this.leftLimitPoint&&this.node.position.x<=this.rightLimitPoint&&(this.enableBoundsCheck=!0),this.enableBoundsCheck&&this.node.position.x>=this.rightLimitPoint&&(t.x=this.rightLimitPoint,this.moveDirection=r.Direction.LEFT),this.enableBoundsCheck&&this.node.position.x<=this.leftLimitPoint&&(t.x=this.leftLimitPoint,this.moveDirection=r.Direction.RIGHT),this.node.position=t,this.state!=a.STUNNED&&this.moveDirection==r.Direction.LEFT&&(this.moveVelocity.x-=this.moveAcceleration*e),this.state!=a.STUNNED&&this.moveDirection==r.Direction.RIGHT&&(this.moveVelocity.x+=this.moveAcceleration*e),this.state!=a.STUNNED&&this.moveVelocity.x>this.maxMoveVelocity.x&&(this.moveVelocity.x=this.maxMoveVelocity.x),this.state!=a.STUNNED&&this.moveVelocity.x<-this.maxMoveVelocity.x&&(this.moveVelocity.x=-this.maxMoveVelocity.x),this.state==a.STUNNED&&this.moveVelocity.x<0&&(this.moveVelocity.x+=this.knockbackFriction*e,this.moveVelocity.x>0&&(this.moveVelocity.x=0)),this.state==a.STUNNED&&this.moveVelocity.x>0&&(this.moveVelocity.x-=this.knockbackFriction*e,this.moveVelocity.x<0&&(this.moveVelocity.x=0)),this.body.linearVelocity=this.moveVelocity,this.state!=a.STUNNED&&this.moveDirection==r.Direction.LEFT&&(this.spriteNode.scaleX=1,this.moveVelocity.x>-.5?this.state=a.IDLE:this.state=a.WALKING),this.state!=a.STUNNED&&this.moveDirection==r.Direction.RIGHT&&(this.spriteNode.scaleX=-1,this.moveVelocity.x<.5?this.state=a.IDLE:this.state=a.WALKING),this.state!=this.prevState&&(this.state==a.WALKING&&(this.bodyAnimation.play("walk"),this.headAnimation.playAdditive("blink")),this.state==a.STUNNED&&this.bodyAnimation.play("hit")),this.prevState=this.state},o([m({type:cc.Enum(h.ActorColorType)})],t.prototype,"colorType",void 0),t=o([f],t)}(p.default);i.default=g,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","./Config":"Config","./DoesDamage":"DoesDamage","./Game":"Game","./PausableComponent":"PausableComponent","./Placeholder":"Placeholder"}],PausableComponent:[function(e,t,i){"use strict";cc._RF.push(t,"6a98eapgiVE0IYQzlA9gJJ+","PausableComponent");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=cc._decorator,r=s.ccclass;s.property;(function(e){e[e.NotPaused=0]="NotPaused",e[e.Paused=1]="Paused",e[e.Pausing=2]="Pausing",e[e.Resuming=3]="Resuming"})(a||(a={}));var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pauseState=a.NotPaused,t.wasEnabled=!1,t}return n(t,e),Object.defineProperty(t.prototype,"paused",{get:function(){return this.pauseState===a.Paused},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pausing",{get:function(){return this.pauseState===a.Pausing},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resuming",{get:function(){return this.pauseState===a.Resuming},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumed",{get:function(){return this.pauseState===a.NotPaused},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enabled",{get:function(){return Object.getOwnPropertyDescriptor(cc.Component.prototype,"enabled").get.call(this)},set:function(e){this.paused?this.wasEnabled=e:(this.wasEnabled=this.enabled,Object.getOwnPropertyDescriptor(cc.Component.prototype,"enabled").set.call(this,e))},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){cc.systemEvent.on("gameplay-pause",this.onPause,this),cc.systemEvent.on("gameplay-resume",this.onResume,this)},t.prototype.onDestroy=function(){cc.systemEvent.off("gameplay-pause",this.onPause,this),cc.systemEvent.off("gameplay-resume",this.onResume,this)},t.prototype.onPause=function(){this.pauseState=a.Pausing,this.enabled=!1,this.pauseState=a.Paused,this.node.pauseAllActions()},t.prototype.onResume=function(){this.pauseState=a.Resuming,this.enabled=this.wasEnabled,this.wasEnabled=!1,this.pauseState=a.NotPaused,this.node.resumeAllActions()},t=o([r],t)}(cc.Component);i.default=c,cc._RF.pop()},{}],PauseController:[function(e,t,i){"use strict";cc._RF.push(t,"811d4AZkSFN460oyPaCe3uV","PauseController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../core/Singleton"),s=e("../core/audio/AudioScene"),r=cc._decorator,c=r.ccclass,l=r.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeRandomAnimation=10,t.snarfAnimations=["sleep01","sleep02","sleep03","sleep04","sleep05","sleep6"],t.lastAnimationIndex=-1,t}var i;return n(t,e),i=t,t.prototype.onLoad=function(){this.buttonHome=cc.find("base/level_select",this.node).getComponent(cc.Button),this.buttonResume=cc.find("base/play",this.node).getComponent(cc.Button),this.snarfSpine=cc.find("base/pause/snarf",this.node).getComponent(sp.Skeleton),this.animation=this.node.getComponent(cc.Animation);for(var e=0,t=this.node.children.length;e<t;e++)this.node.children[e].active=!1},t.prototype.show=function(){a.default.getInstance().audioManager.changeVolumentMusic(!0),this.disableButtons();for(var e=0,t=this.node.children.length;e<t;e++)this.node.children[e].active=!0;this.animation.play("IN_pause"),this.animation.on("finished",this.showStep2,this)},t.prototype.showStep2=function(){this.enableButtons(),this.animation.off("finished",this.showStep2,this),this.changeAnimation(),this.schedule(this.changeAnimation,this.timeRandomAnimation)},t.prototype.changeAnimation=function(){var e=Math.floor(Math.random()*(this.snarfAnimations.length-1))+1;this.lastAnimationIndex===e&&(e=1===e?e+1:e-1),this.lastAnimationIndex=e;var t=this.snarfAnimations[e];this.snarfSpine.setAnimation(0,t,!1),this.snarfSpine.addAnimation(0,this.snarfAnimations[0],!0)},t.prototype.hide=function(){this.disableButtons(),this.animation.play("OUT_pause"),this.animation.on("finished",this.hideStep2,this)},t.prototype.hideStep2=function(){this.animation.off("finished",this.hideStep2,this);for(var e=0,t=this.node.children.length;e<t;e++)this.node.children[e].active=!1;this.node.emit(i.KEY_SIGNAL_OUT_COMPLETED)},t.prototype.disableButtons=function(){this.buttonHome.interactable=!1,this.buttonResume.interactable=!1},t.prototype.enableButtons=function(){this.buttonHome.interactable=!0,this.buttonResume.interactable=!0},t.prototype.pressGoHome=function(){a.default.getInstance().audioManager.playSfx(s.SFXKey.button_generic),this.node.emit(i.KEY_SIGNAL_HOME)},t.prototype.pressTutorial=function(){a.default.getInstance().audioManager.playSfx(s.SFXKey.button_generic),this.node.emit(i.KEY_SIGNAL_TUTORIAL)},t.prototype.pressResume=function(){a.default.getInstance().audioManager.changeVolumentMusic(!1),a.default.getInstance().audioManager.playSfx(s.SFXKey.button_generic),this.hide(),this.node.emit(i.KEY_SIGNAL_RESUME)},t.KEY_SIGNAL_HOME="home",t.KEY_SIGNAL_TUTORIAL="tutorial",t.KEY_SIGNAL_RESUME="resume",t.KEY_SIGNAL_OUT_COMPLETED="out",o([l(cc.Float)],t.prototype,"timeRandomAnimation",void 0),t=i=o([c],t)}(cc.Component);i.default=h,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/audio/AudioScene":"AudioScene"}],Placeholder:[function(e,t,i){"use strict";cc._RF.push(t,"0e9e0h5XXtAPJ73+xgTSbbp","Placeholder");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s,r,c,l,h,u,p=e("../core/Utils"),d=e("./Game"),f=cc._decorator,m=f.ccclass,g=f.property,y=f.executeInEditMode;(function(e){e[e.PLAYER=0]="PLAYER",e[e.LEVEL_EXIT=1]="LEVEL_EXIT",e[e.SMALL_CRATE=2]="SMALL_CRATE",e[e.MEDIUM_CRATE=3]="MEDIUM_CRATE",e[e.BIG_CRATE=4]="BIG_CRATE",e[e.GREEN_BARRIER=5]="GREEN_BARRIER",e[e.PINK_BARRIER=6]="PINK_BARRIER",e[e.STATIC_ENEMY=7]="STATIC_ENEMY",e[e.PATROLLING_ENEMY=8]="PATROLLING_ENEMY",e[e.SPIKES=9]="SPIKES",e[e.FLAMES=10]="FLAMES",e[e.FLYING_ENEMY=11]="FLYING_ENEMY",e[e.STATIC_PASSIVE_ENEMY=12]="STATIC_PASSIVE_ENEMY",e[e.DOOR=13]="DOOR",e[e.FLYING_CHASER_ENEMY=14]="FLYING_CHASER_ENEMY",e[e.TRAP_PLATFORM=15]="TRAP_PLATFORM",e[e.STATIC_MORTAR_ENEMY=16]="STATIC_MORTAR_ENEMY",e[e.PATROLLING_AGRESSIVE_ENEMY=17]="PATROLLING_AGRESSIVE_ENEMY",e[e.PATROLLING_JUMPER_ENEMY=18]="PATROLLING_JUMPER_ENEMY",e[e.TURRET=19]="TURRET",e[e.UNDEFINED=9999]="UNDEFINED"})(a=i.PlaceholderType||(i.PlaceholderType={})),function(e){e[e.PLAYER=0]="PLAYER",e[e.LEVEL_TUNNEL=100]="LEVEL_TUNNEL",e[e.LEVEL_DOOR=101]="LEVEL_DOOR",e[e.LEVEL_EXIT=102]="LEVEL_EXIT",e[e.CRATE=200]="CRATE",e[e.BARRIER=201]="BARRIER",e[e.SPIKES=300]="SPIKES",e[e.FLAMES=301]="FLAMES",e[e.TRAP_PLATFORM=302]="TRAP_PLATFORM",e[e.TURRET=303]="TURRET",e[e.STATIC_PASSIVE_ENEMY=400]="STATIC_PASSIVE_ENEMY",e[e.STATIC_AGRESSIVE_ENEMY=401]="STATIC_AGRESSIVE_ENEMY",e[e.STATIC_MORTAR_ENEMY=402]="STATIC_MORTAR_ENEMY",e[e.PATROLLING_PASSIVE_ENEMY=403]="PATROLLING_PASSIVE_ENEMY",e[e.PATROLLING_JUMPER_ENEMY=404]="PATROLLING_JUMPER_ENEMY",e[e.PATROLLING_AGRESSIVE_ENEMY=405]="PATROLLING_AGRESSIVE_ENEMY",e[e.FLYING_BOMBER_ENEMY=406]="FLYING_BOMBER_ENEMY",e[e.FLYING_CHASER_ENEMY=407]="FLYING_CHASER_ENEMY",e[e.SPECIAL_COLLECTABLE=500]="SPECIAL_COLLECTABLE"}(s=i.ActorClassType||(i.ActorClassType={})),function(e){e[e.GREEN=0]="GREEN",e[e.PINK=1]="PINK"}(r=i.ActorColorType||(i.ActorColorType={})),function(e){e[e.SMALL=0]="SMALL",e[e.MEDIUM=1]="MEDIUM",e[e.BIG=2]="BIG"}(c=i.ActorSizeType||(i.ActorSizeType={})),function(e){e[e.SWAMP=0]="SWAMP",e[e.MOUNTAIN=1]="MOUNTAIN",e[e.PYRAMID=2]="PYRAMID"}(l=i.ActorWorldType||(i.ActorWorldType={})),function(e){e[e.FIRST=0]="FIRST",e[e.SECOND=1]="SECOND",e[e.THIRD=2]="THIRD"}(h=i.ActorOrderType||(i.ActorOrderType={})),function(e){e[e.VARIANT_1=0]="VARIANT_1",e[e.VARIANT_2=1]="VARIANT_2"}(u=i.ActorVariantType||(i.ActorVariantType={}));var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._type=a.UNDEFINED,t._classType=s.PLAYER,t._colorType=r.GREEN,t._sizeType=c.SMALL,t._worldType=l.SWAMP,t._orderType=h.FIRST,t._variantType=u.VARIANT_1,t._snapPositionToTiles=!0,t._viewHorizontalLimits=!1,t._leftLimitTiles=0,t._rightLimitTiles=0,t._initialDirection=p.Direction.NONE,t.syncDelayFactor=0,t.sceneToLoad="",t.entryName="",t.anchor=cc.v2(0,0),t.originalOffset=cc.v2(0,0),t.finalOffset=cc.v2(0,0),t}var i;return n(t,e),i=t,Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classType",{get:function(){return this._classType},set:function(e){this._classType=e,this.updateRepresentation()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"colorType",{get:function(){return this._colorType},set:function(e){this._colorType=e,this.updateRepresentation()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizeType",{get:function(){return this._sizeType},set:function(e){this._sizeType=e,this.updateRepresentation()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"worldType",{get:function(){return this._worldType},set:function(e){this._worldType=e,this.updateRepresentation()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orderType",{get:function(){return this._orderType},set:function(e){this._orderType=e,this.updateRepresentation()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"variantType",{get:function(){return this._variantType},set:function(e){this._variantType=e,this.updateRepresentation()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"snapPositionToTiles",{get:function(){return this._snapPositionToTiles},set:function(e){this._snapPositionToTiles=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewHorizontalLimits",{get:function(){return this._viewHorizontalLimits},set:function(e){var t,n;(this._viewHorizontalLimits=e,this._viewHorizontalLimits)?((t=this.node.getChildByName("leftLimit"))||((t=cc.instantiate(i.game.roundMarkerPrefab)).name="leftLimit",t.color=cc.Color.GREEN,this.node.addChild(t)),(n=this.node.getChildByName("rightLimit"))||((n=cc.instantiate(i.game.roundMarkerPrefab)).name="rightLimit",n.color=cc.Color.RED,this.node.addChild(n)),this.leftLimitTiles=this._leftLimitTiles,this.rightLimitTiles=this._rightLimitTiles):((t=this.node.getChildByName("leftLimit"))&&t.destroy(),(n=this.node.getChildByName("rightLimit"))&&n.destroy())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftLimitTiles",{get:function(){return this._leftLimitTiles},set:function(e){this._leftLimitTiles=e;var t=this.node.getChildByName("leftLimit");t&&(t.position=cc.v2(-this._leftLimitTiles*d.default.TILE_SIZE.width*this.node.scaleX,0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightLimitTiles",{get:function(){return this._rightLimitTiles},set:function(e){this._rightLimitTiles=e;var t=this.node.getChildByName("rightLimit");t&&(t.position=cc.v2(this._rightLimitTiles*d.default.TILE_SIZE.width*this.node.scaleX,0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initialDirection",{get:function(){return this._initialDirection},set:function(e){this._initialDirection=e,this._initialDirection==p.Direction.LEFT?i.placeholderTypeOriginalDirection(this.classType)==p.Direction.LEFT?this.node.scaleX=1:this.node.scaleX=-1:i.placeholderTypeOriginalDirection(this.classType)==p.Direction.LEFT?this.node.scaleX=-1:this.node.scaleX=1,this.leftLimitTiles=this._leftLimitTiles,this.rightLimitTiles=this._rightLimitTiles},enumerable:!0,configurable:!0}),t.placeholderTypeToString=function(e){switch(e){case s.PLAYER:return"player";case s.LEVEL_TUNNEL:return"tunnel";case s.LEVEL_DOOR:return"door";case s.LEVEL_EXIT:return"exit";case s.CRATE:return"crate";case s.BARRIER:return"barrier";case s.SPIKES:return"spikes";case s.FLAMES:return"flames";case s.TRAP_PLATFORM:return"trapPlatform";case s.TURRET:return"turret";case s.STATIC_PASSIVE_ENEMY:return"staticPassiveEnemy";case s.STATIC_AGRESSIVE_ENEMY:return"staticAgressiveEnemy";case s.STATIC_MORTAR_ENEMY:return"staticMortarEnemy";case s.PATROLLING_PASSIVE_ENEMY:return"patrollingPassiveEnemy";case s.PATROLLING_JUMPER_ENEMY:return"patrollingJumperEnemy";case s.PATROLLING_AGRESSIVE_ENEMY:return"patrollingAgressiveEnemy";case s.FLYING_BOMBER_ENEMY:return"flyingBomberEnemy";case s.FLYING_CHASER_ENEMY:return"flyingChaserEnemy";case s.SPECIAL_COLLECTABLE:return"specialCollectable";default:return"Placeholder"}},t.placeholderNameIsStandard=function(e){if("Placeholder"==e)return!0;for(var t in s){var i=Number(s[t]);if(e==this.placeholderTypeToString(i))return!0}return!1},t.placeholderTypeOriginalDirection=function(e){switch(e){case s.PLAYER:case s.LEVEL_TUNNEL:return p.Direction.RIGHT;default:return p.Direction.LEFT}},t.placeholderTypeToActorClassType=function(e){switch(e){case a.PLAYER:return s.PLAYER;case a.LEVEL_EXIT:return s.LEVEL_TUNNEL;case a.SMALL_CRATE:case a.MEDIUM_CRATE:case a.BIG_CRATE:return s.CRATE;case a.GREEN_BARRIER:case a.PINK_BARRIER:return s.BARRIER;case a.STATIC_ENEMY:return s.STATIC_AGRESSIVE_ENEMY;case a.PATROLLING_ENEMY:return s.PATROLLING_PASSIVE_ENEMY;case a.SPIKES:return s.SPIKES;case a.FLAMES:return s.FLAMES;case a.FLYING_ENEMY:return s.FLYING_BOMBER_ENEMY;case a.STATIC_PASSIVE_ENEMY:return s.STATIC_PASSIVE_ENEMY;case a.DOOR:return s.LEVEL_DOOR;case a.FLYING_CHASER_ENEMY:return s.FLYING_CHASER_ENEMY;case a.TRAP_PLATFORM:return s.TRAP_PLATFORM;case a.STATIC_MORTAR_ENEMY:return s.STATIC_MORTAR_ENEMY;case a.PATROLLING_AGRESSIVE_ENEMY:return s.PATROLLING_AGRESSIVE_ENEMY;case a.PATROLLING_JUMPER_ENEMY:return s.PATROLLING_JUMPER_ENEMY;case a.TURRET:return s.TURRET;default:return s.PLAYER}},t.placeholderTypeToActorColorType=function(e){switch(e){case a.PINK_BARRIER:return r.PINK;default:return r.GREEN}},t.placeholderTypeToActorSizeType=function(e){switch(e){case a.MEDIUM_CRATE:return c.MEDIUM;case a.BIG_CRATE:return c.BIG;default:return c.SMALL}},t.placeholderTypeToActorWorldType=function(e){return l.SWAMP},t.directionToAngle=function(e){switch(e){case p.Direction.LEFT:return 1*Math.PI;case p.Direction.RIGHT:return 0*Math.PI;case p.Direction.DOWN:return 1.5*Math.PI;case p.Direction.UP:return.5*Math.PI}return 0},t.prototype.calculateFinalOffset=function(){var e=p.Direction.NONE;switch(this.node.angle){case 0:e=p.Direction.UP;break;case-270:case 90:e=p.Direction.LEFT;break;case-180:case 180:e=p.Direction.DOWN;break;case-90:case 270:e=p.Direction.RIGHT}switch(e){case p.Direction.UP:this.finalOffset=cc.v2(this.originalOffset.x,this.originalOffset.y);break;case p.Direction.LEFT:this.finalOffset=cc.v2(this.originalOffset.y,this.originalOffset.x);break;case p.Direction.RIGHT:this.finalOffset=cc.v2(this.originalOffset.y,-this.originalOffset.x);break;case p.Direction.DOWN:this.finalOffset=cc.v2(-this.originalOffset.x,-this.originalOffset.y)}},t.prototype.showColorType=function(){switch(this._classType){case s.BARRIER:case s.TRAP_PLATFORM:case s.STATIC_PASSIVE_ENEMY:case s.STATIC_AGRESSIVE_ENEMY:case s.STATIC_MORTAR_ENEMY:case s.PATROLLING_PASSIVE_ENEMY:case s.PATROLLING_JUMPER_ENEMY:case s.PATROLLING_AGRESSIVE_ENEMY:case s.FLYING_BOMBER_ENEMY:case s.FLYING_CHASER_ENEMY:return!0;default:return!1}},t.prototype.showSizeType=function(){switch(this._classType){case s.CRATE:return!0;default:return!1}},t.prototype.showWorldType=function(){switch(this._classType){case s.LEVEL_TUNNEL:case s.LEVEL_DOOR:return!0;default:return!1}},t.prototype.showOrderType=function(){switch(this._classType){case s.SPECIAL_COLLECTABLE:return!0;default:return!1}},t.prototype.showVariantType=function(){switch(this._classType){case s.LEVEL_TUNNEL:return!0;default:return!1}},t.prototype.showSceneFields=function(){switch(this._classType){case s.LEVEL_TUNNEL:case s.LEVEL_DOOR:return!0;default:return!1}},t.prototype.updateRepresentation=function(){var e=null;switch(this._classType){case s.PLAYER:e=i.game.playerPrefab;break;case s.LEVEL_TUNNEL:this._worldType==l.SWAMP&&(e=i.game.swampTunnelPrefab),this._worldType==l.MOUNTAIN&&(e=i.game.mountainTunnelPrefab),this._worldType==l.PYRAMID&&(e=i.game.pyramidTunnelPrefab);break;case s.LEVEL_DOOR:this._worldType==l.SWAMP&&(e=i.game.swampDoorPrefab),this._worldType==l.MOUNTAIN&&(e=i.game.swampDoorPrefab),this._worldType==l.PYRAMID&&(e=i.game.swampDoorPrefab);break;case s.LEVEL_EXIT:e=i.game.exitTunnelPrefab;break;case s.CRATE:this._sizeType==c.SMALL&&(e=i.game.smallCratePrefab),this._sizeType==c.MEDIUM&&(e=i.game.mediumCratePrefab),this._sizeType==c.BIG&&(e=i.game.bigCratePrefab);break;case s.BARRIER:this._colorType==r.GREEN&&(e=i.game.greenBarrierPrefab),this._colorType==r.PINK&&(e=i.game.pinkBarrierPrefab);break;case s.SPIKES:e=i.game.spikesPrefab;break;case s.FLAMES:e=i.game.flamesPrefab;break;case s.TRAP_PLATFORM:this._colorType==r.GREEN&&(e=i.game.greenTrapPlatformPrefab),this._colorType==r.PINK&&(e=i.game.pinkTrapPlatformPrefab);break;case s.TURRET:e=i.game.turretPrefab;break;case s.STATIC_PASSIVE_ENEMY:this._colorType==r.GREEN&&(e=i.game.greenStaticPassiveEnemyPrefab),this._colorType==r.PINK&&(e=i.game.pinkStaticPassiveEnemyPrefab);break;case s.STATIC_AGRESSIVE_ENEMY:this._colorType==r.GREEN&&(e=i.game.greenStaticAgressiveEnemyPrefab),this._colorType==r.PINK&&(e=i.game.pinkStaticAgressiveEnemyPrefab);break;case s.STATIC_MORTAR_ENEMY:this._colorType==r.GREEN&&(e=i.game.greenStaticMortarEnemyPrefab),this._colorType==r.PINK&&(e=i.game.pinkStaticMortarEnemyPrefab);break;case s.PATROLLING_PASSIVE_ENEMY:this._colorType==r.GREEN&&(e=i.game.greenPatrollingPassiveEnemyPrefab),this._colorType==r.PINK&&(e=i.game.pinkPatrollingPassiveEnemyPrefab);break;case s.PATROLLING_JUMPER_ENEMY:this._colorType==r.GREEN&&(e=i.game.greenPatrollingJumperEnemyPrefab),this._colorType==r.PINK&&(e=i.game.pinkPatrollingJumperEnemyPrefab);break;case s.PATROLLING_AGRESSIVE_ENEMY:this._colorType==r.GREEN&&(e=i.game.greenPatrollingAgressiveEnemyPrefab),this._colorType==r.PINK&&(e=i.game.pinkPatrollingAgressiveEnemyPrefab);break;case s.FLYING_BOMBER_ENEMY:this._colorType==r.GREEN&&(e=i.game.greenFlyingBomberEnemyPrefab),this._colorType==r.PINK&&(e=i.game.pinkFlyingBomberEnemyPrefab);break;case s.FLYING_CHASER_ENEMY:this._colorType==r.GREEN&&(e=i.game.greenFlyingChaserEnemyPrefab),this._colorType==r.PINK&&(e=i.game.pinkFlyingChaserEnemyPrefab);break;case s.SPECIAL_COLLECTABLE:e=i.game.specialCollectablePrefab}if(e){i.placeholderNameIsStandard(this.node.name)&&(this.node.name=i.placeholderTypeToString(this._classType));var t=e.data.getChildByName("placeholder");t?this.node.color=cc.Color.WHITE:t=i.game.bigCratePrefab.data.getChildByName("placeholder"),this.node.width=t.width,this.node.height=t.height,this.originalOffset=cc.v2(e.data.position),this.originalOffset.x+=.5*d.default.TILE_SIZE.width,this.anchor=cc.v2(t.anchorX,t.anchorY),this.node.anchorX=this.anchor.x,this.node.anchorY=this.anchor.y,this.getComponent(cc.Sprite).spriteFrame=t.getComponent(cc.Sprite).spriteFrame,this.calculateFinalOffset(),this.initialDirection=this._initialDirection}},t.prototype.start=function(){},t.prototype.update=function(e){},t.isFirst=!1,t.game=null,o([g({type:cc.Enum(a)})],t.prototype,"_type",void 0),o([g({type:cc.Enum(s)})],t.prototype,"_classType",void 0),o([g({type:cc.Enum(r)})],t.prototype,"_colorType",void 0),o([g({type:cc.Enum(c)})],t.prototype,"_sizeType",void 0),o([g({type:cc.Enum(l)})],t.prototype,"_worldType",void 0),o([g({type:cc.Enum(h)})],t.prototype,"_orderType",void 0),o([g({type:cc.Enum(u)})],t.prototype,"_variantType",void 0),o([g],t.prototype,"_snapPositionToTiles",void 0),o([g],t.prototype,"_viewHorizontalLimits",void 0),o([g],t.prototype,"_leftLimitTiles",void 0),o([g],t.prototype,"_rightLimitTiles",void 0),o([g],t.prototype,"_initialDirection",void 0),o([g({type:cc.Enum(a),visible:!1})],t.prototype,"type",null),o([g({type:cc.Enum(s)})],t.prototype,"classType",null),o([g({type:cc.Enum(r),visible:function(){return this.showColorType()}})],t.prototype,"colorType",null),o([g({type:cc.Enum(c),visible:function(){return this.showSizeType()}})],t.prototype,"sizeType",null),o([g({type:cc.Enum(l),visible:function(){return this.showWorldType()}})],t.prototype,"worldType",null),o([g({type:cc.Enum(h),visible:function(){return this.showOrderType()}})],t.prototype,"orderType",null),o([g({type:cc.Enum(u),visible:function(){return this.showVariantType()}})],t.prototype,"variantType",null),o([g],t.prototype,"snapPositionToTiles",null),o([g],t.prototype,"viewHorizontalLimits",null),o([g],t.prototype,"leftLimitTiles",null),o([g],t.prototype,"rightLimitTiles",null),o([g({type:cc.Enum(p.Direction)})],t.prototype,"initialDirection",null),o([g],t.prototype,"syncDelayFactor",void 0),o([g({tooltip:"scene name of the level to load",visible:function(){return this.showSceneFields()}})],t.prototype,"sceneToLoad",void 0),o([g({tooltip:"name of the placeholder node to act as entry point of the level",visible:function(){return this.showSceneFields()}})],t.prototype,"entryName",void 0),t=i=o([m,y],t)}(cc.Component);i.default=v,cc._RF.pop()},{"../core/Utils":"Utils","./Game":"Game"}],PlayerController:[function(e,t,i){"use strict";cc._RF.push(t,"9672bVCv8FJUqQcNbuPzZnO","PlayerController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./CharacterBaseController"),s=e("./StageController"),r=e("../../core/Utils"),c=e("../Game"),l=e("../../core/Singleton"),h=cc._decorator,u=h.ccclass,p=(h.property,h.menu),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stageController=null,t.alternativeControls=!1,t._isActive=!1,t.isLeftPressed=!1,t.isRightPressed=!1,t.isJumpPressed=!1,t.isAttackPressed=!1,t.isSpecialPressed=!1,t.inputEnabled=!0,t.wasInputEnabled=!0,t.inputPaused=!1,t.leftPressedTime=0,t.rightPressedTime=0,t.jumpPressedTime=0,t.attackPressedTime=0,t.specialPressedTime=0,t.leftReleasedTime=0,t.rightReleasedTime=0,t.jumpReleasedTime=0,t.attackReleasedTime=0,t.specialReleasedTime=0,t}return n(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this);var t=cc.find("GAMEPLAY");console.info("Gameplay node: "+t),t&&(this.stageController=t.getComponent(s.default))},t.prototype.update=function(t){e.prototype.update.call(this,t),this.isActive&&(this.isLeftPressed?this.leftPressedTime+=t:this.leftReleasedTime+=t,this.isRightPressed?this.rightPressedTime+=t:this.rightReleasedTime+=t,this.isJumpPressed?this.jumpPressedTime+=t:this.jumpReleasedTime+=t,this.isAttackPressed?(this.attackPressedTime+=t,this.onAttackButtonHeld(this.attackPressedTime)):this.attackReleasedTime+=t,this.isSpecialPressed?(this.specialPressedTime+=t,this.onSpecialButtonHeld(this.specialPressedTime)):this.specialReleasedTime+=t)},Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},set:function(e){this._isActive=e,e||(this.isLeftPressed=!1,this.isRightPressed=!1,this.isJumpPressed=!1,this.isAttackPressed=!1,this.isSpecialPressed=!1)},enumerable:!0,configurable:!0}),t.prototype.isInputEnabled=function(){return this.inputEnabled},t.prototype.onEnable=function(){this.resumed&&this.resumeInput(),console.info("onEnable")},t.prototype.onDisable=function(){this.resumed&&this.pauseInput(),console.info("onDisable")},t.prototype.onKeyDown=function(e){if(!cc.director.isPaused()&&this.isActive){var t=e.keyCode;(t==cc.macro.KEY.left||this.alternativeControls&&t==cc.macro.KEY.a)&&!this.isLeftPressed?(this.isLeftPressed=!0,this.leftPressedTime=0,this.setMoveRequest(r.Direction.LEFT)):(t==cc.macro.KEY.right||this.alternativeControls&&t==cc.macro.KEY.d)&&!this.isRightPressed?(this.isRightPressed=!0,this.rightPressedTime=0,this.setMoveRequest(r.Direction.RIGHT)):(t==cc.macro.KEY.up||this.alternativeControls&&t==cc.macro.KEY.k)&&!this.isJumpPressed?(this.isJumpPressed=!0,this.jumpPressedTime=0,this.resumed&&this.setJumpRequest(this.isJumpPressed)):(t==cc.macro.KEY[l.default.getInstance().attackKey]||this.alternativeControls&&t==cc.macro.KEY.l)&&!this.isAttackPressed?(this.isAttackPressed=!0,this.attackPressedTime=0,this.onAttackButtonPressed(this.attackReleasedTime)):(t==cc.macro.KEY[l.default.getInstance().specialKey]||this.alternativeControls&&t==cc.macro.KEY.j)&&!this.isSpecialPressed&&(this.isSpecialPressed=!0,this.specialPressedTime=0,this.onSpecialButtonPressed(this.specialPressedTime))}},t.prototype.onKeyUp=function(e){if(!cc.director.isPaused()&&this.isActive){var t=e.keyCode;(t==cc.macro.KEY.left||this.alternativeControls&&t==cc.macro.KEY.a)&&this.isLeftPressed&&(this.isLeftPressed=!1,this.leftReleasedTime=0,this.isRightPressed?this.setMoveRequest(r.Direction.RIGHT):this.setMoveRequest(r.Direction.NONE)),(t==cc.macro.KEY.right||this.alternativeControls&&t==cc.macro.KEY.d)&&this.isRightPressed&&(this.isRightPressed=!1,this.rightReleasedTime=0,this.isLeftPressed?this.setMoveRequest(r.Direction.LEFT):this.setMoveRequest(r.Direction.NONE)),(t==cc.macro.KEY.up||this.alternativeControls&&t==cc.macro.KEY.k)&&this.isJumpPressed&&(this.isJumpPressed=!1,this.jumpReleasedTime=0,this.setJumpRequest(this.isJumpPressed)),(t==cc.macro.KEY[l.default.getInstance().attackKey]||this.alternativeControls&&t==cc.macro.KEY.l)&&this.isAttackPressed&&(this.isAttackPressed=!1,this.attackReleasedTime=0,this.onAttackButtonReleased(this.attackPressedTime)),(t==cc.macro.KEY[l.default.getInstance().specialKey]||this.alternativeControls&&t==cc.macro.KEY.j)&&this.isSpecialPressed&&(this.isSpecialPressed=!1,this.specialReleasedTime=0,this.onSpecialButtonReleased(this.specialPressedTime))}},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.pauseInput(),console.info("onPause")},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.resumeInput(),console.info("onResume")},t.prototype.pauseInput=function(){console.info("pauseInput inputEnabled: "+this.inputEnabled+"  inputPaused: "+this.inputPaused),this.inputPaused||(this.inputPaused=!0,this.wasInputEnabled=this.inputEnabled,this.disableInput())},t.prototype.resumeInput=function(){console.info("resumeInput inputEnabled: "+this.inputEnabled+"  wasInputEnabled: "+this.wasInputEnabled+"  inputPaused: "+this.inputPaused),this.inputPaused&&(this.inputPaused=!1,this.wasInputEnabled&&this.enableInput())},t.prototype.resetInput=function(){this.setMoveRequest(r.Direction.NONE),this.isJumpPressed&&this.setJumpRequest(!1),this.isAttackPressed&&this.onAttackButtonReleased(this.attackPressedTime),this.isSpecialPressed&&this.onSpecialButtonReleased(this.specialPressedTime),this.isLeftPressed=!1,this.isRightPressed=!1,this.isJumpPressed=!1,this.isAttackPressed=!1,this.isSpecialPressed=!1,this.leftPressedTime=0,this.rightPressedTime=0,this.jumpPressedTime=0,this.attackPressedTime=0,this.specialPressedTime=0,this.leftReleasedTime=0,this.rightReleasedTime=0,this.jumpReleasedTime=0,this.attackReleasedTime=0,this.specialReleasedTime=0},t.prototype.disableInput=function(){this.inputEnabled&&(this.inputEnabled=!1,cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.resetInput(),c.default.instance.gameplayUI.lockMobileButtons())},t.prototype.enableInput=function(){this.inputEnabled||(this.inputEnabled=!0,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.resetInput(),c.default.instance.gameplayUI.unlockMobileButtons())},t=o([u,p("Game Component/Controllers/PlayerController")],t)}(a.default);i.default=d,cc._RF.pop()},{"../../core/Singleton":"Singleton","../../core/Utils":"Utils","../Game":"Game","./CharacterBaseController":"CharacterBaseController","./StageController":"StageController"}],Projectile:[function(e,t,i){"use strict";cc._RF.push(t,"55e4cosyCdAcobbIsaOi+mq","Projectile");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./Game"),r=e("../core/Utils"),c=e("./DoesDamage"),l=e("./Config"),h=e("../core/Singleton"),u=e("../core/audio/AudioScene"),p=e("./PausableComponent"),d=cc._decorator,f=d.ccclass,m=d.property;(function(e){e[e.GREEN_BOMBER=0]="GREEN_BOMBER",e[e.PINK_BOMBER=1]="PINK_BOMBER",e[e.GREEN_MORTAR=2]="GREEN_MORTAR",e[e.PINK_MORTAR=3]="PINK_MORTAR",e[e.TURRET=4]="TURRET",e[e.CAPSULE=5]="CAPSULE",e[e.PLASMA=6]="PLASMA"})(a=i.ProjectileType||(i.ProjectileType={}));var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=a.CAPSULE,t.rigidBody=null,t.spriteNode=null,t.doesDamage=null,t.animation=null,t.puffType=null,t.enableRotation=!1,t.throwAngle=0,t.throwSpeed=0,t.gravityScale=1,t.collidesWithPlatforms=!0,t.facingDirection=r.Direction.LEFT,t.prevPosition=null,t}return n(t,e),t.prototype.parry=function(){s.default.instance.spawnPuff(cc.v2(this.node.position),this.puffType),this.playSfxColliion(),this.node.destroy()},t.prototype.onBeginContact=function(e,t,i){this.type==a.CAPSULE?(i.tag==s.ColliderTag.TERRAIN||i.tag==s.ColliderTag.PLATFORM&&this.collidesWithPlatforms||i.tag==s.ColliderTag.ENEMY_BODY)&&(s.default.instance.spawnExplosion(this.node.position.add(cc.v2(0,-25)),this.doesDamage.attackDamage),this.playSfxColliion(),this.node.destroy()):(i.tag==s.ColliderTag.TERRAIN||i.tag==s.ColliderTag.PLATFORM&&this.collidesWithPlatforms||i.tag==s.ColliderTag.PLAYER_BODY)&&(s.default.instance.spawnPuff(cc.v2(this.node.position),this.puffType),this.playSfxColliion(),this.node.destroy())},t.prototype.playSfxColliion=function(){var e=1.1*this.node.width,t=1.1*this.node.height,i=this.node.x-e/2,n=this.node.y-t/2,o=cc.rect(i,n,e,t);switch(this.type){case a.GREEN_BOMBER:case a.PINK_BOMBER:case a.GREEN_MORTAR:case a.PINK_MORTAR:h.default.getInstance().audioManager.playSfxRegion(u.SFXKey.enemy_mortar2,o);break;case a.TURRET:h.default.getInstance().audioManager.playSfxRegion(u.SFXKey.obstacle_turret2,o);break;case a.CAPSULE:h.default.getInstance().audioManager.playSfx(u.SFXKey.special_wilykids3);break;case a.PLASMA:h.default.getInstance().audioManager.playSfx(u.SFXKey.bosslevel_mutants5)}},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.animation&&this.animation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.animation&&this.animation.resume()},t.prototype.onLoad=function(){switch(e.prototype.onLoad.call(this),this.rigidBody=this.getComponent(cc.RigidBody),this.spriteNode=this.node.getChildByName("sprite"),this.doesDamage=this.getComponent(c.default),this.animation=this.node.getComponent(cc.Animation),this.type){case a.GREEN_BOMBER:this.doesDamage.touchDamage=l.GreenFlyingBomberEnemyConfig.attackDamage,this.puffType=s.PuffType.GREEN_PROJECTILE_PUFF;break;case a.PINK_BOMBER:this.doesDamage.touchDamage=l.PinkFlyingBomberEnemyConfig.attackDamage,this.puffType=s.PuffType.PINK_PROJECTILE_PUFF;break;case a.GREEN_MORTAR:this.doesDamage.touchDamage=l.GreenStaticMortarEnemyConfig.attackDamage,this.puffType=s.PuffType.GREEN_PROJECTILE_PUFF,this.enableRotation=!0;break;case a.PINK_MORTAR:this.doesDamage.touchDamage=l.PinkStaticMortarEnemyConfig.attackDamage,this.puffType=s.PuffType.PINK_PROJECTILE_PUFF,this.enableRotation=!0;break;case a.TURRET:this.doesDamage.touchDamage=l.TurretConfig.projectileDamage,this.puffType=s.PuffType.PINK_PROJECTILE_PUFF,this.animation=cc.find("node_fire/turret_fire",this.spriteNode).getComponent(cc.Animation);break;case a.CAPSULE:this.doesDamage.touchDamage=0,this.doesDamage.attackDamage=l.UpgradesConfig.rangeAttackDamage;break;case a.PLASMA:this.doesDamage.touchDamage=l.SecondBossShipConfig.plasmaDamage,this.puffType=s.PuffType.PINK_PROJECTILE_PUFF,this.animation=this.spriteNode.getComponent(cc.Animation)}},t.prototype.start=function(){this.enableRotation?this.spriteNode.angle=cc.misc.radiansToDegrees(this.throwAngle+.5*Math.PI):this.throwAngle>=.5*Math.PI&&this.throwAngle<1.5*Math.PI?this.spriteNode.scaleX=1:this.spriteNode.scaleX=-1;var e=this.throwSpeed*Math.cos(this.throwAngle),t=this.throwSpeed*Math.sin(this.throwAngle);this.rigidBody.gravityScale=this.gravityScale,this.rigidBody.linearVelocity=cc.v2(e,t)},t.prototype.update=function(e){if(this.enableRotation&&this.prevPosition&&!this.node.position.sub(this.prevPosition).equals(cc.Vec2.ZERO)){var t=r.cartesianToPolarAngle(this.node.position.sub(this.prevPosition));this.spriteNode.angle=cc.misc.radiansToDegrees(t+.5*Math.PI)}this.prevPosition=this.node.position},o([m({type:cc.Enum(a)})],t.prototype,"type",void 0),t=o([f],t)}(p.default);i.default=g,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Config":"Config","./DoesDamage":"DoesDamage","./Game":"Game","./PausableComponent":"PausableComponent"}],ResizeScreenManager:[function(e,t,i){"use strict";cc._RF.push(t,"cb1218mNolIC6w1k2og9sOW","ResizeScreenManager");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./Utils"),a=function(e){function t(){var t=e.call(this)||this;return t.initListener(),t}return n(t,e),t.prototype.initListener=function(){o.isMobile()?window.addEventListener("resize",this.onResized.bind(this)):cc.view.on("canvas-resize",this.onResized,this)},t.prototype.onResized=function(){this.emit(t.KEY_SIGNAL_RESIZE_PRIORITY),setTimeout(this.sendSignal.bind(this),1)},t.prototype.sendSignal=function(){this.emit(t.KEY_SIGNAL_RESIZE)},t.KEY_SIGNAL_RESIZE="resize",t.KEY_SIGNAL_RESIZE_PRIORITY="resizePriority",t}(cc.Node);i.default=a,cc._RF.pop()},{"./Utils":"Utils"}],RotateScreenManager:[function(e,t,i){"use strict";cc._RF.push(t,"adf25qroUNAFJ71CYtkt4Hq","RotateScreenManager");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o,a=e("./Utils");(function(e){e[e.css=0]="css",e[e.scene=1]="scene"})(o||(o={}));var s=function(e){function t(){var t=e.call(this)||this;return t.percentSizeImage=60,t.landscapeLocked=!0,t.portraitLocked=!1,t.idContainerRotation="orientation-screen",t.idContainerGame="GameCanvas",t.type=o.css,t.correctOrientation=!0,t.initListener(),t.setStyleImage(),t}return n(t,e),t.prototype.setStyleImage=function(){document.getElementById(this.idContainerRotation)&&(this.landscapeLocked&&(document.getElementById(this.idContainerRotation).style.backgroundSize=this.percentSizeImage+"vw"),this.portraitLocked&&(document.getElementById(this.idContainerRotation).style.backgroundSize=this.percentSizeImage+"vh"))},t.prototype.initListener=function(){a.isMobile()&&(window.addEventListener("resize",this.checkOrientation.bind(this)),this.checkOrientation())},t.prototype.checkOrientation=function(){var e=cc.game.frame,t=e.clientWidth,i=e.clientHeight;this.landscapeLocked?t>i?this.handleCorrect():this.handleIncorrect():this.portraitLocked&&(t<i?this.handleCorrect():this.handleIncorrect())},t.prototype.handleCorrect=function(){document.getElementById(this.idContainerRotation)&&this.type===o.css&&(document.getElementById(this.idContainerRotation).style.display="none",this.correctOrientation||(cc.game.resume(),this.emit(t.KEY_SIGNAL_CORRECT)),this.correctOrientation=!0)},t.prototype.handleIncorrect=function(){document.getElementById(this.idContainerRotation)&&this.type===o.css&&(document.getElementById(this.idContainerRotation).style.display="block",this.correctOrientation&&(cc.game.pause(),this.emit(t.KEY_SIGNAL_INCORRECT)),this.correctOrientation=!1)},t.KEY_SIGNAL_CORRECT="handleCorrect",t.KEY_SIGNAL_INCORRECT="handleIncorrect",t}(cc.Node);i.default=s,cc._RF.pop()},{"./Utils":"Utils"}],Shaker:[function(e,t,i){"use strict";cc._RF.push(t,"c6b6ePkNNNM5r892CpJ3j6e","Shaker");var n=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,a=o.ccclass,s=(o.property,function(){function e(){this.magnitude=0,this.duration=0,this.bumpsCount=1,this.bumpPoints=[],this.bumpDuration=0,this.elapsedTime=0}return e.prototype.shake=function(e,t){void 0===t&&(t=-1),this.generatePoints(t);var i=cc.v2(e.position),n=cc.tween(e);n.to(.5*this.bumpDuration,{position:i.add(this.bumpPoints[0]),easing:"quadOut"});for(var o=1;o<this.bumpPoints.length-1;++o)n.to(this.bumpDuration,{position:i.add(this.bumpPoints[o]),easing:"quadInOut"});n.to(this.bumpDuration,{position:i,easing:"elasticOut"}),n.start()},e.prototype.manualShake=function(e){void 0===e&&(e=-1),this.generatePoints(e)},e.prototype.getOffset=function(e){if(this.elapsedTime+=e,this.elapsedTime>=this.duration)return cc.Vec2.ZERO;var t=this.elapsedTime/this.duration*(this.bumpsCount+1),i=Math.floor(t),n=t-i,o=i>0?this.bumpPoints[i-1]:cc.Vec2.ZERO,a=i<this.bumpsCount?this.bumpPoints[i]:cc.Vec2.ZERO;return 0==i?o.lerp(a,cc.easing.quadOut(n)):o.lerp(a,cc.easing.quadInOut(n))},e.prototype.generatePoints=function(e){void 0===e&&(e=-1),this.bumpDuration=this.duration/this.bumpsCount;var t=e<0?Math.random()*Math.PI*2:e;this.bumpPoints=[];for(var i=0;i<this.bumpsCount;++i){t>2*Math.PI&&(t-=2*Math.PI);var n=this.magnitude*Math.cos(t),o=this.magnitude*Math.sin(t);this.bumpPoints.push(cc.v2(n,o)),t+=Math.PI+(2*Math.random()-1)*Math.PI*.3}this.elapsedTime=0},e=n([a],e)}());i.default=s,cc._RF.pop()},{}],SimplifiedAudioSettingsController:[function(e,t,i){"use strict";cc._RF.push(t,"037e5+kgV1Dh4TC6zVfUuwU","SimplifiedAudioSettingsController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./AudioSettingsController"),s=e("../input/KeyBoardController"),r=e("../core/Singleton"),c=cc._decorator,l=c.ccclass,h=c.property,u=c.menu,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.audioButton=null,t.audioEnabledSprites=new a.AudioSettingButtonSprites,t.audioDisabledSprites=new a.AudioSettingButtonSprites,t.keyboard=null,t}return n(t,e),t.prototype.playButtonSound=function(){},t.prototype.changeButtonSprites=function(e,t){e.normalSprite=t.normal,e.pressedSprite=t.pressed,e.hoverSprite=t.hover,e.disabledSprite=t.disabled,this.keyboard&&this.keyboard.updateButtonFrames(e)},t.prototype.suscribeSwitchBehaviour=function(e,t){var i=new cc.Component.EventHandler;i.target=this.node,i.component="SimplifiedAudioSettingsController",i.handler=t,e.clickEvents.push(i)},t.prototype.onLoad=function(){this.instance=r.default.getInstance(),this.isEnabled=this.instance.dataManager.getSounds(),this.audioEnabledSprites.size=this.audioButton.node.getContentSize(),this.audioDisabledSprites.size=this.audioButton.node.getContentSize(),this.setFrames(),this.suscribeSwitchBehaviour(this.audioButton,"switchAudioState")},t.prototype.switchAudioState=function(){this.playButtonSound(),this.isEnabled=!this.isEnabled,this.instance.audioManager.mute(!this.isEnabled),this.instance.dataManager.setSounds(this.isEnabled),this.setFrames()},t.prototype.setFrames=function(){this.isEnabled?this.changeButtonSprites(this.audioButton,this.audioEnabledSprites):this.changeButtonSprites(this.audioButton,this.audioDisabledSprites)},o([h(cc.Button)],t.prototype,"audioButton",void 0),o([h(a.AudioSettingButtonSprites)],t.prototype,"audioEnabledSprites",void 0),o([h(a.AudioSettingButtonSprites)],t.prototype,"audioDisabledSprites",void 0),o([h(s.default)],t.prototype,"keyboard",void 0),t=o([l,u("Game Component/SimplifiedAudioSettingsController")],t)}(cc.Component);i.default=p,cc._RF.pop()},{"../core/Singleton":"Singleton","../input/KeyBoardController":"KeyBoardController","./AudioSettingsController":"AudioSettingsController"}],Singleton:[function(e,t,i){"use strict";cc._RF.push(t,"f9acd6AIfhPr5cG2E+8KZfT","Singleton");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./FocusHandler"),s=e("./RotateScreenManager"),r=e("./DataManager"),c=e("./audio/AudioManager"),l=e("./LoaderCSS"),h=e("../localization/LocalizationManager"),u=e("./ResizeScreenManager"),p=cc._decorator.ccclass,d=function(e){function t(){var t=e.call(this)||this;return t.localizationManager=null,t.resizeScreenManager=null,t.attackKey="z",t.specialKey="x",t.dataManager=new r.default,t.audioManager=new c.default,t.rotateScreen=new s.default,t.resizeScreenManager=new u.default,t.loaderCSS=new l.default,i.instance=t,cc.game.addPersistRootNode(t),a.default.initialize(),t.checkAudioState(),t}var i;return n(t,e),i=t,t.prototype.initLocalizationManager=function(e,t){void 0===t&&(t=[]),this.localizationManager=new h.default(e,t)},t.prototype.checkAudioState=function(){this.audioManager.enableAudio&&!this.dataManager.getSounds()&&this.audioManager.disableAll()},t.prototype.switchAudioState=function(){this.audioManager.enableAudio?this.audioManager.disableAll():this.audioManager.enableAll(),this.dataManager.setSounds(this.audioManager.enableAudio)},t.prototype.getLocalizationString=function(e,t){return void 0===t&&(t=[]),this.localizationManager?this.localizationManager.getString(e,t):e},t.prototype.getLocalizationFont=function(e){return void 0===e&&(e=null),this.localizationManager?this.localizationManager.isFontSupported(e)?e:this.localizationManager.localeFont:e},t.prototype.onLoad=function(){},t.getInstance=function(){return this.instance||(this.instance=new i),this.instance},t.instance=null,t.CHEAT_ENABLED=!1,t=i=o([p],t)}(cc.Node);i.default=d,cc._RF.pop()},{"../localization/LocalizationManager":"LocalizationManager","./DataManager":"DataManager","./FocusHandler":"FocusHandler","./LoaderCSS":"LoaderCSS","./ResizeScreenManager":"ResizeScreenManager","./RotateScreenManager":"RotateScreenManager","./audio/AudioManager":"AudioManager"}],SpecialCollectable:[function(e,t,i){"use strict";cc._RF.push(t,"8d25awEJ9NAaLQboM/B6Cs1","SpecialCollectable");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./Placeholder"),s=e("./Game"),r=e("./UpgradesManager"),c=e("../core/DataManager"),l=e("../core/Singleton"),h=e("../core/audio/AudioScene"),u=e("./PausableComponent"),p=cc._decorator,d=p.ccclass,f=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.order=a.ActorOrderType.FIRST,t.spriteNode=null,t.mainAnimation=null,t.shineAnimation=null,t.collider=null,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){var n=this;i.tag==s.ColliderTag.PLAYER_BODY&&(this.mainAnimation.getAnimationState("PLAY_snarf").wrapMode=cc.WrapMode.Normal,this.mainAnimation.on("finished",function(e){console.info("on finished animation");var t=r.default.instance.getLastPlayedLevelCollectables(),i=l.default.getInstance().dataManager.getLocalKey(c.LocalDataKey.snarfFounds);t&&n.order==a.ActorOrderType.FIRST&&(t.foundFirst=!0,i[0]=!0),t&&n.order==a.ActorOrderType.SECOND&&(t.foundSecond=!0,i[1]=!0),t&&n.order==a.ActorOrderType.THIRD&&(t.foundThird=!0,i[2]=!0),-1===i.indexOf(!1)?l.default.getInstance().audioManager.playSfx(h.SFXKey.item_snarf3):l.default.getInstance().audioManager.playSfx(h.SFXKey.item_snarf2),s.default.instance.updateUI(),l.default.getInstance().dataManager.setLocalKey(c.LocalDataKey.snarfFounds,i),r.default.instance.saveCollectables();s.default.instance.gameplayUI.getSnarfFoundNode(n.order);n.node.destroy()},this),l.default.getInstance().audioManager.playSfx(h.SFXKey.item_snarf1),this.mainAnimation.play("PLAY_snarf"),this.collider.enabled=!1)},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.mainAnimation.pause(),this.shineAnimation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.mainAnimation.resume(),this.shineAnimation.resume()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.spriteNode=this.node.getChildByName("pivot"),this.mainAnimation=this.node.getComponent(cc.Animation),this.shineAnimation=this.spriteNode.getChildByName("shine").getComponent(cc.Animation),this.collider=this.node.getComponent(cc.PhysicsBoxCollider)},t.prototype.start=function(){},t=o([d],t)}(u.default));i.default=f,cc._RF.pop()},{"../core/DataManager":"DataManager","../core/Singleton":"Singleton","../core/audio/AudioScene":"AudioScene","./Game":"Game","./PausableComponent":"PausableComponent","./Placeholder":"Placeholder","./UpgradesManager":"UpgradesManager"}],Spikes:[function(e,t,i){"use strict";cc._RF.push(t,"044edik+V1H9JUFTwxLr/te","Spikes");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("./DoesDamage"),s=e("./Config"),r=cc._decorator,c=r.ccclass,l=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.start=function(){this.getComponent(a.default).touchDamage=s.SpikesConfig.touchDamage},t=o([c],t)}(cc.Component));i.default=l,cc._RF.pop()},{"./Config":"Config","./DoesDamage":"DoesDamage"}],StageController:[function(e,t,i){"use strict";cc._RF.push(t,"fcc1c2SedRNL6L7BfzyLmlu","StageController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./CameraController"),r=e("./PlayerController"),c=e("../../core/Singleton"),l=e("../PausableComponent"),h=e("../../Testing/TesterLevelData"),u=cc._decorator,p=u.ccclass,d=u.property;(function(e){e[e.e_shapeBit=1]="e_shapeBit",e[e.e_jointBit=2]="e_jointBit",e[e.e_aabbBit=4]="e_aabbBit",e[e.e_pairBit=8]="e_pairBit",e[e.e_centerOfMassBit=16]="e_centerOfMassBit",e[e.e_controllerBit=32]="e_controllerBit"})(a||(a={}));var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cameraController=null,t.player=null,t.gravity=cc.v2(0,0),t.debugFlags=0,t.enablePhysicsOnLoad=!1,t.debugHealth=!1,t}var i;return n(t,e),i=t,Object.defineProperty(t,"isGamePaused",{get:function(){return this.paused},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugDrawShape",{get:function(){return(this.debugFlags&a.e_shapeBit)>0},set:function(e){var t=e?1:0;this.debugFlags^=(-t^this.debugFlags)&a.e_shapeBit},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugDrawJoint",{get:function(){return(this.debugFlags&a.e_jointBit)>0},set:function(e){var t=e?1:0;this.debugFlags^=(-t^this.debugFlags)&a.e_jointBit},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugDrawAABB",{get:function(){return(this.debugFlags&a.e_aabbBit)>0},set:function(e){var t=e?1:0;this.debugFlags^=(-t^this.debugFlags)&a.e_aabbBit},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugDrawPair",{get:function(){return(this.debugFlags&a.e_pairBit)>0},set:function(e){var t=e?1:0;this.debugFlags^=(-t^this.debugFlags)&a.e_pairBit},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugDrawCenterOfMass",{get:function(){return(this.debugFlags&a.e_centerOfMassBit)>0},set:function(e){var t=e?1:0;this.debugFlags^=(-t^this.debugFlags)&a.e_centerOfMassBit},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugDrawController",{get:function(){return(this.debugFlags&a.e_controllerBit)>0},set:function(e){var t=e?1:0;this.debugFlags^=(-t^this.debugFlags)&a.e_controllerBit},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){if(e.prototype.onLoad.call(this),c.default.getInstance(),this.enablePhysicsOnLoad){var t=cc.director.getPhysicsManager();t.enabled=!0,t.gravity=this.gravity,t.debugDrawFlags=this.debugFlags;var n=cc.game.getFrameRate();t.enabledAccumulator=!0,cc.PhysicsManager.MAX_ACCUMULATOR=1/n*6,cc.PhysicsManager.FIXED_TIME_STEP=1/n,cc.PhysicsManager.VELOCITY_ITERATIONS=8,cc.PhysicsManager.POSITION_ITERATIONS=8}i.paused=!1},t.prototype.start=function(){},t.prototype.onPause=function(){e.prototype.onPause.call(this),cc.director.getPhysicsManager().enabled=!1,i.paused=!0,h.default.instances.pauseTimer()},t.prototype.onResume=function(){(e.prototype.onResume.call(this),this.enablePhysicsOnLoad)&&(cc.director.getPhysicsManager().enabled=!0);i.paused=!1,h.default.instances.resumeTimer()},t.paused=!1,o([d(s.default)],t.prototype,"cameraController",void 0),o([d(r.default)],t.prototype,"player",void 0),o([d(cc.Vec2)],t.prototype,"gravity",void 0),o([d({visible:!0})],t.prototype,"debugFlags",void 0),o([d],t.prototype,"enablePhysicsOnLoad",void 0),o([d],t.prototype,"debugDrawShape",null),o([d],t.prototype,"debugDrawJoint",null),o([d],t.prototype,"debugDrawAABB",null),o([d],t.prototype,"debugDrawPair",null),o([d],t.prototype,"debugDrawCenterOfMass",null),o([d],t.prototype,"debugDrawController",null),o([d({tooltip:"press 1 to take damage, and 2 to increase health"})],t.prototype,"debugHealth",void 0),t=i=o([p],t)}(l.default);i.default=f,cc._RF.pop()},{"../../Testing/TesterLevelData":"TesterLevelData","../../core/Singleton":"Singleton","../PausableComponent":"PausableComponent","./CameraController":"CameraController","./PlayerController":"PlayerController"}],StaticAgressiveEnemy:[function(e,t,i){"use strict";cc._RF.push(t,"98cb5giTmNIv6rUqI9CgPtM","StaticAgressiveEnemy");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./Game"),r=e("./DoesDamage"),c=e("../core/Utils"),l=e("./Config"),h=e("./Placeholder"),u=e("../core/Singleton"),p=e("../core/audio/AudioScene"),d=e("./PausableComponent"),f=cc._decorator,m=f.ccclass,g=f.property;(function(e){e[e.IDLE=0]="IDLE",e[e.CHARGE=1]="CHARGE",e[e.ATTACK=2]="ATTACK",e[e.COOLDOWN=3]="COOLDOWN"})(a||(a={}));var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colorType=h.ActorColorType.GREEN,t.facingDirection=c.Direction.LEFT,t.bodySprites=[],t.health=100,t.attackAreaSize=cc.size(220,220),t.attackBuildTime=3,t.attackDamageTime=.1,t.attackCooldownTime=.5,t.sensingContacts=0,t.attackBuildTimeLeft=0,t.attackDamageTimeLeft=0,t.attackCooldownTimeLeft=0,t.state=a.IDLE,t.prevState=-1,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){if(t.tag==s.ColliderTag.ENEMY_BODY&&i.tag==s.ColliderTag.PLAYER_ATTACK_AREA){var n=i.getComponent(r.default);this.health-=n.attackDamage,console.info("sprites found: "+this.bodySprites.length);for(var o=function(e){e.setMaterial(0,s.default.instance.spriteOverlayColorMaterial),e.scheduleOnce(function(){return e.setMaterial(0,s.default.instance.builtinSpriteMaterial)},l.CommonEnemiesConfig.damageWhiteFlashTime)},a=0,c=this.bodySprites;a<c.length;a++){o(c[a])}this.health<=0?(u.default.getInstance().audioManager.stopSfx(this.lastIDSfx),this.node.destroy(),s.default.instance.spawnPuff(this.node.position.add(cc.v2(0,-25)),s.default.actorColorToEnemyPuffType(this.colorType)),s.default.instance.shakeCamera(s.CameraShakeLevel.MEDIUM),s.default.instance.spawnCollectables(this.node.position,this.cookiesSpawnCount),u.default.getInstance().audioManager.playSfxKillEnemy()):(u.default.getInstance().audioManager.playSfxHitEnemy(),s.default.instance.shakeCamera(s.CameraShakeLevel.LOW))}t.tag==s.ColliderTag.ENEMY_DETECTION_AREA&&i.tag==s.ColliderTag.PLAYER_BODY&&(++this.sensingContacts,this.sensingContacts>0&&console.info("static enemy started sensing you!"))},t.prototype.onEndContact=function(e,t,i){t.tag==s.ColliderTag.ENEMY_DETECTION_AREA&&i.tag==s.ColliderTag.PLAYER_BODY&&(--this.sensingContacts,0==this.sensingContacts&&console.info("static enemy stopped sensing you!"))},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.bodyAnimation.pause(),this.headAnimation.pause(),this.attackAnimation.pause(),this.wave1Animation.pause(),this.wave2Animation.pause(),this.wave3Animation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.bodyAnimation.resume(),this.headAnimation.resume(),this.attackAnimation.resume(),this.wave1Animation.resume(),this.wave2Animation.resume(),this.wave3Animation.resume()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.colorType==h.ActorColorType.GREEN?this.bodyAnimationNode=this.node.getChildByName("lizard_green"):this.bodyAnimationNode=this.node.getChildByName("lizard_pink"),this.attackAnimationNode=cc.find("base/node_charge",this.bodyAnimationNode),this.colorType==h.ActorColorType.GREEN?this.headAnimationNode=cc.find("base/node_lizard/lizard_green_body/lizard_green_head",this.bodyAnimationNode):this.headAnimationNode=cc.find("base/node_lizard/lizard_pink_body/lizard_pink_head",this.bodyAnimationNode),this.bodyAnimation=this.bodyAnimationNode.getComponent(cc.Animation),this.headAnimation=this.headAnimationNode.getComponent(cc.Animation),this.attackAnimation=this.attackAnimationNode.getComponent(cc.Animation),this.wave1Animation=this.attackAnimationNode.getChildByName("wave01").getComponent(cc.Animation),this.wave2Animation=this.attackAnimationNode.getChildByName("wave02").getComponent(cc.Animation),this.wave3Animation=this.attackAnimationNode.getChildByName("wave03").getComponent(cc.Animation),this.spriteNode=this.bodyAnimationNode.getChildByName("base"),this.bodySprites=c.getAllSubChildrenSprites(cc.find("base/node_lizard",this.bodyAnimationNode))},t.prototype.start=function(){var e;this.colorType==h.ActorColorType.GREEN?(this.health=l.GreenStaticAgressiveEnemyConfig.health,this.attackAreaSize=cc.size(l.GreenStaticAgressiveEnemyConfig.attackAreaRadius,l.GreenStaticAgressiveEnemyConfig.attackAreaRadius),this.attackBuildTime=l.GreenStaticAgressiveEnemyConfig.attackBuildTime,this.attackDamageTime=l.GreenStaticAgressiveEnemyConfig.attackDamageTime,this.attackCooldownTime=l.GreenStaticAgressiveEnemyConfig.attackCooldownTime,this.cookiesSpawnCount=l.GreenStaticAgressiveEnemyConfig.cookiesSpawnCount,(e=this.getComponent(r.default)).touchDamage=l.GreenStaticAgressiveEnemyConfig.touchDamage,e.attackDamage=l.GreenStaticAgressiveEnemyConfig.attackDamage):(this.health=l.PinkStaticAgressiveEnemyConfig.health,this.attackAreaSize=cc.size(l.PinkStaticAgressiveEnemyConfig.attackAreaRadius,l.PinkStaticAgressiveEnemyConfig.attackAreaRadius),this.attackBuildTime=l.PinkStaticAgressiveEnemyConfig.attackBuildTime,this.attackDamageTime=l.PinkStaticAgressiveEnemyConfig.attackDamageTime,this.attackCooldownTime=l.PinkStaticAgressiveEnemyConfig.attackCooldownTime,this.cookiesSpawnCount=l.PinkStaticAgressiveEnemyConfig.cookiesSpawnCount,(e=this.getComponent(r.default)).touchDamage=l.PinkStaticAgressiveEnemyConfig.touchDamage,e.attackDamage=l.PinkStaticAgressiveEnemyConfig.attackDamage);var t=this.bodyAnimation.getAnimationState("cooldown").clip.duration;this.attackCooldownTime=t,this.facingDirection==c.Direction.LEFT?this.spriteNode.scaleX=Math.abs(this.spriteNode.scaleX):(this.facingDirection=c.Direction.RIGHT,this.spriteNode.scaleX=-Math.abs(this.spriteNode.scaleX))},t.prototype.update=function(e){this.state;this.attackCooldownTimeLeft>0&&(this.attackCooldownTimeLeft-=e,this.attackCooldownTimeLeft<=0&&(this.attackCooldownTimeLeft=0)),this.attackDamageTimeLeft>0&&(this.attackDamageTimeLeft-=e,this.attackDamageTimeLeft<=0&&(this.attackDamageTimeLeft=0,this.attackCooldownTimeLeft=this.attackCooldownTime)),this.attackBuildTimeLeft>0&&(this.attackBuildTimeLeft-=e,this.attackBuildTimeLeft<=0&&(this.attackBuildTimeLeft=0,s.default.instance.spawnCircleAttackArea(this.node.position.add(cc.v2(-20,-20)),this.attackAreaSize.width,c.Direction.NONE,this.getComponent(r.default).attackDamage,this.attackDamageTime,s.ColliderTag.ENEMY_ATTACK_AREA),this.attackDamageTimeLeft=this.attackDamageTime)),this.sensingContacts>0&&0==this.attackBuildTimeLeft&&0==this.attackDamageTimeLeft&&0==this.attackCooldownTimeLeft&&(this.attackBuildTimeLeft=this.attackBuildTime),this.state=a.IDLE,this.attackBuildTimeLeft>0?this.state=a.CHARGE:this.attackDamageTimeLeft>0?this.state=a.ATTACK:this.attackCooldownTimeLeft>0&&(this.state=a.COOLDOWN),this.state!=this.prevState&&(this.state==a.IDLE?(this.bodyAnimation.play("idle"),this.headAnimation.play("blink"),this.attackAnimationNode.active=!1):this.state==a.CHARGE?(this.lastIDSfx=u.default.getInstance().audioManager.playSfx(p.SFXKey.enemy_lizard),this.bodyAnimation.play("charge"),this.headAnimation.stop(),this.attackAnimationNode.active=!0,this.attackAnimation.play("wave_charge01"),this.wave1Animation.play("wave_decrease01"),this.wave2Animation.play("wave_decrease02"),this.wave3Animation.play("wave_decrease03")):this.state==a.ATTACK?(this.bodyAnimation.play("attack"),this.headAnimation.stop(),this.attackAnimationNode.active=!0,this.attackAnimation.play("wave_attack"),this.wave1Animation.play("wave_expand01"),this.wave2Animation.play("wave_expand02"),this.wave3Animation.play("wave_expand03")):this.state==a.COOLDOWN&&(this.bodyAnimation.play("cooldown"),this.headAnimation.stop(),this.attackAnimationNode.active=!1)),this.prevState=this.state},o([g({type:cc.Enum(h.ActorColorType)})],t.prototype,"colorType",void 0),t=o([m],t)}(d.default);i.default=y,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Config":"Config","./DoesDamage":"DoesDamage","./Game":"Game","./PausableComponent":"PausableComponent","./Placeholder":"Placeholder"}],StaticMortarEnemy:[function(e,t,i){"use strict";cc._RF.push(t,"01174dg8QZAcr6ZbbWj67E8","StaticMortarEnemy");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./DoesDamage"),r=e("./Config"),c=e("../core/Utils"),l=e("./Placeholder"),h=e("./Game"),u=e("./Projectile"),p=e("../core/Singleton"),d=e("../core/audio/AudioScene"),f=e("./PausableComponent"),m=cc._decorator,g=m.ccclass,y=m.property;(function(e){e[e.IDLE=0]="IDLE",e[e.ATTACKING=1]="ATTACKING",e[e.STUNNED=2]="STUNNED"})(a||(a={}));var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colorType=l.ActorColorType.GREEN,t.bodySprites=[],t.facingDirection=c.Direction.LEFT,t.cookiesSpawnCount=0,t.prevState=null,t.state=a.IDLE,t.stunnedTimeLeft=0,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){if(t.tag==h.ColliderTag.ENEMY_BODY&&i.tag==h.ColliderTag.PLAYER_ATTACK_AREA){var n=i.getComponent(s.default);this.health-=n.attackDamage;for(var o=function(e){e.setMaterial(0,h.default.instance.spriteOverlayColorMaterial),e.scheduleOnce(function(){return e.setMaterial(0,h.default.instance.builtinSpriteMaterial)},r.CommonEnemiesConfig.damageWhiteFlashTime),c.state!=a.STUNNED&&(c.stunnedTimeLeft=.32)},c=this,l=0,u=this.bodySprites;l<u.length;l++){o(u[l])}this.health<=0?(this.node.destroy(),h.default.instance.spawnPuff(this.node.position.add(cc.v2(0,-25)),h.default.actorColorToEnemyPuffType(this.colorType)),h.default.instance.shakeCamera(h.CameraShakeLevel.MEDIUM),h.default.instance.spawnCollectables(this.node.position,this.cookiesSpawnCount),p.default.getInstance().audioManager.playSfxKillEnemy()):(p.default.getInstance().audioManager.playSfxHitEnemy(),h.default.instance.shakeCamera(h.CameraShakeLevel.LOW))}},t.prototype.shoot=function(){var e=this;this.state=a.ATTACKING;var t=cc.v2(this.node.position.x,this.node.position.y+25);this.scheduleOnce(function(){return h.default.instance.spawnProjectile(t,e.projectileSpeed,e.projectileAngle,e.projectileGravityScale,e.projectileDamage,e.projectileType)},.4)},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.animation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.animation.resume()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.body=this.getComponent(cc.RigidBody),this.spriteNode=this.node.getChildByName("sprite"),this.animation=this.spriteNode.getComponent(cc.Animation),this.doesDamage=this.getComponent(s.default),this.bodySprites=c.getAllSubChildrenSprites(this.spriteNode)},t.prototype.start=function(){this.colorType==l.ActorColorType.GREEN?(this.projectileType=u.ProjectileType.GREEN_MORTAR,this.projectileSpeed=r.GreenStaticMortarEnemyConfig.projectileSpeed*h.default.TILE_SIZE.width,this.facingDirection==c.Direction.LEFT?this.projectileAngle=Math.PI-cc.misc.degreesToRadians(r.GreenStaticMortarEnemyConfig.projectileAngle):this.projectileAngle=cc.misc.degreesToRadians(r.GreenStaticMortarEnemyConfig.projectileAngle),this.projectileGravityScale=r.GreenStaticMortarEnemyConfig.projectileGravityScale,this.projectileDamage=r.GreenStaticMortarEnemyConfig.attackDamage,this.cooldownTime=r.GreenStaticMortarEnemyConfig.attackCooldownTime,this.cookiesSpawnCount=r.GreenStaticMortarEnemyConfig.cookiesSpawnCount,this.health=r.GreenStaticMortarEnemyConfig.health,this.doesDamage.touchDamage=r.GreenStaticMortarEnemyConfig.touchDamage):(this.projectileType=u.ProjectileType.PINK_MORTAR,this.projectileSpeed=r.PinkStaticMortarEnemyConfig.projectileSpeed*h.default.TILE_SIZE.width,this.facingDirection==c.Direction.LEFT?this.projectileAngle=Math.PI-cc.misc.degreesToRadians(r.PinkStaticMortarEnemyConfig.projectileAngle):this.projectileAngle=cc.misc.degreesToRadians(r.PinkStaticMortarEnemyConfig.projectileAngle),this.projectileGravityScale=r.PinkStaticMortarEnemyConfig.projectileGravityScale,this.projectileDamage=r.PinkStaticMortarEnemyConfig.attackDamage,this.cooldownTime=r.PinkStaticMortarEnemyConfig.attackCooldownTime,this.cookiesSpawnCount=r.PinkStaticMortarEnemyConfig.cookiesSpawnCount,this.health=r.PinkStaticMortarEnemyConfig.health,this.doesDamage.touchDamage=r.PinkStaticMortarEnemyConfig.touchDamage),this.facingDirection==c.Direction.LEFT?this.spriteNode.scaleX=1:this.spriteNode.scaleX=-1,this.schedule(this.shoot,this.cooldownTime)},t.prototype.update=function(e){var t=this;this.stunnedTimeLeft>0&&(this.state=a.STUNNED,this.stunnedTimeLeft-=e,this.stunnedTimeLeft<=0&&(this.stunnedTimeLeft=0,this.state=a.IDLE)),this.state!=this.prevState&&(this.state==a.IDLE&&this.animation.play("idle"),this.state==a.ATTACKING&&(this.animation.on("finished",function(){t.animation.off("finished"),t.state=a.IDLE},this),this.playSfxShoot(),this.animation.play("attack")),this.state==a.STUNNED&&this.animation.play("hit")),this.prevState=this.state},t.prototype.playSfxShoot=function(){var e=1.1*this.node.width,t=1.1*this.node.height,i=this.node.x-e/2,n=this.node.y-t/2,o=cc.rect(i,n,e,t);p.default.getInstance().audioManager.playSfxRegion(d.SFXKey.enemy_mortar1,o)},o([y({type:cc.Enum(l.ActorColorType)})],t.prototype,"colorType",void 0),t=o([g],t)}(f.default);i.default=v,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Config":"Config","./DoesDamage":"DoesDamage","./Game":"Game","./PausableComponent":"PausableComponent","./Placeholder":"Placeholder","./Projectile":"Projectile"}],StaticPassiveEnemy:[function(e,t,i){"use strict";cc._RF.push(t,"23404HRkXNOiaJQtfe+29wb","StaticPassiveEnemy");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./DoesDamage"),r=e("./Config"),c=e("./Game"),l=e("../core/Utils"),h=e("./Placeholder"),u=e("../core/Singleton"),p=e("./PausableComponent"),d=cc._decorator,f=d.ccclass,m=d.property;(function(e){e[e.IDLE=0]="IDLE",e[e.STUNNED=1]="STUNNED"})(a||(a={}));var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colorType=h.ActorColorType.GREEN,t.facingDirection=l.Direction.LEFT,t.characterNode=null,t.bodyAnimation=null,t.headAnimation=null,t.bodySprites=[],t.health=100,t.cookiesSpawnCount=0,t.stunnedTimeLeft=0,t.state=a.IDLE,t.prevState=null,t}return n(t,e),t.prototype.onBeginContact=function(e,t,i){if(t.tag==c.ColliderTag.ENEMY_BODY&&i.tag==c.ColliderTag.PLAYER_ATTACK_AREA){var n=i.getComponent(s.default);this.health-=n.attackDamage;for(var o=function(e){e.setMaterial(0,c.default.instance.spriteOverlayColorMaterial),e.scheduleOnce(function(){return e.setMaterial(0,c.default.instance.builtinSpriteMaterial)},r.CommonEnemiesConfig.damageWhiteFlashTime),a.stunnedTimeLeft=.3},a=this,l=0,h=this.bodySprites;l<h.length;l++){o(h[l])}this.health<=0?(this.node.destroy(),c.default.instance.spawnPuff(this.node.position.add(cc.v2(0,-25)),c.default.actorColorToEnemyPuffType(this.colorType)),c.default.instance.shakeCamera(c.CameraShakeLevel.MEDIUM),c.default.instance.spawnCollectables(this.node.position,this.cookiesSpawnCount),u.default.getInstance().audioManager.playSfxKillEnemy()):(u.default.getInstance().audioManager.playSfxHitEnemy(),c.default.instance.shakeCamera(c.CameraShakeLevel.LOW))}},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.bodyAnimation.pause(),this.headAnimation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.bodyAnimation.resume(),this.headAnimation.resume()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.colorType==h.ActorColorType.GREEN?this.characterNode=this.node.getChildByName("slime_green"):this.characterNode=this.node.getChildByName("slime_pink"),this.bodyAnimation=this.characterNode.getComponent(cc.Animation),this.colorType==h.ActorColorType.GREEN?this.headAnimation=cc.find("base/slime_green_body01/slime_green_face",this.characterNode).getComponent(cc.Animation):this.headAnimation=cc.find("base/slime_pink_body01/slime_pink_face",this.characterNode).getComponent(cc.Animation),this.bodySprites=l.getAllSubChildrenSprites(this.characterNode)},t.prototype.start=function(){this.colorType==h.ActorColorType.GREEN?(this.health=r.GreenStaticPassiveEnemyConfig.health,this.getComponent(s.default).touchDamage=r.GreenStaticPassiveEnemyConfig.touchDamage,this.cookiesSpawnCount=r.GreenStaticPassiveEnemyConfig.cookiesSpawnCount):(this.health=r.PinkStaticPassiveEnemyConfig.health,this.getComponent(s.default).touchDamage=r.PinkStaticPassiveEnemyConfig.touchDamage,this.cookiesSpawnCount=r.PinkStaticPassiveEnemyConfig.cookiesSpawnCount);this.facingDirection==l.Direction.LEFT?this.characterNode.scaleX=1:(this.facingDirection=l.Direction.RIGHT,this.characterNode.scaleX=-1),this.state=a.IDLE},t.prototype.update=function(e){this.stunnedTimeLeft>0&&(this.stunnedTimeLeft-=e,this.stunnedTimeLeft<0&&(this.stunnedTimeLeft=0)),this.stunnedTimeLeft>0?this.state=a.STUNNED:this.state=a.IDLE,this.state!=this.prevState&&(this.state==a.IDLE&&this.bodyAnimation.play("walk"),this.state==a.STUNNED&&this.bodyAnimation.play("hit")),this.prevState=this.state},o([m({type:cc.Enum(h.ActorColorType)})],t.prototype,"colorType",void 0),t=o([f],t)}(p.default);i.default=g,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","./Config":"Config","./DoesDamage":"DoesDamage","./Game":"Game","./PausableComponent":"PausableComponent","./Placeholder":"Placeholder"}],TakesDamage:[function(e,t,i){"use strict";cc._RF.push(t,"7deb3ZYbY1Ny56WuUaIqOpq","TakesDamage");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,r=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isPlayer=!1,t.health=100,t}return n(t,e),o([r],t.prototype,"isPlayer",void 0),o([r],t.prototype,"health",void 0),t=o([s],t)}(cc.Component);i.default=c,cc._RF.pop()},{}],TaskRunner:[function(e,t,i){"use strict";cc._RF.push(t,"1f4d6k3v9dH4px5KwTai9aS","TaskRunner");var n=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var o,a=cc._decorator,s=a.ccclass;a.property;(function(e){e[e.CALL=0]="CALL",e[e.TWEEN=1]="TWEEN"})(o||(o={}));var r=function(){return function(){}}(),c=function(){function e(){this.sequenceTasks=[],this.parallelTasks=[],this.paused=!1}return e.prototype.sequenceCall=function(e,t){var i=new r;i.type=o.CALL,i.totalTime=e,i.timeLeft=e,i.callback=t,this.sequenceTasks.push(i)},e.prototype.sequenceTween=function(e,t){var i=new r;i.type=o.TWEEN,i.totalTime=e,i.timeLeft=e,i.callback=t,this.sequenceTasks.push(i)},e.prototype.parallelCall=function(e,t){var i=new r;i.type=o.CALL,i.totalTime=e,i.timeLeft=e,i.callback=t,this.parallelTasks.push(i)},e.prototype.parallelTween=function(e,t){var i=new r;i.type=o.TWEEN,i.totalTime=e,i.timeLeft=e,i.callback=t,this.parallelTasks.push(i)},e.prototype.clear=function(){this.sequenceTasks=[],this.parallelTasks=[]},e.prototype.pause=function(){this.paused=!0},e.prototype.resume=function(){this.paused=!1},e.prototype.update=function(e){if(!this.paused){for(;this.sequenceTasks.length>0;){var t=this.sequenceTasks[0];if(!this.updateTask(t,e))break;this.sequenceTasks.shift()}if(this.parallelTasks.length>0){for(var i=0,n=this.parallelTasks;i<n.length;i++){t=n[i];this.updateTask(t,e)}this.parallelTasks=this.parallelTasks.filter(function(e){return 0!=e.timeLeft})}}},e.prototype.updateTask=function(e,t){if(e.timeLeft-=t,e.type==o.CALL){if(e.timeLeft<=0)return e.timeLeft=0,e.callback(),!0}else if(e.type==o.TWEEN){e.timeLeft<=0&&(e.timeLeft=0);var i=1-e.timeLeft/e.totalTime;if(e.callback(i),0==e.timeLeft)return!0}return!1},e=n([s],e)}();i.default=c,cc._RF.pop()},{}],TesterLevelData:[function(e,t,i){"use strict";cc._RF.push(t,"463beiXdd1APpCHwpcatgXr","TesterLevelData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../game/Placeholder"),o=e("../game/Config"),a=e("../game/Game"),s=!1,r=function(){function e(){this.idContainer="testLevelDiv",console.log("init TesterLevelData"),s&&(this.initGame=!1,this.addCSS(),this.addDiv())}return e.prototype.addCSS=function(){var e=document.createElement("style");e.innerHTML="#"+this.idContainer+" {\n            margin: 0 auto;\n            position: fixed;\n            top: 150px;\n            left: 0;\n            width: 220px;\n            height: 100px;\n            opacity: 0.8;\n            background: rgb(0, 0, 0);\n            z-index: 999;\n            font-weight: bold;\n            font-size: 20px;\n        }\n        \n        button {\n            margin: 0 auto;\n            position: fixed;\n            top: 120px;\n            line-height: 30px;\n            font-weight: bold;\n            font-size: 14px;\n            padding: 0 40px;\n            background: rgb(200, 10, 10);\n            opacity: 1;\n            border: none;\n        }\n        ",document.head.appendChild(e)},e.prototype.addDiv=function(){this.buttonExport=document.createElement("button"),this.buttonExport.innerHTML="JSON",this.buttonExport.addEventListener("click",this.exportJSON.bind(this)),this.div=document.createElement("Div"),this.div.id=this.idContainer,this.div.innerHTML=" Time: 00:00:00 <br> Cookies: 000 ",document.body.appendChild(this.div),document.body.appendChild(this.buttonExport)},Object.defineProperty(e,"instances",{get:function(){return e._instances||(e._instances=new e),e._instances},enumerable:!0,configurable:!0}),e.prototype.exportJSON=function(){if(s){var e,t={};this.dataLevel={cookies:0,totalTime:this.setTimeFormat(this.totalTime)},this.dataSections={};for(var i=0,n=this.sectionsKeys.length;i<n;i++)e=this.sectionsKeys[i],this.dataSections[e]={cookies:this.cookiesSection[e],totalTime:this.setTimeFormat(this.sectionTotalTime[e])},this.dataLevel.cookies+=this.cookiesSection[e];t.TotalGameTime=this.setTimeFormat(this.totalGameTime),t[this.sectionsKeys[0]]=this.dataLevel,t.sections=this.dataSections,this.downloadObjectAsJson(t,this.sectionsKeys[0])}},e.prototype.downloadObjectAsJson=function(e,t){var i="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,4)),n=document.createElement("a");n.setAttribute("href",i),n.setAttribute("download",t+".json"),document.body.appendChild(n),n.click(),n.remove()},e.prototype.pauseTimer=function(){s&&this.isRunning&&(clearInterval(this.interval),this.isRunning=!1)},e.prototype.resumeTimer=function(){if(s&&!this.isRunning){var e,t,i,n=new Date;e=(n=n.getTime())-this.totalTime,t=n-this.sectionTime,i=n-this.totalGameTime,this.initTime.setTime(e),this.initTimeSection.setTime(t),this.initTimeGame.setTime(i),this.interval=setInterval(this.updateClock.bind(this),10),this.isRunning=!0}},e.prototype.initTimerSection=function(e){void 0===e&&(e=!1),s&&(this.initGame||(this.initGame=!0,this.initTimeGame=new Date),this.currentSection=cc.director.getScene().name,this.cookie=0,e?(this.sectionTotalTime=[],this.cookiesSection=[],this.sectionsKeys=[],this.totalTime=0,this.initTime=new Date,this.interval=setInterval(this.updateClock.bind(this),100),this.isRunning=!0):this.resumeTimer(),this.initTimeSection=new Date,this.sectionTime=0)},e.prototype.endTimerSection=function(){s&&(this.sectionTotalTime[this.currentSection]||(this.sectionsKeys.push(this.currentSection),this.sectionTotalTime[this.currentSection]=0,this.cookiesSection[this.currentSection]=this.cookie),this.sectionTotalTime[this.currentSection]+=this.sectionTime,this.pauseTimer())},e.prototype.endTimerLevel=function(){s&&(this.sectionTotalTime[this.currentSection]||(this.sectionsKeys.push(this.currentSection),this.sectionTotalTime[this.currentSection]=0,this.cookiesSection[this.currentSection]=this.cookie),this.sectionTotalTime[this.currentSection]+=this.sectionTime,clearInterval(this.interval),this.isRunning=!1,a.default._firstStart=!0)},e.prototype.addSpawnCookie=function(e,t,i){if(s){var a=0;switch(e){case n.ActorClassType.CRATE:t==n.ActorSizeType.SMALL?a=o.SmallCrateConfig.cookiesSpawnCount:t==n.ActorSizeType.MEDIUM?a=o.MediumCrateConfig.cookiesSpawnCount:t==n.ActorSizeType.BIG&&(a=o.BigCrateConfig.cookiesSpawnCount);break;case n.ActorClassType.STATIC_PASSIVE_ENEMY:i==n.ActorColorType.GREEN?a=o.GreenStaticPassiveEnemyConfig.cookiesSpawnCount:i==n.ActorColorType.PINK&&(a=o.PinkStaticPassiveEnemyConfig.cookiesSpawnCount);break;case n.ActorClassType.STATIC_AGRESSIVE_ENEMY:i==n.ActorColorType.GREEN?a=o.GreenStaticAgressiveEnemyConfig.cookiesSpawnCount:i==n.ActorColorType.PINK&&(a=o.PinkStaticAgressiveEnemyConfig.cookiesSpawnCount);break;case n.ActorClassType.STATIC_MORTAR_ENEMY:i==n.ActorColorType.GREEN?a=o.GreenStaticMortarEnemyConfig.cookiesSpawnCount:i==n.ActorColorType.PINK&&(a=o.PinkStaticMortarEnemyConfig.cookiesSpawnCount);break;case n.ActorClassType.PATROLLING_PASSIVE_ENEMY:i==n.ActorColorType.GREEN?a=o.GreenPatrollingPassiveEnemyConfig.cookiesSpawnCount:i==n.ActorColorType.PINK&&(a=o.PinkPatrollingPassiveEnemyConfig.cookiesSpawnCount);break;case n.ActorClassType.PATROLLING_JUMPER_ENEMY:i==n.ActorColorType.GREEN?a=o.GreenPatrollingJumperEnemyConfig.cookiesSpawnCount:i==n.ActorColorType.PINK&&(a=o.PinkPatrollingJumperEnemyConfig.cookiesSpawnCount);break;case n.ActorClassType.PATROLLING_AGRESSIVE_ENEMY:i==n.ActorColorType.GREEN?a=o.GreenPatrollingAgressiveEnemyConfig.cookiesSpawnCount:i==n.ActorColorType.PINK&&(a=o.PinkPatrollingAgressiveEnemyConfig.cookiesSpawnCount);break;case n.ActorClassType.FLYING_BOMBER_ENEMY:i==n.ActorColorType.GREEN?a=o.GreenFlyingBomberEnemyConfig.cookiesSpawnCount:i==n.ActorColorType.PINK&&(a=o.PinkFlyingBomberEnemyConfig.cookiesSpawnCount);break;case n.ActorClassType.FLYING_CHASER_ENEMY:i==n.ActorColorType.GREEN?a=o.GreenFlyingChaserEnemyConfig.cookiesSpawnCount:i==n.ActorColorType.PINK&&(a=o.PinkFlyingChaserEnemyConfig.cookiesSpawnCount)}this.cookie+=a,this.updateMessage()}},e.prototype.spawnObjects=function(e,t){},e.prototype.updateMessage=function(){if(s){var e=this.setTimeFormat(this.totalTime),t=this.setTimeFormat(this.sectionTime),i=this.setTimeFormat(this.totalGameTime);this.div.innerHTML="TimeG: "+i+" <br> TimeT: "+e+" <br> TimeS: "+t+" <br> Cookies: "+this.cookie+" "}},e.prototype.setTimeFormat=function(e){if(s){var t,i,n,o=new Date,a="";return o.setTime(e),n=Math.round(o.getMilliseconds()/10),i=o.getSeconds(),a+=(t=o.getMinutes())<10?"0"+t:t,a+=i<10?":0"+i:":"+i,a+=n<10?":0"+n:":"+n}},e.prototype.updateClock=function(){if(s){var e=new Date;this.totalTime=e-this.initTime,this.sectionTime=e-this.initTimeSection,this.totalGameTime=e-this.initTimeGame,this.updateMessage()}},e._instances=null,e}();i.default=r,cc._RF.pop()},{"../game/Config":"Config","../game/Game":"Game","../game/Placeholder":"Placeholder"}],TileMapBackgroundConfig:[function(e,t,i){"use strict";cc._RF.push(t,"9a198ipay9ED6gCh2kUSVq8","TileMapBackgroundConfig");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,r=a.property,c=a.menu;i.tileMapBackgroundFrames=[];var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.frames=[],t}return n(t,e),t.prototype.onLoad=function(){i.tileMapBackgroundFrames=this.frames,this.destroy()},o([r([cc.SpriteFrame])],t.prototype,"frames",void 0),t=o([s,c("Game Component/TileMapBackgroundConfig")],t)}(cc.Component);i.default=l,cc._RF.pop()},{}],TouchInputButton:[function(e,t,i){"use strict";cc._RF.push(t,"8dff8WrtXJK9aEYOal0f9gH","TouchInputButton");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,r=a.property,c=a.menu,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onPush=[],t.onRelease=[],t.lastHit=!1,t.lastEvent=null,t}return n(t,e),t.prototype.onTouchStart=function(e){for(var t=0,i=this.onPush;t<i.length;t++){i[t].emit([e])}this.lastHit=!0,this.lastEvent=e},t.prototype.onTouchEnd=function(e){for(var t=0,i=this.onRelease;t<i.length;t++){i[t].emit([e])}this.lastHit=!1,this.lastEvent=null},t.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},t.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.lastEvent&&this.onTouchEnd(this.lastEvent)},o([r([cc.Component.EventHandler])],t.prototype,"onPush",void 0),o([r([cc.Component.EventHandler])],t.prototype,"onRelease",void 0),t=o([s,c("Game Component/Input/TouchInputButton")],t)}(cc.Component);i.default=l,cc._RF.pop()},{}],TouchInputHoldButton:[function(e,t,i){"use strict";cc._RF.push(t,"63129vCTVVLC7TVVPaVkCgs","TouchInputHoldButton");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,r=a.property,c=a.menu,l=(a.requireComponent,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onHold=[],t.holdTime=1,t.elapsed=0,t.touchCount=0,t.pressCallback=function(){t.elapsed+=cc.director.getDeltaTime(),t.elapsed>t.holdTime&&t.doOnHold(null)},t}return n(t,e),t.prototype.doOnHold=function(e){for(var t=0,i=this.onHold;t<i.length;t++){i[t].emit([e])}},t.prototype.onPress=function(){0===this.touchCount&&(this.elapsed=0,this.schedule(this.pressCallback,0,cc.macro.REPEAT_FOREVER)),++this.touchCount},t.prototype.onRelease=function(){--this.touchCount,0===this.touchCount&&this.unschedule(this.pressCallback)},t.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onPress,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onRelease,this)},t.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onPress,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onRelease,this)},o([r([cc.Component.EventHandler])],t.prototype,"onHold",void 0),o([r],t.prototype,"holdTime",void 0),t=o([s,c("Game Component/Touch Input/TouchInputHoldButton")],t)}(cc.Component));i.default=l,cc._RF.pop()},{}],TransitionController:[function(e,t,i){"use strict";cc._RF.push(t,"a5626unN0RJKpCOXk1PAyOQ","TransitionController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../../Core/Singleton"),s=cc._decorator.ccclass,r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.instances=a.default.getInstance(),this.animation=this.getComponent(cc.Animation),this.node.children[0].active=!1,this.node.children[1].active=!1},t.prototype.showTransition=function(e){var t=this;this.node.active=!0,a.default.getInstance().audioManager.lockSfxPlayback=!0,this.node.children[0].active=!0,this.node.children[1].active=!0,this.animation.play("IN_transition"),this.animation.once("finished",function(){a.default.getInstance().audioManager.lockSfxPlayback=!1,t.instances.loaderCSS.show(),e&&e()})},t.prototype.hideTransition=function(e){var t=this;this.node.children[0].active=!0,this.node.children[1].active=!0,this.animation&&(this.animation.play("OUT_transition"),this.instances.loaderCSS.hide(),this.animation.once("finished",function(){e&&e(),t.node.children[0].active=!1,t.node.children[1].active=!1,t.node.active=!1}))},t.prototype.showLoader=function(){this.node.active=!1,this.instances.loaderCSS.show()},t.prototype.hideLoader=function(){this.node.active=!1,this.instances.loaderCSS.hide()},t=o([s],t)}(cc.Component);i.default=r,cc._RF.pop()},{"../../Core/Singleton":"Singleton"}],TrapPlatform:[function(e,t,i){"use strict";cc._RF.push(t,"540e5sO++5JEZq9U+4ydtcu","TrapPlatform");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./Config"),r=e("./Placeholder"),c=e("../core/Singleton"),l=e("../core/audio/AudioScene"),h=e("./PausableComponent"),u=cc._decorator,p=u.ccclass,d=u.property;(function(e){e[e.IDLE=0]="IDLE",e[e.ACTIVE=1]="ACTIVE",e[e.INACTIVE=2]="INACTIVE"})(a||(a={}));var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colorType=r.ActorColorType.GREEN,t.activeTimeLeft=0,t.inactiveTimeLeft=0,t.prevState=-1,t.state=a.IDLE,t}return n(t,e),t.prototype.onTouched=function(){0==this.activeTimeLeft&&0==this.inactiveTimeLeft&&(this.activeTimeLeft=this.activeTime,this.animation.play("ALERT_platform"))},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.animation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.animation.resume()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.body=this.getComponent(cc.RigidBody),this.spriteNode=this.node.getChildByName("sprite"),this.animation=this.node.getComponent(cc.Animation)},t.prototype.start=function(){this.colorType==r.ActorColorType.GREEN?(this.activeTime=s.GreenTrapPlatformConfig.activeTime,this.inactiveTime=s.GreenTrapPlatformConfig.inactiveTime):(this.activeTime=s.PinkTrapPlatformConfig.activeTime,this.inactiveTime=s.PinkTrapPlatformConfig.inactiveTime),this.body.active=!0},t.prototype.update=function(e){this.activeTimeLeft>0&&(this.activeTimeLeft-=e,this.activeTimeLeft<0&&(this.activeTimeLeft=0,this.inactiveTimeLeft=this.inactiveTime,this.body.active=!1,this.state=a.INACTIVE,c.default.getInstance().audioManager.playSfx(l.SFXKey.obstacle_platform1),this.animation.play("PLAY_platform"))),this.inactiveTimeLeft>0&&(this.inactiveTimeLeft-=e,this.inactiveTimeLeft<0&&(this.inactiveTimeLeft=0,this.activeTimeLeft=0,this.body.active=!0,this.state=a.ACTIVE,c.default.getInstance().audioManager.playSfx(l.SFXKey.obstacle_platform2),this.animation.play("RESET_platform"))),0==this.activeTimeLeft&&0==this.inactiveTimeLeft&&(this.state=a.IDLE),this.state,this.prevState,this.prevState=this.state},o([d({type:cc.Enum(r.ActorColorType)})],t.prototype,"colorType",void 0),t=o([p],t)}(h.default);i.default=f,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/audio/AudioScene":"AudioScene","./Config":"Config","./PausableComponent":"PausableComponent","./Placeholder":"Placeholder"}],Turret:[function(e,t,i){"use strict";cc._RF.push(t,"cdebd2/Ga9AMKPiT5blT7Rc","Turret");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./Config"),r=e("../core/Utils"),c=e("./Game"),l=e("./Projectile"),h=e("../core/Singleton"),u=e("../core/audio/AudioScene"),p=e("./PausableComponent"),d=cc._decorator,f=d.ccclass;d.property;(function(e){e[e.CHARGING=0]="CHARGING",e[e.FIRING=1]="FIRING",e[e.COOLDOWN=2]="COOLDOWN"})(a||(a={}));var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.facingDirection=r.Direction.LEFT,t.state=a.CHARGING,t}return n(t,e),t.prototype.attack=function(){var e=this;this.state=a.CHARGING,this.animation.play("charge"),this.scheduleOnce(function(){var t,i;e.state=a.FIRING,e.playSfxShoot(),e.animation.play("attack"),e.facingDirection==r.Direction.LEFT?(t=e.node.position.add(cc.v2(-50,-40)),i=Math.PI):(t=e.node.position.add(cc.v2(50,-40)),i=0),c.default.instance.spawnProjectile(t,e.projectileSpeed,i,0,e.projectileDamage,l.ProjectileType.TURRET),e.scheduleOnce(function(){e.state=a.COOLDOWN,e.animation.play("cooldown")},.2)},.5*this.cooldownTime)},t.prototype.onPause=function(){e.prototype.onPause.call(this),this.animation.pause()},t.prototype.onResume=function(){e.prototype.onResume.call(this),this.animation.resume()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.spriteNode=this.node.getChildByName("node_turret"),this.animation=this.spriteNode.getComponent(cc.Animation)},t.prototype.start=function(){this.projectileDamage=s.TurretConfig.projectileDamage,this.projectileSpeed=c.default.TILE_SIZE.width*s.TurretConfig.projectileSpeed,this.cooldownTime=s.TurretConfig.cooldownTime,this.facingDirection==r.Direction.LEFT?this.spriteNode.scaleX=1:this.spriteNode.scaleX=-1,this.schedule(this.attack,this.cooldownTime)},t.prototype.playSfxShoot=function(){var e=1.1*this.node.width,t=1.1*this.node.height,i=this.node.x-e/2,n=this.node.y-t/2,o=cc.rect(i,n,e,t);h.default.getInstance().audioManager.playSfxRegion(u.SFXKey.obstacle_turret1,o)},t=o([f],t)}(p.default);i.default=m,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","./Config":"Config","./Game":"Game","./PausableComponent":"PausableComponent","./Projectile":"Projectile"}],TutorialController:[function(e,t,i){"use strict";cc._RF.push(t,"16fb3t1GvdOD4ezLctBIpPb","TutorialController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../core/Singleton"),s=e("../core/Utils"),r=e("../core/audio/AudioScene"),c=cc._decorator,l=c.ccclass,h=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tutorialBasicLimit=4,t.tutorialUpgradeLimit=7,t.upgradeName=["title_aerial","title_rapid","title_parry","title_wily","title_panthro","title_tygra","title_cheetara"],t.upgradeDescription=["aerial","rapid","parry","wily","panthro","tygra","cheetara"],t}var i;return n(t,e),i=t,t.prototype.onLoad=function(){this.title=cc.find("tutorial_container/base/title",this.node).getComponent(cc.Label),this.animation=cc.find("tutorial_container",this.node).getComponent(cc.Animation),this.buttonExit=cc.find("tutorial_container/base/close",this.node).getComponent(cc.Button),this.title.string=a.default.getInstance().getLocalizationString("tutorial_title"),s.fixBigFontLabelLocalization(this.title)},t.prototype.start=function(){for(var e=0,t=this.node.children.length;e<t;e++)this.node.children[e].active=!1;this.getUIElements()},t.prototype.getUIElements=function(){this.containerBasicDesktop=cc.find("tutorial_container/base/basic",this.node),this.containerBasicMobile=cc.find("tutorial_container/base/basic_mobile",this.node),this.containerUpgradeDesktop=cc.find("tutorial_container/base/upgrade",this.node),this.containerUpgradeMobile=cc.find("tutorial_container/base/upgrade_mobile",this.node),this.descriptionBasicDesktopLabel=cc.find("tutorial_container/base/basic/description",this.node).getComponent(cc.Label),this.descriptionBasicMobileLabel=cc.find("tutorial_container/base/basic_mobile/description",this.node).getComponent(cc.Label),this.descriptionUpgradeDesktopLabel=cc.find("tutorial_container/base/upgrade/description",this.node).getComponent(cc.Label),this.descriptionUpgradeMobileLabel=cc.find("tutorial_container/base/upgrade_mobile/description",this.node).getComponent(cc.Label),this.tabBasic=cc.find("tutorial_container/base/tab_basic",this.node),this.tabUpgrade=cc.find("tutorial_container/base/tab_upgrade",this.node),this.arrowLeft=cc.find("tutorial_container/base/arrow_left",this.node).getComponent(cc.Button),this.arrowRight=cc.find("tutorial_container/base/arrow_right",this.node).getComponent(cc.Button),this.basicDesktopGroups=[],this.basicMobileGroups=[],this.upgradeDesktopGroups=[],this.upgradeMobileGroups=[],this.upgradeDesktopLabel=[],this.upgradeMobileLabel=[];for(var e=0;e<this.tutorialUpgradeLimit;e++)this.upgradeDesktopGroups[e]=cc.find("tutorial_container/base/upgrade/upgrade"+(e+1),this.node),this.upgradeMobileGroups[e]=cc.find("tutorial_container/base/upgrade_mobile/upgrade"+(e+1),this.node),this.upgradeDesktopLabel[e]=cc.find("tutorial_label",this.upgradeDesktopGroups[e]).getComponent(cc.Label),this.upgradeMobileLabel[e]=cc.find("tutorial_label",this.upgradeMobileGroups[e]).getComponent(cc.Label),2===e?(this.upgradeDesktopLabel[e].string=a.default.getInstance().getLocalizationString("tutorial_"+this.upgradeDescription[e]),this.upgradeMobileLabel[e].string=a.default.getInstance().getLocalizationString("tutorial_"+this.upgradeDescription[e])):(this.upgradeDesktopLabel[e].string=a.default.getInstance().getLocalizationString("tutorial_"+this.upgradeDescription[e]+"_desktop"),this.upgradeMobileLabel[e].string=a.default.getInstance().getLocalizationString("tutorial_"+this.upgradeDescription[e]+"_mobile")),this.upgradeDesktopLabel[e].font=a.default.getInstance().getLocalizationFont(this.upgradeDesktopLabel[e].font),this.upgradeMobileLabel[e].font=a.default.getInstance().getLocalizationFont(this.upgradeMobileLabel[e].font);"ar"===a.default.getInstance().localizationManager.locale&&(this.upgradeDesktopLabel[0].fontSize=35,this.upgradeDesktopLabel[1].fontSize=30,this.upgradeDesktopLabel[4].fontSize=25,this.upgradeDesktopLabel[5].fontSize=30,this.upgradeDesktopLabel[6].fontSize=25,this.upgradeMobileLabel[1].fontSize=25,this.upgradeMobileLabel[4].fontSize=25,this.upgradeMobileLabel[5].fontSize=30,this.upgradeMobileLabel[6].fontSize=25),"hu"===a.default.getInstance().localizationManager.locale&&(this.upgradeDesktopLabel[3].fontSize=35),"ru"!==a.default.getInstance().localizationManager.locale&&"bg"!==a.default.getInstance().localizationManager.locale||(this.upgradeDesktopLabel[0].fontSize=35,this.upgradeDesktopLabel[5].fontSize=35),"pl"===a.default.getInstance().localizationManager.locale&&(this.upgradeMobileLabel[0].node.y=-100);for(e=0;e<this.tutorialBasicLimit;e++)this.basicDesktopGroups[e]=cc.find("tutorial_container/base/basic/basic"+(e+1),this.node),this.basicMobileGroups[e]=cc.find("tutorial_container/base/basic_mobile/basic"+(e+1),this.node);for(var t=s.getAllSubChildrenByName(this.containerBasicDesktop,"letter"),i=0,n=t=s.getAllSubChildrenByName(this.containerUpgradeDesktop,"letter",t);i<n.length;i++){var o=n[i].getComponent(cc.Label);o&&("Z"==o.string.toUpperCase()&&(o.string=a.default.getInstance().attackKey.toUpperCase()),"X"==o.string.toUpperCase()&&(o.string=a.default.getInstance().specialKey.toUpperCase()))}},t.prototype.selectBasic=function(e){null!==e&&a.default.getInstance().audioManager.playSfx(r.SFXKey.button_generic),this.isSelectBasic=!0,this.tabUpgrade.opacity=120,this.tabBasic.opacity=255,this.containerBasicDesktop.active=!s.isMobile(),this.containerBasicMobile.active=s.isMobile(),this.containerUpgradeDesktop.active=!1,this.containerUpgradeMobile.active=!1,this.currentLimit=this.basicDesktopGroups.length,this.setBasic(0)},t.prototype.selectUpgrade=function(){a.default.getInstance().audioManager.playSfx(r.SFXKey.button_generic),this.isSelectBasic=!1,this.tabUpgrade.opacity=255,this.tabBasic.opacity=120,this.containerBasicDesktop.active=!1,this.containerBasicMobile.active=!1,this.containerUpgradeDesktop.active=!s.isMobile(),this.containerUpgradeMobile.active=s.isMobile(),this.currentLimit=this.upgradeDesktopGroups.length,this.setUpgrade(0)},t.prototype.setBasic=function(e){if(this.currentIndex=e,this.setArrows(),this.descriptionBasicDesktopLabel.string=a.default.getInstance().getLocalizationString("tutorial_basic_"+e),this.descriptionBasicMobileLabel.string=a.default.getInstance().getLocalizationString("tutorial_basic_"+e),this.descriptionBasicDesktopLabel.font=a.default.getInstance().getLocalizationFont(this.descriptionBasicDesktopLabel.font),this.descriptionBasicMobileLabel.font=a.default.getInstance().getLocalizationFont(this.descriptionBasicMobileLabel.font),s.isMobile()){for(var t=0;t<this.tutorialBasicLimit;t++)this.basicMobileGroups[t].active=t===this.currentIndex;this.playAnimation(this.basicMobileGroups[this.currentIndex])}else{for(t=0;t<this.tutorialBasicLimit;t++)this.basicDesktopGroups[t].active=t===this.currentIndex;this.playAnimation(this.basicDesktopGroups[this.currentIndex])}},t.prototype.setUpgrade=function(e){if(this.currentIndex=e,this.setArrows(),3===e?"ar"===a.default.getInstance().localizationManager.locale?(this.descriptionUpgradeDesktopLabel.fontSize=35,this.descriptionUpgradeMobileLabel.fontSize=35):"bg"===a.default.getInstance().localizationManager.locale||"ro"===a.default.getInstance().localizationManager.locale||"ru"===a.default.getInstance().localizationManager.locale||"tr"===a.default.getInstance().localizationManager.locale||"cz"===a.default.getInstance().localizationManager.locale?(this.descriptionUpgradeDesktopLabel.fontSize=30,this.descriptionUpgradeMobileLabel.fontSize=30):(this.descriptionUpgradeDesktopLabel.fontSize=45,this.descriptionUpgradeMobileLabel.fontSize=45):(this.descriptionUpgradeDesktopLabel.fontSize=45,this.descriptionUpgradeMobileLabel.fontSize=45),0===e&&("hu"===a.default.getInstance().localizationManager.locale||"ro"===a.default.getInstance().localizationManager.locale?(this.descriptionUpgradeDesktopLabel.fontSize=35,this.descriptionUpgradeMobileLabel.fontSize=35):(this.descriptionUpgradeDesktopLabel.fontSize=45,this.descriptionUpgradeMobileLabel.fontSize=45),"pl"===a.default.getInstance().localizationManager.locale?this.descriptionUpgradeMobileLabel.node.y=55:this.descriptionUpgradeMobileLabel.node.y=38),this.descriptionUpgradeDesktopLabel.string=a.default.getInstance().getLocalizationString(this.upgradeName[e]),this.descriptionUpgradeMobileLabel.string=a.default.getInstance().getLocalizationString(this.upgradeName[e]),this.descriptionUpgradeDesktopLabel.font=a.default.getInstance().getLocalizationFont(this.descriptionUpgradeDesktopLabel.font),this.descriptionUpgradeMobileLabel.font=a.default.getInstance().getLocalizationFont(this.descriptionUpgradeMobileLabel.font),s.isMobile()){for(var t=0;t<this.tutorialUpgradeLimit;t++)this.upgradeMobileGroups[t].active=t===this.currentIndex;3===this.currentIndex&&this.playAnimation(this.upgradeMobileGroups[this.currentIndex])}else{for(t=0;t<this.tutorialUpgradeLimit;t++)this.upgradeDesktopGroups[t].active=t===this.currentIndex;3===this.currentIndex&&this.playAnimation(this.upgradeDesktopGroups[this.currentIndex])}},t.prototype.setArrows=function(){this.arrowLeft.node.active=this.currentIndex>0,this.arrowRight.node.active=this.currentIndex+1<this.currentLimit},t.prototype.pressRight=function(){this.currentIndex+1>this.currentLimit||(a.default.getInstance().audioManager.playSfx(r.SFXKey.button_generic),this.isSelectBasic?this.setBasic(this.currentIndex+1):this.setUpgrade(this.currentIndex+1))},t.prototype.pressLeft=function(){this.currentIndex<0||(a.default.getInstance().audioManager.playSfx(r.SFXKey.button_generic),this.isSelectBasic?this.setBasic(this.currentIndex-1):this.setUpgrade(this.currentIndex-1))},t.prototype.playAnimation=function(e){var t;e.active=!0;for(var i=0,n=e.children.length;i<n;i++)(t=e.children[i].getComponent(cc.Animation))&&t.play(t.getClips()[0].name,0)},t.prototype.show=function(){this.disableButtons();for(var e=0,t=this.node.children.length;e<t;e++)this.node.children[e].active=!0;this.animation.play("IN_tutorial"),this.animation.on("finished",this.showStep2,this),this.selectBasic(null)},t.prototype.showStep2=function(){this.enableButtons(),this.animation.off("finished",this.showStep2,this)},t.prototype.hide=function(){a.default.getInstance().audioManager.playSfx(r.SFXKey.button_back),this.disableButtons(),this.animation.play("OUT_tutorial"),this.animation.on("finished",this.hideStep2,this)},t.prototype.hideStep2=function(){this.animation.off("finished",this.hideStep2,this);for(var e=0,t=this.node.children.length;e<t;e++)this.node.children[e].active=!1;this.node.emit(i.KEY_SIGNAL_OUT_COMPLETED)},t.prototype.disableButtons=function(){this.buttonExit.interactable=!1},t.prototype.enableButtons=function(){this.buttonExit.interactable=!0},t.KEY_SIGNAL_OUT_COMPLETED="exit",t=i=o([l],t)}(cc.Component));i.default=h,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene"}],UpgradeController:[function(e,t,i){"use strict";cc._RF.push(t,"029cc1inxhFr5Hq00icvXvn","UpgradeController");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../game/controllers/TransitionController"),s=e("../game/UpgradesManager"),r=e("../game/Config"),c=e("../core/Singleton"),l=e("../core/Utils"),h=e("../core/audio/AudioScene"),u=cc._decorator,p=u.ccclass,d=u.property,f=u.menu,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transition=null,t.playTransitionOnStart=!0,t.iconUpgrade=null,t.priceUpgrades=[],t.enableBuyUpgrades=[],t.isBuyUpgrades=[],t.upgrades=["aerial","rapid","parry","live","willy","panthro","tygra","cheetara"],t.upgradeName=["title_aerial","title_rapid","title_parry","title_live","title_wily","title_panthro","title_tygra","title_cheetara"],t.lastSelect=-1,t}return n(t,e),t.prototype.onLoad=function(){this.transition&&this.playTransitionOnStart&&(this.transition.node.active=!0),this.instaces=c.default.getInstance()},t.prototype.start=function(){c.default.getInstance().audioManager.playMusic(h.HowlsKey.music_store),this.getPriceUpgrade(),this.checkBuyEnabled(),this.checkIsBuyUpgrades(),this.getElements(),this.updateUI(),this.transition&&this.playTransitionOnStart&&this.transition.hideTransition(this.playOn.bind(this))},t.prototype.playOn=function(){c.default.getInstance().audioManager.playSfx(h.SFXKey.popup_store)},t.prototype.getElements=function(){if(this.spriteSelectUpgrade=[],this.spriteUpgrade=[],this.animationAlert=[],this.totalCoinsLabel=cc.find("Canvas/bg/coins").getComponent(cc.Label),this.buttonBuyCostLabel=cc.find("Canvas/bg/buy/price").getComponent(cc.Label),this.buttonBuy=cc.find("Canvas/bg/buy").getComponent(cc.Button),this.upgradeTitle=cc.find("Canvas/bg/description").getComponent(cc.Label),this.nodeBought=cc.find("Canvas/bg/bought"),this.nodeUpgradeDesktop=cc.find("Canvas/bg/upgrade"),this.nodeUpgradeMobile=cc.find("Canvas/bg/upgrade_mobile"),l.isMobile())this.nodeUpgradeMobile.active=!0,this.nodeUpgradeDesktop.active=!1,this.nodeUpgradeAnimations=this.nodeUpgradeMobile.children;else{this.nodeUpgradeMobile.active=!1,this.nodeUpgradeDesktop.active=!0,this.nodeUpgradeAnimations=this.nodeUpgradeDesktop.children;for(var e=0,t=l.getAllSubChildrenByName(this.nodeUpgradeDesktop,"letter");e<t.length;e++){var i=t[e].getComponent(cc.Label);i&&("Z"==i.string.toUpperCase()&&(i.string=c.default.getInstance().attackKey.toUpperCase()),"X"==i.string.toUpperCase()&&(i.string=c.default.getInstance().specialKey.toUpperCase()))}}for(var n=0;n<this.upgrades.length;n++)this.spriteSelectUpgrade[n]=cc.find("Canvas/bg/"+this.upgrades[n]+"/select").getComponent(cc.Sprite),this.spriteUpgrade[n]=cc.find("Canvas/bg/"+this.upgrades[n]+"/button").getComponent(cc.Sprite),this.animationAlert[n]=cc.find("Canvas/bg/"+this.upgrades[n]+"/alert_shine").getComponent(cc.Animation),this.nodeUpgradeAnimations[n].active=!1},t.prototype.getPriceUpgrade=function(){this.priceUpgrades[0]=r.UpgradesConfig.aerialSlashUnlockCost,this.priceUpgrades[1]=r.UpgradesConfig.rapidSlashUnlockCost,this.priceUpgrades[2]=r.UpgradesConfig.parryUnlockCost,this.priceUpgrades[3]=r.UpgradesConfig.howToLifeUnlockCost,this.priceUpgrades[4]=r.UpgradesConfig.willykatWillykitUnlockCost,this.priceUpgrades[5]=r.UpgradesConfig.panthroUnlockCost,this.priceUpgrades[6]=r.UpgradesConfig.tygraUnlockCost,this.priceUpgrades[7]=r.UpgradesConfig.cheetharaUnlockCost},t.prototype.checkBuyEnabled=function(){this.enableBuyUpgrades[0]=s.default.instance.canUnlockAerialSlash(),this.enableBuyUpgrades[1]=s.default.instance.canUnlockRapidSlash(),this.enableBuyUpgrades[2]=s.default.instance.canUnlockParry(),this.enableBuyUpgrades[3]=s.default.instance.canUnlockHowToLife(),this.enableBuyUpgrades[4]=s.default.instance.canUnlockWillykatWillykit(),this.enableBuyUpgrades[5]=s.default.instance.canUnlockPanthro(),this.enableBuyUpgrades[6]=s.default.instance.canUnlockTygra(),this.enableBuyUpgrades[7]=s.default.instance.canUnlockCheethara()},t.prototype.checkIsBuyUpgrades=function(){this.isBuyUpgrades[0]=s.default.instance.aerialSlashUnlocked,this.isBuyUpgrades[1]=s.default.instance.rapidSlashUnlocked,this.isBuyUpgrades[2]=s.default.instance.parryUnlocked,this.isBuyUpgrades[3]=s.default.instance.howToLifeUnlocked,this.isBuyUpgrades[4]=s.default.instance.wilykatWilykitUnlocked,this.isBuyUpgrades[5]=s.default.instance.panthroUnlocked,this.isBuyUpgrades[6]=s.default.instance.tygraUnlocked,this.isBuyUpgrades[7]=s.default.instance.cheetaraUnlocked},t.prototype.updateUI=function(e){var t;void 0===e&&(e=!0),this.totalCoinsLabel.string=String(s.default.instance.cookiesCount);for(var i=0;i<this.upgrades.length;i++)t=this.isBuyUpgrades[i]?"icon_"+this.upgrades[i]+"_2":"icon_"+this.upgrades[i]+"_1",this.spriteUpgrade[i].spriteFrame=this.iconUpgrade.getSpriteFrame(t),this.enableBuyUpgrades[i]&&!this.isBuyUpgrades[i]?(this.animationAlert[i].node.active=!0,this.animationAlert[i].play(this.animationAlert[i].getClips()[0].name,0)):(this.animationAlert[i].node.active=!1,this.animationAlert[i].stop());e&&this.selectUpgrade(null,1)},t.prototype.selectUpgrade=function(e,t){if(this.lastSelect!==Number(t)){-1!==this.lastSelect&&(this.spriteSelectUpgrade[this.lastSelect].spriteFrame=this.iconUpgrade.getSpriteFrame("unselect"),this.nodeUpgradeAnimations[this.lastSelect].active=!1),null!==e&&c.default.getInstance().audioManager.playSfx(h.SFXKey.upgrade_select),this.lastSelect=Number(t),this.playAnimationUpgrade(t);var i=this.isBuyUpgrades[t]?"":String(this.priceUpgrades[t]);this.buttonBuy.interactable=!0,this.isBuyUpgrades[t]?(this.buttonBuy.node.active=!1,this.nodeBought.active=!0):(this.buttonBuy.node.opacity=this.enableBuyUpgrades[t]?255:120,this.buttonBuy.node.active=!0,this.nodeBought.active=!1),this.buttonBuyCostLabel.string=i,0===this.lastSelect&&"bg"===c.default.getInstance().localizationManager.locale&&(this.upgradeTitle.node.width=500,this.upgradeTitle.node.height=70),4===this.lastSelect&&"ar"===c.default.getInstance().localizationManager.locale?this.upgradeTitle.fontSize=35:this.upgradeTitle.fontSize=45,this.upgradeTitle.string=this.instaces.getLocalizationString(this.upgradeName[t]),this.spriteSelectUpgrade[t].spriteFrame=this.iconUpgrade.getSpriteFrame("select")}},t.prototype.playAnimationUpgrade=function(e){var t;this.nodeUpgradeAnimations[e].active=!0;for(var i=0,n=this.nodeUpgradeAnimations[e].children.length;i<n;i++)(t=this.nodeUpgradeAnimations[e].children[i].getComponent(cc.Animation))&&t.play(t.getClips()[0].name,0)},t.prototype.pressBuy=function(){if(this.enableBuyUpgrades[this.lastSelect]&&!this.isBuyUpgrades[this.lastSelect]){switch(this.buttonBuy.node.active=!1,this.nodeBought.active=!0,this.buttonBuyCostLabel.string="",c.default.getInstance().audioManager.playSfx(h.SFXKey.upgrade_buy),this.lastSelect){case 0:s.default.instance.unlockAerialSlash();break;case 1:s.default.instance.unlockRapidSlash();break;case 2:s.default.instance.unlockParry();break;case 3:s.default.instance.unlockHowToLife();break;case 4:s.default.instance.unlockWillykatWillykit();break;case 5:s.default.instance.unlockPanthro();break;case 6:s.default.instance.unlockTygra();break;case 7:s.default.instance.unlockCheethara()}this.checkIsBuyUpgrades(),this.checkBuyEnabled(),this.updateUI(!1)}else this.enableBuyUpgrades[this.lastSelect]||this.isBuyUpgrades[this.lastSelect]||c.default.getInstance().audioManager.playSfx(h.SFXKey.no_coins)},t.prototype.showTransition=function(e){this.transition&&this.transition.showTransition(e.bind(this))},t.prototype.pressBack=function(){c.default.getInstance().audioManager.playSfx(h.SFXKey.button_back),this.showTransition(this.goToLevelSelect)},t.prototype.goToLevelSelect=function(){cc.director.loadScene("level_select")},o([d(a.default)],t.prototype,"transition",void 0),o([d],t.prototype,"playTransitionOnStart",void 0),o([d(cc.SpriteAtlas)],t.prototype,"iconUpgrade",void 0),t=o([p,f("Game Component/MainMenuController")],t)}(cc.Component);i.default=m,cc._RF.pop()},{"../core/Singleton":"Singleton","../core/Utils":"Utils","../core/audio/AudioScene":"AudioScene","../game/Config":"Config","../game/UpgradesManager":"UpgradesManager","../game/controllers/TransitionController":"TransitionController"}],UpgradesManager:[function(e,t,i){"use strict";cc._RF.push(t,"e6a32aA3plAA5PWjq8dsJgv","UpgradesManager");var n=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var o,a=e("./Config"),s=e("../core/Singleton"),r=cc._decorator,c=r.ccclass,l=(r.property,function(){function e(){this.foundFirst=!1,this.foundSecond=!1,this.foundThird=!1}return e.prototype.foundCount=function(){var e=0;return this.foundFirst&&++e,this.foundSecond&&++e,this.foundThird&&++e,e},e.prototype.foundAll=function(){return 3==this.foundCount()},e}());i.LevelCollectables=l,function(e){e[e.LOCKED=0]="LOCKED",e[e.UNLOCKED_PASSED=1]="UNLOCKED_PASSED",e[e.UNLOCKED_COMPLETED=2]="UNLOCKED_COMPLETED",e[e.UNLOCKED_LATEST=3]="UNLOCKED_LATEST"}(o=i.LevelState||(i.LevelState={}));var h=function(){function e(){this.collectables=[],this.unlockedRegularLevels=1,this.unlockedBossLevels=0,this.ammoCount=0,this.aerialSlashUnlocked=!1,this.rapidSlashUnlocked=!1,this.parryUnlocked=!1,this.howToLifeUnlocked=!1,this.wilykatWilykitUnlocked=!1,this.panthroUnlocked=!1,this.tygraUnlocked=!1,this.cheetaraUnlocked=!1,this.testCollectables=new l,this.lastPlayedLevelNumber=0,this.lastPlayedLevelIsBoss=!1,this.lastPlayedLevelIsTest=!1,this.lastLevelWasCompleted=!1,this.lastPlayedLevelHadFoundAllCollectables=!1,this.loadCollectables(),this.loadDataUpgrade(),this.loadDataLevels()}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cookiesCount",{get:function(){return s.default.getInstance().dataManager.getCookies()},set:function(e){s.default.getInstance().dataManager.setCookies(e)},enumerable:!0,configurable:!0}),e.prototype.loadCollectables=function(){for(var e=s.default.getInstance().dataManager.getCollectables(),i=0;i<t.REGULAR_LEVELS_COUNT;++i)this.collectables[i]=new l,this.collectables[i].foundFirst=e[i][0],this.collectables[i].foundSecond=e[i][1],this.collectables[i].foundThird=e[i][2]},e.prototype.saveCollectables=function(){s.default.getInstance().dataManager.setCollectables(this.collectables)},e.prototype.loadDataLevels=function(){this.unlockedRegularLevels=s.default.getInstance().dataManager.getUnlockedRegularLevels(),this.unlockedBossLevels=s.default.getInstance().dataManager.getUnlockedBossLevels()},e.prototype.saveDataLevels=function(){s.default.getInstance().dataManager.setUnlockedLevels(this.unlockedRegularLevels,this.unlockedBossLevels)},e.prototype.loadDataUpgrade=function(){var e=s.default.getInstance().dataManager.getUpgrades();this.aerialSlashUnlocked=e[0],this.rapidSlashUnlocked=e[1],this.parryUnlocked=e[2],this.howToLifeUnlocked=e[3],this.wilykatWilykitUnlocked=e[4],this.panthroUnlocked=e[5],this.tygraUnlocked=e[6],this.cheetaraUnlocked=e[7]},e.prototype.saveDataUpgrade=function(){var e=[];e[0]=this.aerialSlashUnlocked,e[1]=this.rapidSlashUnlocked,e[2]=this.parryUnlocked,e[3]=this.howToLifeUnlocked,e[4]=this.wilykatWilykitUnlocked,e[5]=this.panthroUnlocked,e[6]=this.tygraUnlocked,e[7]=this.cheetaraUnlocked,s.default.getInstance().dataManager.setUpgrades(e)},e.prototype.getTotalCollectablesCount=function(){return 3*this.collectables.length},e.prototype.getFoundCollectablesCount=function(){for(var e=0,t=0;t<this.collectables.length;++t)e+=this.collectables[t].foundCount();return e},e.prototype.shouldUnlockNextLevel=function(){return!this.lastPlayedLevelIsTest&&(this.lastPlayedLevelIsBoss?this.lastPlayedLevelNumber==this.unlockedBossLevels&&this.unlockedRegularLevels<=5*this.unlockedBossLevels:this.lastPlayedLevelNumber==this.unlockedRegularLevels&&this.unlockedRegularLevels>5*this.unlockedBossLevels)},e.prototype.unlockNextLevel=function(){this.unlockedRegularLevels%5==0?this.unlockedRegularLevels==5*this.unlockedBossLevels?this.unlockedRegularLevels+=1:this.unlockedBossLevels+=1:this.unlockedRegularLevels+=1,this.saveDataLevels()},e.prototype.lockAllLevel=function(){this.unlockedBossLevels=0,this.unlockedRegularLevels=1,this.saveDataLevels()},e.prototype.isRegularLevelUnlocked=function(e){return 0==this.unlockedRegularLevels||e<=this.unlockedRegularLevels},e.prototype.getRegularLevelState=function(e){if(this.isRegularLevelUnlocked(e)){if(e==this.unlockedRegularLevels&&e>5*this.unlockedBossLevels)return o.UNLOCKED_LATEST;var t=this.getLevelCollectables(e);return t&&t.foundAll()?o.UNLOCKED_COMPLETED:o.UNLOCKED_PASSED}return o.LOCKED},e.prototype.isBossLevelUnlocked=function(e){return 0==this.unlockedRegularLevels||e<=this.unlockedBossLevels},e.prototype.getBossLevelState=function(e){return this.isBossLevelUnlocked(e)?e==this.unlockedBossLevels&&5*e==this.unlockedRegularLevels?o.UNLOCKED_LATEST:o.UNLOCKED_COMPLETED:o.LOCKED},e.prototype.getLastPlayedLevelCollectables=function(){return 0==this.lastPlayedLevelNumber||this.lastPlayedLevelIsBoss?null:this.lastPlayedLevelIsTest?this.testCollectables:this.collectables[this.lastPlayedLevelNumber-1]},e.prototype.getLevelCollectables=function(e){return this.lastPlayedLevelIsTest?this.testCollectables:this.collectables[e-1]},e.prototype.getLastPlayedLevelSceneName=function(){if(0==this.lastPlayedLevelNumber)return"";var e=this.lastPlayedLevelIsTest?"test-":"";return this.lastPlayedLevelIsBoss?e+="boss_"+(this.lastPlayedLevelNumber<10?"0":"")+String(this.lastPlayedLevelNumber):e+="section_"+(this.lastPlayedLevelNumber<10?"0":"")+String(this.lastPlayedLevelNumber)+"_01",e},e.prototype.canUnlockSomething=function(){return this.canUnlockAerialSlash()||this.canUnlockRapidSlash()||this.canUnlockParry()||this.canUnlockHowToLife()||this.canUnlockWillykatWillykit()||this.canUnlockPanthro()||this.canUnlockTygra()||this.canUnlockCheethara()},e.prototype.canUnlockAerialSlash=function(){return!this.aerialSlashUnlocked&&this.cookiesCount>=a.UpgradesConfig.aerialSlashUnlockCost},e.prototype.canUnlockRapidSlash=function(){return!this.rapidSlashUnlocked&&this.cookiesCount>=a.UpgradesConfig.rapidSlashUnlockCost},e.prototype.canUnlockParry=function(){return!this.parryUnlocked&&this.cookiesCount>=a.UpgradesConfig.parryUnlockCost},e.prototype.canUnlockHowToLife=function(){return!this.howToLifeUnlocked&&this.cookiesCount>=a.UpgradesConfig.howToLifeUnlockCost},e.prototype.canUnlockWillykatWillykit=function(){return!this.wilykatWilykitUnlocked&&this.cookiesCount>=a.UpgradesConfig.willykatWillykitUnlockCost},e.prototype.canUnlockPanthro=function(){return!this.panthroUnlocked&&this.cookiesCount>=a.UpgradesConfig.panthroUnlockCost},e.prototype.canUnlockTygra=function(){return!this.tygraUnlocked&&this.cookiesCount>=a.UpgradesConfig.tygraUnlockCost},e.prototype.canUnlockCheethara=function(){return!this.cheetaraUnlocked&&this.cookiesCount>=a.UpgradesConfig.cheetharaUnlockCost},e.prototype.unlockAerialSlash=function(){this.cookiesCount-=a.UpgradesConfig.aerialSlashUnlockCost,this.aerialSlashUnlocked=!0,this.saveDataUpgrade()},e.prototype.unlockRapidSlash=function(){this.cookiesCount-=a.UpgradesConfig.rapidSlashUnlockCost,this.rapidSlashUnlocked=!0,this.saveDataUpgrade()},e.prototype.unlockParry=function(){this.cookiesCount-=a.UpgradesConfig.parryUnlockCost,this.parryUnlocked=!0,this.saveDataUpgrade()},e.prototype.unlockHowToLife=function(){this.cookiesCount-=a.UpgradesConfig.howToLifeUnlockCost,this.howToLifeUnlocked=!0,this.saveDataUpgrade()},e.prototype.unlockWillykatWillykit=function(){this.cookiesCount,a.UpgradesConfig.willykatWillykitUnlockCost,this.wilykatWilykitUnlocked=!0,this.saveDataUpgrade()},e.prototype.unlockPanthro=function(){this.cookiesCount-=a.UpgradesConfig.panthroUnlockCost,this.panthroUnlocked=!0,this.saveDataUpgrade()},e.prototype.unlockTygra=function(){this.cookiesCount-=a.UpgradesConfig.tygraUnlockCost,this.tygraUnlocked=!0,this.saveDataUpgrade()},e.prototype.unlockCheethara=function(){this.cookiesCount-=a.UpgradesConfig.cheetharaUnlockCost,this.cheetaraUnlocked=!0,this.saveDataUpgrade()},e._instance=null,e.REGULAR_LEVELS_COUNT=15,e.BOSS_LEVELS_COUNT=3,e=t=n([c],e)}();i.default=h,cc._RF.pop()},{"../core/Singleton":"Singleton","./Config":"Config"}],Utils:[function(e,t,i){"use strict";cc._RF.push(t,"77180SLXWpOWqyIMy9GoRsQ","Utils"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=e("./Singleton");i.isMobile=function(){return(cc.sys.isMobile||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!window.MSStream},i.simulateKeyDown=function(e){var t=new cc.Event.EventKeyboard(cc.SystemEvent.EventType.KEY_DOWN,!1);t.keyCode=cc.macro.KEY[e],cc.systemEvent.emit(cc.SystemEvent.EventType.KEY_DOWN,t)},i.simulateKeyUp=function(e){var t=new cc.Event.EventKeyboard(cc.SystemEvent.EventType.KEY_UP,!1);t.keyCode=cc.macro.KEY[e],cc.systemEvent.emit(cc.SystemEvent.EventType.KEY_UP,t)},function(e){e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.DOWN=3]="DOWN",e[e.UP=4]="UP"}(n=i.Direction||(i.Direction={})),i.directionToAngle=function(e){switch(e){case n.NONE:return null;case n.LEFT:return Math.PI;case n.RIGHT:return 0;case n.DOWN:return 1.5*Math.PI;case n.UP:return.5*Math.PI}},i.cartesianToPolarAngle=function(e){if(0==e.x)return 0;var t=Math.atan(e.y/e.x);return e.x>=0&&e.y>=0?t:e.x<0&&e.y>=0?t+Math.PI:e.x<0&&e.y<0?t+Math.PI:t+2*Math.PI},i.cartesianToPolarRadius=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},i.polarToCartesianVector=function(e,t){var i=t*Math.cos(e),n=t*Math.sin(e);return cc.v2(i,n)},i.getAllSubChildrenSprites=function(e,t){if(void 0===t&&(t=null),e){t||(t=[]);var n=e.getComponent(cc.Sprite);n&&t.push(n);for(var o=0,a=e.children;o<a.length;o++){var s=a[o];i.getAllSubChildrenSprites(s,t)}return t}},i.getAllSubChildrenByName=function(e,t,n){if(void 0===n&&(n=null),e){n||(n=[]),e.name==t&&n.push(e);for(var o=0,a=e.children;o<a.length;o++){var s=a[o];i.getAllSubChildrenByName(s,t,n)}return n}},i.intToString=function(e,t){for(var i=String(e),n=0;n<t-i.length;++n)i="0"+i;return i},i.changeParent=function(e,t){if(e.parent!==t){var i=e.convertToWorldSpaceAR(cc.p(0,0)),n=t.convertToNodeSpaceAR(i);e.parent=t,e.position=n}},i.fixBigFontLabelLocalization=function(e){var t=o.default.getInstance().getLocalizationFont(e.font);e.font!=t&&(e.font=t,e.fontSize=e.fontSize+14,e.node.position=e.node.position.add(cc.v2(0,8)))},cc._RF.pop()},{"./Singleton":"Singleton"}],WorldMap:[function(e,t,i){"use strict";cc._RF.push(t,"2c5d5upbRVOQ6JFUXA42CAX","WorldMap");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a,s=e("./controllers/CameraController"),r=e("./TileMapBackgroundConfig"),c=e("../core/Utils"),l=e("./Game"),h=e("./Placeholder"),u=cc._decorator,p=u.ccclass,d=u.menu,f=u.requireComponent,m=(u.property,function(){return function(e,t){this.x=0,this.y=0,this.width=1,this.height=1,this.x=e,this.y=t}}());(function(e){e[e.ANY=0]="ANY",e[e.ICE_ONLY=1]="ICE_ONLY",e[e.MUD_ONLY=2]="MUD_ONLY",e[e.POISON_ONLY=3]="POISON_ONLY"})(a||(a={}));var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TERRAIN_LAYER_NAME="terrain",t.PLATFORMS_LAYER_NAME="platform terrain",t.WATER_LAYER_NAME="water",t.ACTORS_LAYER_NAME="actors",t.tileMap=null,t}return n(t,e),t.prototype.start=function(){if(this.tileMap=this.node.getComponent(cc.TiledMap),!this.tileMap)throw new Error("No tile map present in node!");console.info("WorldMap mapSize: "+this.tileMap.getMapSize()+"  tileSize: "+this.tileMap.getTileSize()),l.default.instance.worldMapSize=this.tileMap.getMapSize(),cc.macro.ENABLE_TILEDMAP_CULLING=!1,this.node.addComponent(cc.RigidBody).type=cc.RigidBodyType.Static;var e=this.tileMap.getLayer(this.TERRAIN_LAYER_NAME);e&&this.generateTerrainColliders(e,l.ColliderTag.TERRAIN);var t=this.tileMap.getLayer(this.PLATFORMS_LAYER_NAME);t&&this.generateTerrainColliders(t,l.ColliderTag.PLATFORM,0);var i=this.tileMap.getLayer(this.WATER_LAYER_NAME);i&&this.generateMudAndPoisonColliders(i),this.tileMap.getLayer("tutorial mobile")&&(c.isMobile()?(this.tileMap.getLayer("tutorial desktop").node.active=!1,this.tileMap.getLayer("tutorial mobile").node.active=!0,this.tileMap.getLayer("tutorial desktop front").node.active=!1,this.tileMap.getLayer("tutorial mobile front").node.active=!0):(this.tileMap.getLayer("tutorial desktop").node.active=!0,this.tileMap.getLayer("tutorial mobile").node.active=!1,this.tileMap.getLayer("tutorial desktop front").node.active=!0,this.tileMap.getLayer("tutorial mobile front").node.active=!1),this.addTiledBackground())},t.prototype.generateTerrainColliders=function(e,t,i){void 0===i&&(i=0);for(var n=e.getMapTileSize(),o=this.horizontallyMergeTileBoxes(e,a.ANY),s=0,r=o=this.verticallyMergeTileBoxes(o);s<r.length;s++){var c=r[s];this.createCollider(c,n,t,i)}for(var h=this.horizontallyMergeTileBoxes(e,a.ICE_ONLY),u=0,p=h=this.verticallyMergeTileBoxes(h);u<p.length;u++){c=p[u];this.createSensor(c,n,l.ColliderTag.ICE_AREA,.5)}},t.prototype.generateMudAndPoisonColliders=function(e){for(var t=e.getMapTileSize(),i=this.horizontallyMergeTileBoxes(e,a.MUD_ONLY),n=0,o=i=this.verticallyMergeTileBoxes(i);n<o.length;n++){var s=o[n];this.createSensor(s,t,l.ColliderTag.MUD_AREA,0)}for(var r=this.horizontallyMergeTileBoxes(e,a.POISON_ONLY),c=0,h=r=this.verticallyMergeTileBoxes(r);c<h.length;c++){s=h[c];this.createSensor(s,t,l.ColliderTag.POISON_AREA,0)}},t.prototype.generateActorPlaceholders=function(e){var t=e.getMapTileSize(),i=e.getLayerSize();e.node.active=!1;for(var n=0;n<i.height;++n)for(var o=0;o<i.width;++o){var a=e.getTileGIDAt(o,n);if(0!=a){var s=o*t.width+.5*t.width-this.node.width*this.node.anchorX,r=-n*t.height-.5*t.height+this.node.height*this.node.anchorY,u=cc.v2(s,r),p=this.tileMap.getPropertiesForGID(a);p&&p.isStaticSpikes&&l.default.instance.addPlaceholder(h.PlaceholderType.SPIKES,u.add(cc.v2(0,.5*-t.height)),c.Direction.UP),p&&p.isStaticSpikesUp&&l.default.instance.addPlaceholder(h.PlaceholderType.SPIKES,u.add(cc.v2(0,.5*-t.height)),c.Direction.UP),p&&p.isStaticSpikesDown&&l.default.instance.addPlaceholder(h.PlaceholderType.SPIKES,u.add(cc.v2(0,.5*t.height)),c.Direction.DOWN),p&&p.isStaticSpikesRight&&l.default.instance.addPlaceholder(h.PlaceholderType.SPIKES,u.add(cc.v2(.5*t.width,0)),c.Direction.RIGHT),p&&p.isStaticSpikesLeft&&l.default.instance.addPlaceholder(h.PlaceholderType.SPIKES,u.add(cc.v2(.5*-t.height,0)),c.Direction.LEFT)}}},t.prototype.horizontallyMergeTileBoxes=function(e,t){for(var i=e.getLayerSize(),n=[],o=0;o<i.height;++o)for(var s=null,r=0;r<i.width;++r){var c=e.getTileGIDAt(r,o),l=!1;if(0!=c){var h=this.tileMap.getPropertiesForGID(c);t==a.ANY&&(l=!0),t==a.ICE_ONLY&&h&&1==h.isIce&&(l=!0),t==a.MUD_ONLY&&h&&1==h.isMud&&(l=!0),t==a.POISON_ONLY&&h&&1==h.isPoison&&(l=!0)}l?s?s.width+=1:(s=new m(r,o),n.push(s)):s=null}return n},t.prototype.verticallyMergeTileBoxes=function(e){for(var t=[],i=0;i<e.length;++i){var n=e[i];t.push(n);for(var o=i+1;o<e.length;++o){var a=e[o];if(n.y<a.y-n.height)break;n.x==a.x&&n.y==a.y-n.height&&n.width==a.width&&(n.height+=a.height,e.splice(o,1),--o)}}return t},t.prototype.createCollider=function(e,t,i,n){var o=this.node.addComponent(cc.PhysicsBoxCollider),a=e.x*t.width+e.width*t.width*.5-this.node.width*this.node.anchorX,s=-e.y*t.height-e.height*t.height*.5+this.node.height*this.node.anchorY;o.friction=.2,o.restitution=0,o.size=new cc.Size(e.width*t.width-n*t.width,e.height*t.height),o.offset=cc.v2(a,s),o.tag=i,o.apply()},t.prototype.createSensor=function(e,t,i,n){var o=this.node.addComponent(cc.PhysicsBoxCollider),a=e.x*t.width+e.width*t.width*.5-this.node.width*this.node.anchorX,s=-e.y*t.height-e.height*t.height*.5+this.node.height*this.node.anchorY;o.friction=0,o.size=new cc.Size(e.width*t.width-.5*t.width,e.height*t.height),o.offset=cc.v2(a,s+t.height*n),o.tag=i,o.sensor=!0,o.apply()},t.prototype.addTiledBackground=function(){var e=~~this.node.name[6]-1;if(!(r.tileMapBackgroundFrames.length<e+1)){var t=cc.view.getViewportRect(),i=s.default.main.getViewPortHalfWidth(t,cc.view.getScaleX(),.7),n=.5*this.node.width;if(i>n){var o=new cc.Node("left-bg"),a=new cc.Node("right-bg");this.node.addChild(o),this.node.addChild(a);var c=50*(1+~~((i-n)/50)),l=o.addComponent(cc.Sprite);l.spriteFrame=r.tileMapBackgroundFrames[e],l.type=cc.Sprite.Type.TILED;var h=a.addComponent(cc.Sprite);h.spriteFrame=r.tileMapBackgroundFrames[e],h.type=cc.Sprite.Type.TILED,o.height=this.node.height,o.width=c,o.anchorX=1,o.x=-n,a.height=this.node.height,a.width=c,a.anchorX=0,a.x=n}}},t.prototype.flipNodesOrder=function(){for(var e=this.node.childrenCount,t=0;t<e-1;++t){var i=this.node.children[e-1-t];i.removeFromParent,this.node.insertChild(i,t)}},t=o([p,d("Game Component/WorldMap"),f(cc.TiledMap)],t)}(cc.Component);i.default=g,cc._RF.pop()},{"../core/Utils":"Utils","./Game":"Game","./Placeholder":"Placeholder","./TileMapBackgroundConfig":"TileMapBackgroundConfig","./controllers/CameraController":"CameraController"}],ZonedTouchInputButtons:[function(e,t,i){"use strict";cc._RF.push(t,"3135dsgUVtML6qR7Vclb+Lo","ZonedTouchInputButtons");var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=this&&this.__decorate||function(e,t,i,n){var o,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(s=(a<3?o(s):a>3?o(t,i,s):o(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,r=a.property,c=a.menu,l=function(){function e(){this.normal=null,this.pressed=null}return o([r(cc.SpriteFrame)],e.prototype,"normal",void 0),o([r(cc.SpriteFrame)],e.prototype,"pressed",void 0),e=o([s("ZonedInputButtonGraphicData")],e)}();i.ZonedInputButtonGraphicData=l;var h=function(){function e(){this.target=null,this.graphicData=new l,this.onPush=[],this.onRelease=[]}return o([r(cc.Node)],e.prototype,"target",void 0),o([r(l)],e.prototype,"graphicData",void 0),o([r([cc.Component.EventHandler])],e.prototype,"onPush",void 0),o([r([cc.Component.EventHandler])],e.prototype,"onRelease",void 0),e=o([s("ZonedInputButtonData")],e)}(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteDpad=null,t.buttons=[],t}return n(t,e),t.prototype.onTouchMove=function(e){for(var t=e.touch,i=!1,n=0,o=this.buttons;n<o.length;n++){var a=o[n];if(a.target._hitTest(t.getLocation())&&(i=!0,this.lastHit!==a)){if(this.lastHit){this.spriteDpad.spriteFrame=this.lastHit.graphicData.normal;for(var s=0,r=this.lastHit.onRelease;s<r.length;s++){(h=r[s]).emit([e,h.customEventData])}}this.lastHit=a,this.lastEvent=e,this.spriteDpad.spriteFrame=a.graphicData.pressed;for(var c=0,l=a.onPush;c<l.length;c++){var h;(h=l[c]).emit([e,h.customEventData])}break}}i||this.onTouchEnd(e)},t.prototype.onTouchEnd=function(e){if(this.lastHit){this.spriteDpad.spriteFrame=this.lastHit.graphicData.normal;for(var t=0,i=this.lastHit.onRelease;t<i.length;t++){var n=i[t];n.emit([e,n.customEventData])}this.lastHit=null}},t.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},t.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.onTouchEnd(this.lastEvent)},o([r(cc.Sprite)],t.prototype,"spriteDpad",void 0),o([r([h])],t.prototype,"buttons",void 0),t=o([s,c("Game Component/Input/ZonedTouchInputButton")],t)}(cc.Component);i.default=u,cc._RF.pop()},{}]},{},["AudioLevelConfig","AutoScale","CheatManager","DataManager","FocusHandler","LoaderCSS","ResizeScreenManager","RotateScreenManager","Singleton","Utils","AudioButton","AudioManager","AudioScene","ChangeMusicLevel","Animator","AttackArea","AutoDestroySelf","AutoPauseAnimation","Barrier","BossShip","Collectable","Config","Crate","Destructable","DoesDamage","Door","FinalBoss","Finish","Flames","FlyingBomberEnemy","FlyingChaserEnemy","Game","Missiles","PatrollingAgressiveEnemy","PatrollingJumperEnemy","PatrollingPassiveEnemy","PausableComponent","Placeholder","Projectile","Shaker","SpecialCollectable","Spikes","StaticAgressiveEnemy","StaticMortarEnemy","StaticPassiveEnemy","TakesDamage","TaskRunner","TileMapBackgroundConfig","TrapPlatform","Turret","UpgradesManager","WorldMap","CameraController","CharacterAnimationController","CharacterBaseController","PlayerController","StageController","TransitionController","KeyBoardController","MobileInputController","TouchInputButton","TouchInputHoldButton","ZonedTouchInputButtons","ExposedLocalizationImage","ExposedLocalizationText","LocalizationAsset","LocalizationConfig","LocalizationImage","LocalizationImageComponent","LocalizationItem","LocalizationManager","LocalizationText","LocalizationTextComponent","BootController","ComicController","ConfirmationController","FinalPopup","GameoverController","GameplayUIController","LevelInfoController","LevelSelectController","MainMenuController","PauseController","TutorialController","UpgradeController","TesterLevelData","AudioSettingsController","SimplifiedAudioSettingsController"]);